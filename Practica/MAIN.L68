00001F26 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 26/12/2023 0:57:18

00000000                             1  *-----------------------------------------------------------
00000000                             2  * Title      : PRÁCTICA 1
00000000                             3  * Written by : KHAOULA IKKENE & ADRIÁN RUIZ VIDAL
00000000                             4  * Date       : STARTED IT THE FIRST WEEK 
00000000                             5  * Description: SPACE INVADERS GAME
00000000                             6  *-----------------------------------------------------------
00000000                             7     
00001000                             8              ORG     $1000
00001000                             9          
00001000                            10              INCLUDE "SYSCONST.X68"
00001000                            11      ;RESOLUCIÓN PANTALLA
00001000  =000001E0                 12  SCRHEIGH    EQU     480
00001000  =00000280                 13  SCRWIDTH    EQU     640
00001000                            14  
00001000                            15  ;SHOT CONSTANTS
00001000  =00000000                 16  LIMIT   EQU 0
00001000                            17  
00001000                            18  
00001000                            19      ;PANTALLA FOTOGRAMAS/S 
00001000  =00000032                 20  SCRFPS      EQU     50                      ; SCREEN FRAMES PER SECOND         
00001000                            21  
00001000                            22      ;CONSTANTES TECLADO
00001000  =00000025                 23  KBDLEFT     EQU     $25
00001000  =00000026                 24  KBDUP       EQU     $26
00001000  =00000027                 25  KBDRIGHT    EQU     $27
00001000  =00000028                 26  KBDDOWN     EQU     $28
00001000  =00000020                 27  KBDFIRE1    EQU     ' '
00001000  =0000004D                 28  KBDFIRE2    EQU     'M'
00001000  =00000010                 29  KBDFIRE3    EQU     $10
00001000  =00000050                 30  KBDPAUSE    EQU     'P'
00001000                            31  
00001000                            32  ;----------TRAPS NUMBERS----------
00001000  =00000000                 33  SCRUPTN     EQU     0
00001000  =00000001                 34  KBDUPTN     EQU     1
00001000  =00000002                 35  SNDPLTN     EQU     2       
00001000                            36  ;---------SOUNDS IDENTIFIERS--------
00001000                            37  
00001000  =00000000                 38  SNDSHT      EQU 0    
00001000  =00000001                 39  SNDDEM      EQU 1     
00001000  =00000002                 40  SNDHIT      EQU 2
00001000  =00000003                 41  SNDWIN      EQU 3
00001000  =00000004                 42  SNDGOV      EQU 4   
00001000                            43  
00001000                            44  
00001000                            45  
00001000                            46  
00001000                            47  
00001000                            48  
00001000                            49  
00001000                            50  
00001000                            51  
00001000                            52  
00001000                            53  
00001000                            54  
00001000                            55  
00001000                            56  
00001000                            57  -------------------- end include --------------------
00001000                            58              INCLUDE "CONST.X68"
00001000  =0000FF00                 59  ALNFLCLR    EQU     $0000FF00   ;COLOR RELLENO ALIEN
00001000  =0000AA00                 60  ALNPNCLR    EQU     $0000AA00   ;COLOR CONTORNO ALIEN
00001000  =00000028                 61  ALNDIM      EQU     40          ;DIMENSIÓN CUADRADO MAPA ALIEN
00001000  =0000000A                 62  ALNROW      EQU     10          ;FILAS DIBUJO ALIEN
00001000  =0000000A                 63  ALNCOL      EQU     10          ;COLUMNAS DIBUJO ALIEN
00001000  =00000003                 64  ALNMPROW    EQU     3           ;FILAS MAPA ALIEN   
00001000  =0000000A                 65  ALNMPCOL    EQU     10          ;COLUMNAS MAPA ALIEN
00001000  =00000078                 66  ALNIPOSX    EQU     120         ;INICIO POS X ALIENS
00001000  =00000050                 67  ALNIPOSY    EQU     80          ;INICIO POS Y ALIENS
00001000  =00000008                 68  ALNSPD1     EQU     8           ;VELOCIDAD ALIENS NIVEL 1 (NIVEL 3 ES EL DOBLE DE ESTE)
00001000  =0000000C                 69  ALNSPD2     EQU     12          ;VELOCIDAD ALIENS NIVEL 2 (NIVEL 1 * 1,5 PARA QUE EL NIVEL SEA CRECIENTE LINEALMENTE)
00001000  =0000000C                 70  ALNPIXEL    EQU     12           ;PIXELES BAJADA ALIENS (POSY)
00001000                            71  
00001000                            72  
00001000                            73  
00001000  =00FF0000                 74  TNKFLCLR    EQU     $00FF0000   ;COLOR RELLENO TANQUE
00001000  =00AA0000                 75  TNKPNCLR    EQU     $00AA0000   ;COLOR CONTORNO TANQUE
00001000  =00000048                 76  TNKWIDTH    EQU     72          ;ANCHO TANQUE (DIMENSIÓN * COLUMNAS)
00001000  =00000024                 77  TNKWIDHA    EQU     36          ;MITAD ANCHO TANQUE (DIMENSIÓN * COLUMNAS)/2
00001000  =00000008                 78  TNKSQUWI    EQU     8           ;DIMENSIÓN CUADRADO TANQUE 
00001000  =000001A0                 79  TNKPOSY     EQU     416         ;POSICIÓN Y TANQUE (480-64)
00001000  =00000006                 80  TNKROW      EQU     6           ;FILAS MAPA TANQUE
00001000  =00000009                 81  TNKCOL      EQU     9           ;COLUMNAS MAPA TANQUE
00001000  =00000008                 82  TNKSPEED    EQU     8           ;VELOCIDAD TANQUE
00001000                            83  
00001000                            84  
00001000  =000000FF                 85  SHTFLCLR    EQU     $000000FF   ;COLOR RELLENO DISPARO
00001000  =000000AA                 86  SHTPNCLR    EQU     $000000AA   ;COLOR CONTORNO DISPARO
00001000  =00000004                 87  SHTWIDTH    EQU     4           ;ANCHO DISPARO
00001000  =00000010                 88  SHTHEIGH    EQU     16          ;ALTURA DISPARO
00001000  =0000000A                 89  SHTGAP      EQU     10          ;ESPACIO TANQUE Y DISPARO
00001000  =0000000A                 90  SHTSPEED    EQU     10          ;VELOCIDAD DISPARO
00001000                            91  
00001000                            92  
00001000  =00000000                 93  SCOFLCLR    EQU     0           ;COLOR RELLENO MARCADOR
00001000  =00000101                 94  SCOLINE     EQU     $0101       ;COORDENADAS LINEA 1 IZQUIERDA
00001000  =00004101                 95  SCOLINE1    EQU     $4101       ;COORDENADAS LINEA 1 DERECHA
00001000  =00004102                 96  SCOLINE2    EQU     $4102       ;COORDENADAS LINEA 2 DERECHA
00001000                            97  
00001000                            98  ; --- STATE RELATED CONSTANTS --------------------------------------------------
00001000  =FFFFFFFF                 99  STANONE     EQU     -1          ; NUMERO ESTADO NO EXISTENTE
00001000  =00000000                100  STAFLCLR    EQU     $00000000   ; COLOR RELLENO ESTADOS        
00001000                           101  
00001000                           102  ; --- VICTORY/DEFEAT CONSTANTS -------------------------------------------------
00001000  =0000001E                103  SCOWIN      EQU     30          ; NUMBER OF SCOREBOARD TO VICTORY
00001000                           104  ;-----LEVELS---------------------------
00001000                           105  ;LEVELS NUMBER
00001000  =00000001                106  NIVEL1  EQU 1
00001000  =00000002                107  NIVEL2  EQU 2
00001000  =00000003                108  NIVEL3  EQU 3   
00001000  =00FFA500                109  NIVELCR EQU $00FFA500
00001000  =0000FF66                110  DISPCLR EQU $0000FF66
00001000                           111  
00001000                           112  
00001000                           113  
00001000                           114  
00001000                           115  
00001000                           116  
00001000                           117  
00001000                           118  
00001000                           119  
00001000                           120  
00001000                           121  
00001000                           122  
00001000                           123  
00001000                           124  
00001000                           125  
00001000                           126  
00001000                           127  
00001000                           128  
00001000                           129  
00001000                           130  
00001000                           131  
00001000                           132  
00001000                           133  
00001000                           134  
00001000                           135  
00001000                           136  
00001000                           137  
00001000                           138  
00001000                           139  
00001000                           140  
00001000                           141  
00001000                           142  
00001000                           143  
00001000                           144  
00001000                           145  
00001000                           146  
00001000                           147  
00001000                           148  
00001000                           149  
00001000                           150  
00001000                           151  
00001000                           152  
00001000                           153  
00001000                           154  
00001000                           155  
00001000                           156  
00001000                           157  
00001000                           158  
00001000                           159  
00001000                           160  
00001000                           161  
00001000                           162  -------------------- end include --------------------
00001000                           163              INCLUDE "LIB/DMMCONST.X68"
00001000                           164  ; =============================================================================
00001000                           165  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001000                           166  ; =============================================================================
00001000                           167  
00001000  =00000040                168  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                169  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                170  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000  =00000000                171  -------------------- end include --------------------
00001000                           172              INCLUDE "LIB/UTLCONST.X68"
00001000                           173  ; ==============================================================================
00001000                           174  ; UTIL CONSTANTS
00001000                           175  ; ==============================================================================
00001000                           176  
00001000  =00000008                177  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001000                           178              
00001000                           179  -------------------- end include --------------------
00001000                           180              INCLUDE "LIB/DMMCODE.X68"
00001000                           181  ; =============================================================================
00001000                           182  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001000                           183  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001000                           184  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001000                           185  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001000                           186  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001000                           187  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001000                           188  ; =============================================================================
00001000                           189  
00001000                           190  ; -----------------------------------------------------------------------------
00001000                           191  DMMINIT
00001000                           192  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001000                           193  ; INPUT    - NONE
00001000                           194  ; OUTPUT   - NONE
00001000                           195  ; MODIFIES - NONE
00001000                           196  ; -----------------------------------------------------------------------------
00001000  48E7 8080                197              MOVEM.L D0/A0,-(A7)
00001004  41F9 00001F80            198              LEA     DMMDATA,A0
0000100A  303C 0031                199              MOVE.W  #DMMBNUM-1,D0
0000100E  30BC 0000                200  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001012  D1FC 00000040            201              ADD.L   #DMMBSIZE,A0
00001018  51C8 FFF4                202              DBRA.W  D0,.LOOP
0000101C  4CDF 0101                203              MOVEM.L (A7)+,D0/A0
00001020  4E75                     204              RTS
00001022                           205  
00001022                           206  ; -----------------------------------------------------------------------------
00001022                           207  DMMFIRST
00001022                           208  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001022                           209  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001022                           210  ; INPUT    - NONE
00001022                           211  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001022                           212  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001022                           213  ; -----------------------------------------------------------------------------
00001022  41F9 00001F80            214              LEA     DMMDATA,A0
00001028  4A58                     215  DMMFRLOP    TST.W   (A0)+
0000102A  6600 0016                216              BNE     DMMFRFND
0000102E  D1FC 0000003E            217              ADD.L   #DMMBSIZE-2,A0
00001034  B1FC 00002BFF            218  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
0000103A  6DEC                     219              BLT     DMMFRLOP
0000103C  207C 00000000            220              MOVE.L  #0,A0
00001042  4E75                     221  DMMFRFND    RTS
00001044                           222  
00001044                           223  ; -----------------------------------------------------------------------------
00001044                           224  DMMNEXT
00001044                           225  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001044                           226  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001044                           227  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001044                           228  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001044                           229  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001044                           230  ; -----------------------------------------------------------------------------
00001044  2F00                     231              MOVE.L  D0,-(A7)
00001046  2008                     232              MOVE.L  A0,D0
00001048  C0BC FFFFFFC0            233              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000104E  0680 00000040            234              ADD.L   #DMMBSIZE,D0
00001054  2040                     235              MOVE.L  D0,A0
00001056  201F                     236              MOVE.L  (A7)+,D0
00001058  60DA                     237              BRA     DMMFRCOM
0000105A                           238  
0000105A                           239  ; -----------------------------------------------------------------------------
0000105A                           240  DMMFRSTO
0000105A                           241  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000105A                           242  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000105A                           243  ; INPUT    - D0.W : ID TO SEARCH
0000105A                           244  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000105A                           245  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000105A                           246  ; -----------------------------------------------------------------------------
0000105A  41F9 00001F80            247              LEA     DMMDATA,A0
00001060  B058                     248  DMMFLOOP    CMP.W   (A0)+,D0
00001062  6700 0016                249              BEQ     DMMFFND
00001066  D1FC 0000003E            250              ADD.L   #DMMBSIZE-2,A0
0000106C  B1FC 00002BFF            251  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001072  6DEC                     252              BLT     DMMFLOOP
00001074  207C 00000000            253              MOVE.L  #0,A0
0000107A  4E75                     254  DMMFFND     RTS
0000107C                           255  
0000107C                           256  ; -----------------------------------------------------------------------------
0000107C                           257  DMMNEXTO
0000107C                           258  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000107C                           259  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000107C                           260  ; INPUT    - D0.W : ID TO SEARCH
0000107C                           261  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000107C                           262  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000107C                           263  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000107C                           264  ; -----------------------------------------------------------------------------
0000107C  2F00                     265              MOVE.L  D0,-(A7)
0000107E  2008                     266              MOVE.L  A0,D0
00001080  C0BC FFFFFFC0            267              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001086  0680 00000040            268              ADD.L   #DMMBSIZE,D0
0000108C  2040                     269              MOVE.L  D0,A0
0000108E  201F                     270              MOVE.L  (A7)+,D0
00001090  60DA                     271              BRA     DMMFCOM
00001092                           272  
00001092                           273  ; -----------------------------------------------------------------------------
00001092                           274  DMMALLOC
00001092                           275  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001092                           276  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001092                           277  ; INPUT    - D0.W : ID TO ASSIGN
00001092                           278  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001092                           279  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001092                           280  ; -----------------------------------------------------------------------------
00001092  3F00                     281              MOVE.W  D0,-(A7)
00001094  4240                     282              CLR.W   D0
00001096  4EB8 105A                283              JSR     DMMFRSTO
0000109A  301F                     284              MOVE.W  (A7)+,D0
0000109C  B1FC 00000000            285              CMP.L   #0,A0
000010A2  6700 0006                286              BEQ     .END
000010A6  3140 FFFE                287              MOVE.W  D0,-2(A0)
000010AA  4E75                     288  .END        RTS
000010AC                           289  
000010AC                           290  ; -----------------------------------------------------------------------------
000010AC                           291  DMMFREE
000010AC                           292  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010AC                           293  ; SYSTEM (0)
000010AC                           294  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010AC                           295  ; OUTPUT   - NONE
000010AC                           296  ; MODIFIES - NONE
000010AC                           297  ; -----------------------------------------------------------------------------
000010AC  48E7 8080                298              MOVEM.L D0/A0,-(A7)
000010B0  2008                     299              MOVE.L  A0,D0
000010B2  C0BC FFFFFFC0            300              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010B8  2040                     301              MOVE.L  D0,A0
000010BA  4250                     302              CLR.W   (A0)
000010BC  4CDF 0101                303              MOVEM.L (A7)+,D0/A0
000010C0  4E75                     304              RTS
000010C0  4E75                     305  -------------------- end include --------------------
000010C2                           306              INCLUDE "SYSTEM.X68"
000010C2                           307  ; ------------------------------------------------------------------------------
000010C2                           308  SYSINIT
000010C2                           309  ; INIT SYSTEM: SET SCREEN RESOLUTION AND WINDOWED MODE.
000010C2                           310  ; INPUT    : NONE
000010C2                           311  ; OUTPUT   : NONE
000010C2                           312  ; MODIFIES : NONE
000010C2                           313  ; ------------------------------------------------------------------------------
000010C2                           314  
000010C2                           315             
000010C2                           316  
000010C2                           317              ;INSTALAR TRAPS Y INTERRUPCIONES
000010C2  21FC 000011F6 0080       318              MOVE.L  #SCRPLOT,($80+4*SCRUPTN)
000010CA  21FC 0000122C 0084       319              MOVE.L  #KBDUPD,($80+4*KBDUPTN)
000010D2  21FC 00001194 0088       320              MOVE.L  #SNDPLAY,($80+4*SNDPLTN)
000010DA  21FC 00001210 0064       321              MOVE.L  #SCRTIM,($64)
000010E2                           322                  
000010E2                           323                  
000010E2  4EB9 000011B2            324              JSR SCRINIT
000010E8  4EB9 0000121E            325              JSR KBDINIT
000010EE  4EB9 000010FC            326              JSR SNDINIT
000010F4                           327      
000010F4  40E7                     328              MOVE.W  SR,-(A7)
000010F6  0257 D8FF                329              ANDI.W  #$D8FF,(A7)
000010FA                           330              
000010FA  4E73                     331              RTE
000010FC                           332           
000010FC                           333  
000010FC                           334  ; ------------------------------------------------------------------------------
000010FC                           335  SNDINIT
000010FC                           336  ; SOUND SYSTEM INIT
000010FC                           337  ; INPUT    : NONE
000010FC                           338  ; OUTPUT   : NONE
000010FC                           339  ; MODIFIES : NONE
000010FC                           340  ; ------------------------------------------------------------------------------
000010FC  48E7 C0C0                341              MOVEM.L D0-D1/A0-A1,-(A7)
00001100  4201                     342              CLR.B   D1
00001102  41F9 0000117C            343              LEA     .SNDLIST,A0
00001108  2018                     344  .LOOP       MOVE.L  (A0)+,D0
0000110A  6700 000E                345              BEQ     .DONE
0000110E  2240                     346              MOVE.L  D0,A1
00001110  103C 0047                347              MOVE.B  #71,D0
00001114  4E4F                     348              TRAP    #15
00001116  5201                     349              ADDQ.B  #1,D1
00001118  60EE                     350              BRA     .LOOP
0000111A  4CDF 0303                351  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
0000111E  4E75                     352              RTS
00001120= 73 6F 75 6E 64 73 ...    353  .SNDSHT     DC.B    'sounds/shoot.wav',0
00001131= 73 6F 75 6E 64 73 ...    354  .SNDDEM     DC.B    'sounds/demo.wav',0
00001141= 73 6F 75 6E 64 73 ...    355  .SNDHIT     DC.B    'sounds/explosion.wav',0
00001156= 73 6F 75 6E 64 73 ...    356  .SNDWIN     DC.B    'sounds/winsound.wav',0
0000116A= 73 6F 75 6E 64 73 ...    357  .SNDGOV     DC.B    'sounds/losing.wav',0   
0000117C= 00001120 00001131 ...    358  .SNDLIST    DC.L    .SNDSHT,.SNDDEM,.SNDHIT,.SNDWIN,.SNDGOV,0
00001194                           359  
00001194                           360  ; ------------------------------------------------------------------------------
00001194                           361  SNDPLAY
00001194                           362  ; PLAY SOUND
00001194                           363  ; INPUT    : D7 SOUND ID
00001194                           364  ; OUTPUT   : NONE
00001194                           365  ; MODIFIES : NONE
00001194                           366  ; ------------------------------------------------------------------------------
00001194  48A7 E000                367              MOVEM.W D0-D2,-(A7)
00001198                           368              ;DESACTIVATE DEMO MUSIC FISRT 
00001198  103C 004C                369              MOVE.B  #76,D0
0000119C  123C 0001                370              MOVE.B  #SNDDEM,D1
000011A0  7402                     371              MOVE.L  #2,D2
000011A2  4E4F                     372              TRAP    #15
000011A4  103C 0048                373              MOVE.B  #72,D0
000011A8  1207                     374              MOVE.B  D7,D1
000011AA  4E4F                     375              TRAP    #15
000011AC  4C9F 0007                376              MOVEM.W (A7)+,D0-D2
000011B0  4E73                     377              RTE   
000011B2                           378  ; ------------------------------------------------------------------------------
000011B2                           379  SCRINIT
000011B2                           380  ; INIT SYSTEM: SET SCREEN RESOLUTION AND WINDOWED MODE.
000011B2                           381  ; INPUT    : NONE
000011B2                           382  ; OUTPUT   : NONE
000011B2                           383  ; MODIFIES : NONE
000011B2                           384  ; ------------------------------------------------------------------------------
000011B2                           385  
000011B2  48E7 C000                386              MOVEM.L D0-D1,-(A7)
000011B6                           387  
000011B6                           388              ;SET SCREEN RESOLUTION
000011B6  103C 0021                389              MOVE.B  #33,D0
000011BA  223C 028001E0            390              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000011C0  4E4F                     391              TRAP    #15
000011C2                           392  
000011C2                           393              ;SET WINDOWED MODE
000011C2  7201                     394              MOVE.L  #1,D1
000011C4  4E4F                     395              TRAP    #15
000011C6                           396              
000011C6                           397              ;CLEAR SCREEN
000011C6  103C 000B                398              MOVE.B  #11,D0
000011CA  323C FF00                399              MOVE.W  #$FF00,D1
000011CE  4E4F                     400              TRAP    #15
000011D0                           401              
000011D0                           402              ;ENABLE DOUBLE BUFFER
000011D0  103C 005C                403              MOVE.B  #92,D0
000011D4  123C 0011                404              MOVE.B  #17,D1
000011D8  4E4F                     405              TRAP    #15
000011DA                           406              
000011DA                           407              ; ENABLE TIMED INTERRUPT
000011DA  103C 0020                408              MOVE.B  #32,D0
000011DE  123C 0006                409              MOVE.B  #6,D1
000011E2  143C 0081                410              MOVE.B  #$81,D2
000011E6  7614                     411              MOVE.L  #1000/SCRFPS,D3
000011E8  4E4F                     412              TRAP    #15
000011EA                           413              
000011EA                           414              ; CLEAR INTERRUPT COUNTER
000011EA  4239 00001F74            415              CLR.B   (SCRINTCT)
000011F0                           416              
000011F0  4CDF 0003                417              MOVEM.L (A7)+,D0-D1
000011F4  4E75                     418              RTS
000011F6                           419  
000011F6                           420  ; ------------------------------------------------------------------------------
000011F6                           421  SCRPLOT
000011F6                           422  ; UPDATES DOUBLE BUFFER
000011F6                           423  ; INPUT    : NONE
000011F6                           424  ; OUTPUT   : NONE
000011F6                           425  ; MODIFIES : NONE
000011F6                           426  ; ------------------------------------------------------------------------------
000011F6                           427              
000011F6  48A7 C000                428              MOVEM.W D0-D1,-(A7)
000011FA                           429              
000011FA                           430              ; SWITCH BUFFERS
000011FA  103C 005E                431              MOVE.B  #94,D0
000011FE  4E4F                     432              TRAP    #15
00001200                           433  
00001200                           434              ; CLEAR HIDDEN BUFFER
00001200  103C 000B                435              MOVE.B  #11,D0
00001204  323C FF00                436              MOVE.W  #$FF00,D1
00001208  4E4F                     437              TRAP    #15
0000120A                           438              
0000120A  4C9F 0003                439              MOVEM.W (A7)+,D0-D1
0000120E  4E73                     440              RTE
00001210                           441              
00001210                           442  ; ------------------------------------------------------------------------------
00001210                           443  SCRTIM
00001210                           444  ; TIMED INTERRUPT SERVICE ROUTINE
00001210                           445  ; INPUT    : NONE
00001210                           446  ; OUTPUT   : NONE
00001210                           447  ; MODIFIES : NONE
00001210                           448  ; ------------------------------------------------------------------------------
00001210  5239 00001F74            449              ADDQ.B  #1,(SCRINTCT)
00001216  5239 00001F75            450              ADDQ.B  #1,(SCRCYCCT)
0000121C  4E73                     451              RTE
0000121E                           452  
0000121E                           453   
0000121E                           454   ; ------------------------------------------------------------------------------
0000121E                           455  KBDINIT
0000121E                           456  ; INIT THE KEYBOARD 
0000121E                           457  ; INPUT    : NONE
0000121E                           458  ; OUTPUT   : NONE
0000121E                           459  ; MODIFIES : NONE
0000121E                           460  ; ------------------------------------------------------------------------------
0000121E                           461              
0000121E  4239 00001F72            462              CLR.B (KBDVAL)
00001224  4239 00001F73            463              CLR.B (KBDEDGE)
0000122A                           464              
0000122A  4E75                     465              RTS
0000122C                           466  
0000122C                           467   ; ------------------------------------------------------------------------------
0000122C                           468  KBDUPD
0000122C                           469  ; UPDATE THE KEYBOARD IN THIS ORDER:
0000122C                           470  ; KBDPAUSE  : BIT 7   
0000122C                           471  ; KBDFIRE3    : BIT 6   
0000122C                           472  ; KBDFIRE2 : BIT 5
0000122C                           473  ; KBDFIRE1  : BIT 4
0000122C                           474  ; KBDLEFT  : BIT 3   
0000122C                           475  ; KBDUP    : BIT 2   
0000122C                           476  ; KBDRIGHT : BIT 1
0000122C                           477  ; KBDDOWN  : BIT 0
0000122C                           478  ; INPUT    : NONE
0000122C                           479  ; OUTPUT   : NONE
0000122C                           480  ; MODIFIES : NONE
0000122C                           481  ; ------------------------------------------------------------------------------
0000122C                           482              
0000122C  48E7 F000                483              MOVEM.L D0-D3,-(A7)
00001230                           484              
00001230                           485              ;BITS 4-7
00001230                           486              ; READ FIRST PART
00001230  103C 0013                487              MOVE.B  #19,D0
00001234  223C 50104D20            488              MOVE.L  #KBDPAUSE<<24|KBDFIRE3<<16|KBDFIRE2<<8|KBDFIRE1,D1
0000123A  4E4F                     489              TRAP    #15
0000123C                           490              
0000123C  4EB9 0000126C            491              JSR     .PACK
00001242                           492              
00001242                           493              ;BITS 0-3
00001242                           494              ; READ SECOND PART
00001242  223C 25262728            495              MOVE.L  #KBDLEFT<<24|KBDUP<<16|KBDRIGHT<<8|KBDDOWN,D1
00001248  4E4F                     496              TRAP    #15
0000124A                           497  
0000124A                           498              ; CONVERT TO DESIRED FORMAT
0000124A  4EB9 0000126C            499              JSR     .PACK
00001250                           500              
00001250                           501              ;COMPUTE KBDEDGE
00001250  1039 00001F72            502              MOVE.B  (KBDVAL),D0
00001256  4600                     503              NOT.B   D0
00001258  C002                     504              AND.B   D2,D0
0000125A  13C0 00001F73            505              MOVE.B  D0,(KBDEDGE)
00001260                           506              
00001260  13C2 00001F72            507              MOVE.B  D2,(KBDVAL)
00001266                           508              
00001266  4CDF 000F                509              MOVEM.L (A7)+,D0-D3
0000126A  4E73                     510              RTE
0000126C                           511              
0000126C  363C 0003                512  .PACK       MOVE.W  #3,D3
00001270  E189                     513  .LOOP       LSL.L   #8,D1
00001272  E312                     514              ROXL.B  #1,D2
00001274  51CB FFFA                515              DBRA.W  D3,.LOOP
00001278  4E75                     516              RTS
0000127A                           517  
0000127A                           518  ; ------------------------------------------------------------------------------
0000127A                           519  SYSUPD
0000127A                           520  ; UPDATES THE SYSTEM 
0000127A                           521  ; INPUT    : NONE
0000127A                           522  ; OUTPUT   : NONE
0000127A                           523  ; MODIFIES : NONE
0000127A                           524  ; ------------------------------------------------------------------------------
0000127A                           525  
0000127A  4E75                     526              RTS
0000127C                           527  
0000127C                           528  ; ------------------------------------------------------------------------------
0000127C                           529  SYSPLOT
0000127C                           530  ; PLOT THE SYSTEM.
0000127C                           531  ; INPUT    : NONE
0000127C                           532  ; OUTPUT   : NONE
0000127C                           533  ; MODIFIES : NONE
0000127C                           534  ; ------------------------------------------------------------------------------
0000127C                           535      
0000127C  4E75                     536              RTS
0000127E                           537  
0000127E                           538  
0000127E                           539  
0000127E                           540  
0000127E                           541  
0000127E                           542  
0000127E                           543  
0000127E                           544  
0000127E                           545  
0000127E                           546  
0000127E                           547  
0000127E                           548  
0000127E                           549  
0000127E                           550  
0000127E                           551  -------------------- end include --------------------
0000127E                           552              INCLUDE "MACROS.X68"            ;EL ORDEN IMPORTA
0000127E                           553      
0000127E                           554  ;------------------------------------------------------------------------------
0000127E                           555  SET_PEN_COLOR   MACRO
0000127E                           556  ; SETS THE PEN COLOR FOR DRAWING
0000127E                           557  ; INPUT    : \1 COLOR IN $00BBGGRR FORMAT 
0000127E                           558  ; OUTPUT   : NONE
0000127E                           559  ; MODIFIES : D0,D1
0000127E                           560  ;------------------------------------------------------------------------------
0000127E                           561      MOVEM.L D0-D1,-(A7)
0000127E                           562      
0000127E                           563      MOVE.B  #80,D0
0000127E                           564      MOVE.L  \1,D1
0000127E                           565      TRAP    #15
0000127E                           566              
0000127E                           567      MOVEM.L (A7)+,D0-D1
0000127E                           568      ENDM
0000127E                           569  
0000127E                           570  ;------------------------------------------------------------------------------
0000127E                           571  SET_FILL_COLOR  MACRO
0000127E                           572  ; SETS THE FILL COLOR FOR DRAWING
0000127E                           573  ; INPUT    : \1 COLOR IN $00BBGGRR FORMAT 
0000127E                           574  ; OUTPUT   : NONE
0000127E                           575  ; MODIFIES : D0,D1
0000127E                           576  ;------------------------------------------------------------------------------
0000127E                           577      MOVEM.L D0-D1,-(A7)
0000127E                           578      
0000127E                           579      MOVE.B  #81,D0
0000127E                           580      MOVE.L  \1,D1
0000127E                           581      TRAP    #15
0000127E                           582              
0000127E                           583      MOVEM.L (A7)+,D0-D1
0000127E                           584      ENDM
0000127E                           585  
0000127E                           586  
0000127E                           587  -------------------- end include --------------------
0000127E                           588              INCLUDE "LIB/AGLCODE.X68"
0000127E                           589  ; =============================================================================
0000127E                           590  ; AGENT MANAGEMENT
0000127E                           591  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
0000127E                           592  ; +0 - LONG : UPDATE SUBROUTINE POINTER
0000127E                           593  ; +4 - LONG : PLOT SUBROUTINE POINTER
0000127E                           594  ; +8:END    : DATA (AGENT SPECIFIC)
0000127E                           595  ; =============================================================================
0000127E                           596  
0000127E                           597  ; -----------------------------------------------------------------------------
0000127E                           598  AGLADD
0000127E                           599  ; CREATES A NEW AGENT
0000127E                           600  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
0000127E                           601  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
0000127E                           602  ;            A3 - POINTER TO AGENT PLOT FUNCTION
0000127E                           603  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
0000127E                           604  ;            D1 - AGENT INITIALIZATION PARAMETER 1
0000127E                           605  ;            D2 - AGENT INITIALIZATION PARAMETER 2
0000127E                           606  ;            D3 - AGENT INITIALIZATION PARAMETER 3
0000127E                           607  ; OUTPUT   - NONE
0000127E                           608  ; MODIFIES - NONE
0000127E                           609  ; -----------------------------------------------------------------------------
0000127E  2F08                     610              MOVE.L  A0,-(A7)
00001280  4EB8 1092                611              JSR     DMMALLOC
00001284  B1FC 00000000            612              CMP.L   #0,A0
0000128A  6700 0008                613              BEQ     .END
0000128E  20CA                     614              MOVE.L  A2,(A0)+
00001290  20CB                     615              MOVE.L  A3,(A0)+
00001292  4E91                     616              JSR     (A1)
00001294  205F                     617  .END        MOVE.L  (A7)+,A0
00001296  4E75                     618              RTS
00001298                           619  
00001298                           620  ; -----------------------------------------------------------------------------
00001298                           621  AGLUPD
00001298                           622  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001298                           623  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001298                           624  ; INPUT    - NONE
00001298                           625  ; OUTPUT   - NONE
00001298                           626  ; MODIFIES - NONE
00001298                           627  ; -----------------------------------------------------------------------------
00001298  48E7 00C0                628              MOVEM.L A0-A1,-(A7)
0000129C  4EB8 1022                629              JSR     DMMFIRST
000012A0  B1FC 00000000            630  .LOOP       CMP.L   #0,A0
000012A6  6700 000E                631              BEQ     .END
000012AA  2250                     632              MOVE.L  (A0),A1
000012AC  5088                     633              ADD.L   #8,A0
000012AE  4E91                     634              JSR     (A1)
000012B0  4EB8 1044                635              JSR     DMMNEXT
000012B4  60EA                     636              BRA     .LOOP
000012B6  4CDF 0300                637  .END        MOVEM.L (A7)+,A0-A1
000012BA  4E75                     638              RTS
000012BC                           639  
000012BC                           640  ; -----------------------------------------------------------------------------
000012BC                           641  AGLPLOT
000012BC                           642  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000012BC                           643  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000012BC                           644  ; INPUT    - NONE
000012BC                           645  ; OUTPUT   - NONE
000012BC                           646  ; MODIFIES - NONE
000012BC                           647  ; -----------------------------------------------------------------------------
000012BC  48E7 00C0                648              MOVEM.L A0-A1,-(A7)
000012C0  4EB8 1022                649              JSR     DMMFIRST
000012C4  B1FC 00000000            650  .LOOP       CMP.L   #0,A0
000012CA  6700 0010                651              BEQ     .END
000012CE  2268 0004                652              MOVE.L  4(A0),A1
000012D2  5088                     653              ADD.L   #8,A0
000012D4  4E91                     654              JSR     (A1)
000012D6  4EB8 1044                655              JSR     DMMNEXT
000012DA  60E8                     656              BRA     .LOOP
000012DC  4CDF 0300                657  .END        MOVEM.L (A7)+,A0-A1
000012E0  4E75                     658              RTS
000012E2                           659  
000012E2                           660  ; -----------------------------------------------------------------------------
000012E2  =000010AC                661  AGLKILL     EQU     DMMFREE
000012E2                           662  ; KILLS THE AGENT BY RELEASING ITS MEMORY
000012E2                           663  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
000012E2                           664  ; OUTPUT   - NONE
000012E2                           665  ; MODIFIES - NONE
000012E2                           666  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
000012E2                           667  ; -----------------------------------------------------------------------------
000012E2                           668  -------------------- end include --------------------
000012E2                           669              INCLUDE "LIB/UTLCODE.X68"
000012E2                           670  ; =============================================================================
000012E2                           671  ; UTILITY CODE
000012E2                           672  ; =============================================================================
000012E2                           673  
000012E2                           674  ; -----------------------------------------------------------------------------
000012E2                           675  UTLINIT
000012E2                           676  ; INITIALIZES UTILITY CODE
000012E2                           677  ; INPUT    - NONE
000012E2                           678  ; OUTPUT   - NONE
000012E2                           679  ; MODIFIES - NONE
000012E2                           680  ; -----------------------------------------------------------------------------
000012E2  48E7 C000                681              MOVEM.L D0-D1,-(A7)
000012E6  103C 0008                682              MOVE.B  #8,D0
000012EA  4E4F                     683              TRAP    #15
000012EC  13C1 00001F70            684              MOVE.B  D1,(UTLRNDIX)
000012F2  4CDF 0003                685              MOVEM.L (A7)+,D0-D1
000012F6  4E75                     686              RTS
000012F8                           687              
000012F8                           688  ; -----------------------------------------------------------------------------
000012F8                           689  UTLPRINT
000012F8                           690  ; PRINT SCREEN CENTERED TEXT
000012F8                           691  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
000012F8                           692  ;            D0.B SCREEN ROW TO PRINT TEXT
000012F8                           693  ; OUTPUT   : D0.B NEXT ROW
000012F8                           694  ; MODIFIES : NONE (ASIDE OF OUTPUT)
000012F8                           695  ; -----------------------------------------------------------------------------
000012F8  48E7 C0C0                696              MOVEM.L D0-D1/A0-A1,-(A7)
000012FC  4201                     697              CLR.B   D1
000012FE  2248                     698              MOVE.L  A0,A1
00001300  4A18                     699  .LOOP       TST.B   (A0)+
00001302  6700 0006                700              BEQ     .ENDLOOP
00001306  5201                     701              ADDQ.B  #1,D1
00001308  60F6                     702              BRA     .LOOP
0000130A  E209                     703  .ENDLOOP    LSR.B   #1,D1
0000130C  0401 0028                704              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00001310  4401                     705              NEG.B   D1
00001312  E141                     706              ASL.W   #8,D1
00001314  8240                     707              OR.W    D0,D1
00001316  103C 000B                708              MOVE.B  #11,D0
0000131A  4E4F                     709              TRAP    #15
0000131C  103C 000D                710              MOVE.B  #13,D0
00001320  4E4F                     711              TRAP    #15
00001322  4CDF 0303                712              MOVEM.L (A7)+,D0-D1/A0-A1
00001326  5200                     713              ADDQ.B  #1,D0
00001328  4E75                     714              RTS
0000132A                           715  
0000132A                           716  
0000132A                           717  ; -----------------------------------------------------------------------------
0000132A                           718  UTLRAND
0000132A                           719  ; PROVIDES A PSEUDO-RANDOM BYTE
0000132A                           720  ; INPUT    - NONE
0000132A                           721  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
0000132A                           722  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000132A                           723  ; -----------------------------------------------------------------------------
0000132A  2F08                     724              MOVE.L  A0,-(A7)
0000132C  41F9 00001348            725              LEA     .RANDVEC,A0
00001332  4280                     726              CLR.L   D0
00001334  1039 00001F70            727              MOVE.B  (UTLRNDIX),D0
0000133A  1030 0800                728              MOVE.B  (A0,D0.L),D0
0000133E  5239 00001F70            729              ADDQ.B  #1,(UTLRNDIX)
00001344  205F                     730              MOVE.L  (A7)+,A0
00001346  4E75                     731              RTS
00001348                           732  
00001348                           733  
00001348= A2 EE 9A 0C F5 24 ...    734  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001350= 2A A3 51 26 E0 AC ...    735              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001358= 75 51 CA FD 33 EB ...    736              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001360= 60 CC E7 B8 9A EB ...    737              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001368= 1D 76 B5 95 B0 89 ...    738              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001370= 39 15 48 C9 6E CA ...    739              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001378= 43 E7 E2 7C 37 25 ...    740              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001380= E9 94 CE E9 E4 52 ...    741              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001388= 37 6D 9A 84 A2 28 ...    742              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001390= 19 E2 C6 77 80 D4 ...    743              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001398= 0A 5A 32 67 33 C2 ...    744              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000013A0= 59 80 DC 0E 57 FC ...    745              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000013A8= 8A AB BC F7 07 4D ...    746              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000013B0= EF D5 77 6E 1E BB ...    747              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000013B8= D6 E0 2A 8F BD 28 ...    748              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000013C0= 13 4F 66 EC 0A 64 ...    749              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000013C8= 56 52 9A 16 9B 90 ...    750              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
000013D0= 06 8A A4 F7 01 DA ...    751              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000013D8= F2 E7 77 28 B1 76 ...    752              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
000013E0= A4 42 E3 81 B1 67 ...    753              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000013E8= BF CE FA 16 BF 38 ...    754              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000013F0= D1 8B 50 0C 5F 49 ...    755              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
000013F8= DE 4C 14 A2 40 DC ...    756              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001400= B6 9B 0A 38 5D AB ...    757              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001408= E2 1B DD 75 15 82 ...    758              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001410= 8A 26 51 30 9F 47 ...    759              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001418= 1E 8A BB 71 C6 6E ...    760              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001420= 9F 47 E5 34 94 27 ...    761              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001428= 7D 06 D6 BA 30 0F ...    762              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001430= EC 7F 7E 03 CF 2D ...    763              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001438= 94 5B 23 F2 8B CD ...    764              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001440= 74 33 EC B9 0F D5 ...    765              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001448                           766  
00001448                           767  -------------------- end include --------------------
00001448                           768              INCLUDE "TANK.X68"
00001448                           769    
00001448                           770  ; ------------------------------------------------------------------------------
00001448                           771  TNKINIT
00001448                           772  ; INITIALIZE TANK
00001448                           773  ; INPUT    :  
00001448                           774  ; OUTPUT   : NONE
00001448                           775  ; MODIFIES : NONE
00001448                           776  ; ------------------------------------------------------------------------------
00001448                           777  
00001448  33FC 011C 00001F56       778              MOVE.W  #SCRWIDTH/2-TNKWIDHA,(TNKPOSX)  ;MITAD PANTALLA - MITAD ANCHO DEL TANQUE
00001450                           779  
00001450  4E75                     780              RTS
00001452                           781              
00001452                           782  ; ------------------------------------------------------------------------------
00001452                           783  TNKUPD
00001452                           784  ; UPDATES THE TANK
00001452                           785  ; INPUT    : 
00001452                           786  ; OUTPUT   : NONE
00001452                           787  ; MODIFIES : NONE
00001452                           788  ; ------------------------------------------------------------------------------
00001452                           789  
00001452  3F00                     790              MOVE.W D0,-(A7)
00001454                           791              
00001454                           792              ;GUARDAR VARIABLE EN REGISTRO
00001454  3039 00001F56            793              MOVE.W  (TNKPOSX),D0        
0000145A                           794              
0000145A                           795              ;MOVER DERECHA SI TECLA: ->
0000145A  0839 0001 00001F72       796              BTST.B  #1,(KBDVAL)
00001462  6700 0004                797              BEQ     .LEFT
00001466  5040                     798              ADD.W   #TNKSPEED,D0
00001468                           799             
00001468                           800              ;MOVER IZQUIERDA SI TECLA: <-
00001468  0839 0003 00001F72       801  .LEFT       BTST.B  #3,(KBDVAL)
00001470  6700 0004                802              BEQ     .CHKLEFT
00001474  5140                     803              SUB.W   #TNKSPEED,D0
00001476                           804                
00001476                           805              ;COMPOBAR COLISIONES PANTALLA
00001476                           806              ;COMPROBAR COLISIÓN IZQUIERDA
00001476  B07C 0000                807  .CHKLEFT    CMP.W   #0,D0
0000147A  6C00 0008                808              BGE     .CHKRIGHT
0000147E  4240                     809              CLR.W   D0                          ;LO COLOCA A LA IZQUIERDA DE LA PANTALLA
00001480  6000 000E                810              BRA     .DONE
00001484                           811  
00001484                           812              ;COMPROBAR COLISIÓN DERECHA
00001484  B07C 0238                813  .CHKRIGHT   CMP.W   #SCRWIDTH-TNKWIDTH,D0     
00001488  6F00 0006                814              BLE     .DONE
0000148C                           815              ;RESTA ANCHO DEL TANQUE
0000148C  303C 0238                816              MOVE.W  #SCRWIDTH-TNKWIDTH,D0       ;LO COLOCA A LA DERECHA DE LA PANTALLA     
00001490                           817              
00001490                           818              ;ACTUALIZAR VARIABLE
00001490  33C0 00001F56            819  .DONE       MOVE.W  D0,(TNKPOSX)
00001496                           820  
00001496  301F                     821              MOVE.W (A7)+,D0
00001498  4E75                     822              RTS
0000149A                           823  
0000149A                           824  ; ------------------------------------------------------------------------------
0000149A                           825  TNKPLOT
0000149A                           826  ; PLOT THE TANK.
0000149A                           827  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
0000149A                           828  ; OUTPUT   : NONE
0000149A                           829  ; MODIFIES : NONE
0000149A                           830  ; ------------------------------------------------------------------------------
0000149A                           831      
0000149A  48E7 FE80                832              MOVEM.L D0-D6/A0,-(A7)
0000149E                           833              
0000149E                           834              ;ESTABLECER COLOR CONTORNO
0000149E                           835m             SET_PEN_COLOR #TNKPNCLR
0000149E                           836m ; SETS THE PEN COLOR FOR DRAWING
0000149E                           837m ; INPUT    : #TNKPNCLR COLOR IN $00BBGGRR FORMAT 
0000149E                           838m ; OUTPUT   : NONE
0000149E                           839m ; MODIFIES : D0,D1
0000149E                           840m ;------------------------------------------------------------------------------
000014B2                           841  
000014B2                           842              ;ESTABLECER COLOR RELLENO
000014B2                           843m             SET_FILL_COLOR  #TNKFLCLR
000014B2                           844m ; SETS THE FILL COLOR FOR DRAWING
000014B2                           845m ; INPUT    : #TNKFLCLR COLOR IN $00BBGGRR FORMAT 
000014B2                           846m ; OUTPUT   : NONE
000014B2                           847m ; MODIFIES : D0,D1
000014B2                           848m ;------------------------------------------------------------------------------
000014C6                           849              
000014C6                           850              ;DIBUJAR TANQUE
000014C6  43F9 00001508            851              LEA     TNKMAP,A1
000014CC  103C 0057                852              MOVE.B  #87,D0
000014D0  343C 01A0                853              MOVE.W  #TNKPOSY,D2
000014D4  383C 01A8                854              MOVE.W  #TNKPOSY+TNKSQUWI,D4                ;DEFINIR POSICIÓN Y
000014D8  3C3C 0005                855              MOVE.W  #TNKROW-1,D6                        ;FILAS
000014DC                           856  
000014DC  3239 00001F56            857  .CLOOP      MOVE.W  (TNKPOSX),D1
000014E2  3601                     858              MOVE.W  D1,D3
000014E4  5043                     859              ADD.W   #TNKSQUWI,D3                        ;DEFINIR POSICIÓN X
000014E6  3A3C 0008                860              MOVE.W  #TNKCOL-1,D5                        ;COLUMNAS
000014EA  4A19                     861  .RLOOP      TST.B   (A1)+
000014EC  6700 0004                862              BEQ     .NEXT
000014F0  4E4F                     863              TRAP    #15
000014F2  3203                     864  .NEXT       MOVE.W  D3,D1
000014F4  5043                     865              ADD.W   #TNKSQUWI,D3
000014F6  51CD FFF2                866              DBRA.W  D5,.RLOOP
000014FA  3404                     867              MOVE.W  D4,D2
000014FC  5044                     868              ADD.W   #TNKSQUWI,D4
000014FE  51CE FFDC                869              DBRA.W  D6,.CLOOP
00001502                           870  
00001502  4CDF 027F                871              MOVEM.L (A7)+,D0-D6/A1
00001506                           872  
00001506  4E75                     873              RTS
00001508                           874              
00001508= 00 00 00 00 01 00 ...    875  TNKMAP      DC.B    0,0,0,0,1,0,0,0,0    
00001511= 00 00 00 01 01 01 ...    876              DC.B    0,0,0,1,1,1,0,0,0
0000151A= 00 00 00 01 01 01 ...    877              DC.B    0,0,0,1,1,1,0,0,0
00001523= 01 01 01 01 01 01 ...    878              DC.B    1,1,1,1,1,1,1,1,1
0000152C= 01 01 01 01 01 01 ...    879              DC.B    1,1,1,1,1,1,1,1,1
00001535= 01 01 01 01 01 01 ...    880              DC.B    1,1,1,1,1,1,1,1,1
0000153E                           881              DS.W    0
0000153E                           882  
0000153E                           883  
0000153E                           884  
0000153E                           885  
0000153E                           886  
0000153E                           887  
0000153E                           888  
0000153E                           889  
0000153E                           890  
0000153E                           891  
0000153E                           892  
0000153E                           893  
0000153E                           894  
0000153E                           895  
0000153E                           896  
0000153E                           897  
0000153E                           898  
0000153E                           899  
0000153E                           900  
0000153E                           901  
0000153E                           902  
0000153E                           903  
0000153E                           904  
0000153E                           905  
0000153E                           906  -------------------- end include --------------------
0000153E                           907              INCLUDE "ALIEN.X68"
0000153E                           908  ; ------------------------------------------------------------------------------
0000153E                           909  ALNINIT
0000153E                           910  ; INITIALIZE ALIEN
0000153E                           911  ; INPUT    : NONE 
0000153E                           912  ; OUTPUT   : NONE
0000153E                           913  ; MODIFIES : NONE
0000153E                           914  ; ------------------------------------------------------------------------------
0000153E  33FC 0078 00001F58       915              MOVE.W  #ALNIPOSX,(ALNPOSX)
00001546  33FC 0050 00001F5A       916              MOVE.W  #ALNIPOSY,(ALNPOSY)
0000154E  33FC 0008 00001F5C       917              MOVE.W  #ALNSPD1,(ALNVELX)      ;VELOCIDAD NIVEL 1
00001556  33FC 000C 00001F5E       918              MOVE.W  #ALNSPD2,(ALNVELX2)     ;VELOCIDAD NIVEL 2
0000155E  33FC 000C 00001F60       919              MOVE.W  #ALNPIXEL,(ALNVELY)
00001566  4EB9 0000175A            920              JSR     MAPPLOT
0000156C                           921                      
0000156C  4E75                     922              RTS
0000156E                           923  
0000156E                           924  ; ------------------------------------------------------------------------------
0000156E                           925  ALNUPD
0000156E                           926  ; UPDATES THE ALIEN
0000156E                           927  ; INPUT    : NONE
0000156E                           928  ; OUTPUT   : NONE
0000156E                           929  ; MODIFIES : NONE
0000156E                           930  ; ------------------------------------------------------------------------------
0000156E  48E7 C000                931              MOVEM.L D0-D1,-(A7)
00001572                           932              
00001572                           933              ;GUARDA COORDENADAS
00001572  3039 00001F58            934              MOVE.W  (ALNPOSX),D0
00001578  3239 00001F5A            935              MOVE.W  (ALNPOSY),D1
0000157E                           936              
0000157E                           937              ;MIRAR EN QUÉ RANGO ESTÁ POS(Y)
0000157E                           938              ;PARA DETERMINAR EL NIVEL DE DIFICULTAD
0000157E  B27C 0090                939              CMP.W   #144,D1
00001582  6D00 000E                940              BLT     .LVL1
00001586  B27C 00D0                941              CMP.W   #208,D1
0000158A  6D00 0018                942              BLT     .LVL2
0000158E  6000 0026                943              BRA     .LVL3   
00001592                           944              
00001592                           945              ;NIVEL 1
00001592  33FC 0001 00001F6A       946  .LVL1       MOVE.W  #NIVEL1,(SCOLEVEL)
0000159A  D079 00001F5C            947              ADD.W   (ALNVELX),D0    ;VELOCIDAD ESTÁNDAR
000015A0  6000 0028                948              BRA     .CHKCOL
000015A4                           949              
000015A4                           950              ;NIVEL 2
000015A4  33FC 0002 00001F6A       951  .LVL2       MOVE.W  #NIVEL2,(SCOLEVEL)
000015AC  D079 00001F5E            952              ADD.W   (ALNVELX2),D0   ;1,5 VECES MÁS RÁPIDO
000015B2  6000 0016                953              BRA     .CHKCOL
000015B6                           954  
000015B6                           955              ;NIVEL 3
000015B6  33FC 0003 00001F6A       956  .LVL3       MOVE.W  #NIVEL3,(SCOLEVEL)
000015BE  D079 00001F5C            957              ADD.W   (ALNVELX),D0
000015C4  D079 00001F5C            958              ADD.W   (ALNVELX),D0    ;DOBLE MÁS RÁPIDO        
000015CA                           959                  
000015CA                           960              ; CHECK HORIZONTAL COLLISIONS
000015CA  B07C 00C8                961  .CHKCOL     CMP.W   #SCRWIDTH-440,D0
000015CE  6E00 000E                962              BGT     .COLRGT
000015D2  B07C 0028                963              CMP.W   #ALNDIM,D0
000015D6  6D00 0020                964              BLT     .COLLFT
000015DA  6000 0032                965              BRA     .DONE
000015DE                           966              
000015DE                           967              ; RIGHT SIDE COLLISION
000015DE  D279 00001F60            968  .COLRGT     ADD.W   (ALNVELY),D1
000015E4  4479 00001F5C            969              NEG.W   (ALNVELX)
000015EA  4479 00001F5E            970              NEG.W   (ALNVELX2)
000015F0  303C 00C8                971              MOVE.W  #SCRWIDTH-440,D0
000015F4  6000 0018                972              BRA     .DONE
000015F8                           973              
000015F8                           974              ; LEFT SIDE COLLISION
000015F8  D279 00001F60            975  .COLLFT     ADD.W   (ALNVELY),D1
000015FE  4479 00001F5C            976              NEG.W   (ALNVELX)
00001604  4479 00001F5E            977              NEG.W   (ALNVELX2)
0000160A  303C 0028                978              MOVE.W  #ALNDIM,D0
0000160E                           979        
0000160E                           980              ;ESTABLECE COORDENADAS
0000160E  33C0 00001F58            981  .DONE       MOVE.W  D0,(ALNPOSX)
00001614  33C1 00001F5A            982              MOVE.W  D1,(ALNPOSY)
0000161A                           983  
0000161A  4CDF 0003                984              MOVEM.L (A7)+,D0-D1 
0000161E  4E75                     985              RTS
00001620                           986  
00001620                           987  
00001620                           988  ;-----------------------DIBUJO ALIENS--------------------------------------------
00001620                           989  
00001620                           990  ALNPLOT
00001620                           991  ;--------------------------------------------------------------------------------
00001620                           992  ;DIBUJA UNA CUADRICULA 3*10 PARA QUE HAYA UN ALIEN EN CADA UNA DE ELLAS.
00001620                           993  ; INPUT    : NONE
00001620                           994  ; OUTPUT   : NONE
00001620                           995  ; MODIFIES : NONE
00001620                           996  ;--------------------------------------------------------------------------------
00001620                           997      
00001620  48E7 7E20                998              MOVEM.L D1-D6/A2,-(A7)
00001624                           999                  
00001624                          1000              ;DEFINE COLORES
00001624                          1001m             SET_PEN_COLOR   #ALNPNCLR
00001624                          1002m ; SETS THE PEN COLOR FOR DRAWING
00001624                          1003m ; INPUT    : #ALNPNCLR COLOR IN $00BBGGRR FORMAT 
00001624                          1004m ; OUTPUT   : NONE
00001624                          1005m ; MODIFIES : D0,D1
00001624                          1006m ;------------------------------------------------------------------------------
00001638                          1007m             SET_FILL_COLOR  #ALNFLCLR
00001638                          1008m ; SETS THE FILL COLOR FOR DRAWING
00001638                          1009m ; INPUT    : #ALNFLCLR COLOR IN $00BBGGRR FORMAT 
00001638                          1010m ; OUTPUT   : NONE
00001638                          1011m ; MODIFIES : D0,D1
00001638                          1012m ;------------------------------------------------------------------------------
0000164C                          1013              
0000164C  45F9 00001698           1014              LEA     MAPDATA,A2      
00001652                          1015              
00001652                          1016              ;CALCULAR COORDENADAS
00001652  3439 00001F5A           1017              MOVE.W  (ALNPOSY),D2
00001658  3802                    1018              MOVE.W  D2,D4
0000165A  0644 0028               1019              ADD.W   #ALNDIM,D4          ;POSICIÓN Y
0000165E  3C3C 0002               1020              MOVE.W  #ALNMPROW-1,D6      ;FILAS MAPA
00001662                          1021  
00001662  3239 00001F58           1022  .CLOOP      MOVE.W  (ALNPOSX),D1
00001668  3601                    1023              MOVE.W  D1,D3
0000166A  0643 0028               1024              ADD.W   #ALNDIM,D3          ;POSICIÓN X
0000166E  3A3C 0009               1025              MOVE.W  #ALNMPCOL-1,D5      ;COLUMNAS MAPA
00001672  4A1A                    1026  .RLOOP      TST.B   (A2)+
00001674  6700 0008               1027              BEQ     .NEXT
00001678  4EB9 000016B6           1028              JSR     ALNPLOT1            ;DIBUJA ALIEN
0000167E  3203                    1029  .NEXT       MOVE.W  D3,D1
00001680  0643 0028               1030              ADD.W   #ALNDIM,D3
00001684  51CD FFEC               1031              DBRA.W  D5,.RLOOP
00001688  3404                    1032              MOVE.W  D4,D2
0000168A  0644 0028               1033              ADD.W   #ALNDIM,D4
0000168E  51CE FFD2               1034              DBRA.W  D6,.CLOOP
00001692                          1035  
00001692  4CDF 047E               1036              MOVEM.L (A7)+,D1-D6/A2
00001696  4E75                    1037              RTS   
00001698                          1038   
00001698= 01 01 01 01 01 01 ...   1039  MAPDATA     DC.B    1,1,1,1,1,1,1,1,1,1
000016A2= 01 01 01 01 01 01 ...   1040              DC.B    1,1,1,1,1,1,1,1,1,1
000016AC= 01 01 01 01 01 01 ...   1041              DC.B    1,1,1,1,1,1,1,1,1,1
000016B6                          1042              DS.W    0
000016B6                          1043  
000016B6                          1044  ; ------------------------------------------------------------------------------
000016B6                          1045  ALNPLOT1
000016B6                          1046  ; DIBUJA EL ALIEN 
000016B6                          1047  ; INPUT    : NONE
000016B6                          1048  ; OUTPUT   : NONE
000016B6                          1049  ; MODIFIES : NONE
000016B6                          1050  ; ------------------------------------------------------------------------------
000016B6                          1051  
000016B6  48E7 FF40               1052              MOVEM.L D0-D7/A1,-(A7)
000016BA                          1053              
000016BA  3E01                    1054              MOVE.W  D1,D7           ;GUARDA REGISTRO                       
000016BC                          1055              
000016BC  43F9 000016F6           1056              LEA     ALNDATA,A1
000016C2  103C 0057               1057              MOVE.B  #87,D0
000016C6                          1058               
000016C6  3802                    1059              MOVE.W  D2,D4
000016C8  5844                    1060              ADD.W   #ALNDIM/ALNROW,D4           ;POSICIÓN Y
000016CA  3C3C 0009               1061              MOVE.W  #ALNROW-1,D6    ;FILAS ALIEN             
000016CE                          1062  
000016CE  3207                    1063  .CLOOP1     MOVE.W  D7,D1           ;RESTAURA REGISTRO
000016D0  3601                    1064              MOVE.W  D1,D3
000016D2  5843                    1065              ADD.W   #ALNDIM/ALNROW,D3           ;POSICIÓN X    
000016D4  3A3C 0009               1066              MOVE.W  #ALNCOL-1,D5    ;COLUMNAS ALIEN                   
000016D8  4A19                    1067  .RLOOP1     TST.B   (A1)+
000016DA  6700 0004               1068              BEQ     .NEXT1
000016DE  4E4F                    1069              TRAP    #15
000016E0  3203                    1070  .NEXT1      MOVE.W  D3,D1
000016E2  5843                    1071              ADD.W   #ALNDIM/ALNROW,D3
000016E4  51CD FFF2               1072              DBRA.W  D5,.RLOOP1
000016E8  3404                    1073              MOVE.W  D4,D2
000016EA  5844                    1074              ADD.W   #ALNDIM/ALNROW,D4
000016EC  51CE FFE0               1075              DBRA.W  D6,.CLOOP1
000016F0                          1076  
000016F0  4CDF 02FF               1077              MOVEM.L (A7)+,D0-D7/A1
000016F4  4E75                    1078              RTS
000016F6                          1079  
000016F6= 00 00 00 00 00 00 ...   1080  ALNDATA     DC.B    0,0,0,0,0,0,0,0,0,0
00001700= 00 00 00 00 00 00 ...   1081              DC.B    0,0,0,0,0,0,0,0,0,0
0000170A= 00 00 00 01 01 01 ...   1082              DC.B    0,0,0,1,1,1,1,0,0,0
00001714= 00 00 01 01 01 01 ...   1083              DC.B    0,0,1,1,1,1,1,1,0,0
0000171E= 00 00 01 00 01 01 ...   1084              DC.B    0,0,1,0,1,1,0,1,0,0
00001728= 00 00 01 01 00 00 ...   1085              DC.B    0,0,1,1,0,0,1,1,0,0
00001732= 00 00 00 01 01 01 ...   1086              DC.B    0,0,0,1,1,1,1,0,0,0
0000173C= 00 00 01 00 00 00 ...   1087              DC.B    0,0,1,0,0,0,0,1,0,0
00001746= 00 00 00 00 00 00 ...   1088              DC.B    0,0,0,0,0,0,0,0,0,0
00001750= 00 00 00 00 00 00 ...   1089              DC.B    0,0,0,0,0,0,0,0,0,0
0000175A                          1090              DS.W    0
0000175A                          1091  
0000175A                          1092  
0000175A                          1093  ; ------------------------------------------------------------------------------
0000175A                          1094  MAPPLOT
0000175A                          1095  ; RELLENA EL MAPDATA 
0000175A                          1096  ; INPUT    : NONE
0000175A                          1097  ; OUTPUT   : NONE
0000175A                          1098  ; MODIFIES : NONE
0000175A                          1099  ; ------------------------------------------------------------------------------
0000175A  48A7 6040               1100              MOVEM.W D1-D2/A1,-(A7)
0000175E                          1101              
0000175E  43F8 1698               1102              LEA     MAPDATA,A1         
00001762  7201                    1103              MOVEQ   #1,D1              
00001764  741D                    1104              MOVEQ   #ALNMPROW*ALNMPCOL-1,D2             
00001766                          1105  
00001766                          1106  RESET_LOOP
00001766  12C1                    1107              MOVE.B  D1,(A1)+           ;ESTABLECER EL VALOR EN LA UBICACIÓN ACTUAL Y AVANZAR
00001768  51CA FFFC               1108              DBRA    D2,RESET_LOOP      ;DECREMENTAR D2 Y SALTAR SI NO HA ALCANZADO LA LONGITUD TOTAL
0000176C                          1109  
0000176C  4C9F 0206               1110              MOVEM.W (A7)+,D1-D2/A1
00001770  4E75                    1111              RTS  
00001772                          1112  
00001772                          1113  
00001772                          1114  
00001772                          1115  
00001772                          1116  
00001772                          1117       
00001772                          1118  
00001772                          1119  
00001772                          1120  
00001772                          1121  
00001772                          1122  
00001772                          1123  
00001772                          1124  
00001772                          1125  
00001772                          1126  
00001772                          1127  
00001772                          1128  
00001772                          1129  
00001772                          1130  
00001772                          1131  
00001772                          1132  
00001772                          1133  
00001772                          1134  
00001772                          1135  
00001772                          1136  
00001772                          1137  
00001772                          1138  
00001772                          1139  
00001772                          1140  
00001772                          1141  
00001772                          1142  
00001772                          1143  
00001772                          1144  
00001772                          1145  
00001772                          1146  
00001772                          1147  
00001772                          1148  
00001772                          1149  
00001772                          1150  
00001772                          1151  
00001772                          1152  
00001772                          1153  
00001772                          1154  
00001772                          1155  
00001772                          1156  
00001772                          1157  
00001772                          1158  
00001772                          1159  
00001772                          1160  
00001772                          1161  
00001772                          1162  
00001772                          1163  
00001772                          1164  
00001772                          1165  
00001772                          1166  
00001772                          1167  
00001772                          1168  
00001772                          1169  
00001772                          1170  
00001772                          1171  -------------------- end include --------------------
00001772                          1172              INCLUDE "SHOT.X68"
00001772                          1173  ; ------------------------------------------------------------------------------
00001772                          1174  SHTINIT
00001772                          1175  ; INITIALIZE THE SHOOT COORDINATES
00001772                          1176  ; INPUT    :  A0 POINTER TO THE INSTANCE VARIABLES
00001772                          1177  ; OUTPUT   : NONE
00001772                          1178  ; MODIFIES : NONE
00001772                          1179  ; ------------------------------------------------------------------------------
00001772                          1180      
00001772                          1181              ;POSICIONAR X RESPECTO AL TANQUE
00001772  30B9 00001F56           1182              MOVE.W  (TNKPOSX),(A0)
00001778  0650 0024               1183              ADD.W   #TNKWIDHA,(A0)
0000177C                          1184              
0000177C                          1185              ;POSICIONAR Y RESPECTO AL TANQUE
0000177C  317C 01A0 0002          1186              MOVE.W  #TNKPOSY,2(A0)
00001782  0468 0012 0002          1187              SUB.W   #SHTGAP+SHTHEIGH/2,2(A0)  
00001788  4E75                    1188              RTS
0000178A                          1189   
0000178A                          1190  ; ------------------------------------------------------------------------------
0000178A                          1191  SHTUPD
0000178A                          1192  ; UPDATES THE SHOOT
0000178A                          1193  ; INPUT    : 
0000178A                          1194  ; OUTPUT   : NONE
0000178A                          1195  ; MODIFIES : NONE
0000178A                          1196  ; ------------------------------------------------------------------------------
0000178A                          1197              
0000178A  48E7 C000               1198              MOVEM.L  D0-D1,-(A7)
0000178E  48A7 3800               1199              MOVEM.W  D2-D4,-(A7)            
00001792                          1200      
00001792                          1201              ;ACTUALIZAR MOVIMIENTO DISPARO
00001792  3028 0002               1202              MOVE.W  2(A0),D0
00001796  0440 000A               1203              SUB.W   #SHTSPEED,D0
0000179A  3140 0002               1204              MOVE.W  D0,2(A0)
0000179E                          1205              
0000179E                          1206              ;ELIMINAR DISPARO SI TOCA TECHO
0000179E  0641 0010               1207              ADD.W   #SHTHEIGH,D1
000017A2  E249                    1208              LSR.W   #1,D1
000017A4  D041                    1209              ADD.W   D1,D0
000017A6  B07C 0000               1210              CMP.W   #LIMIT,D0
000017AA  6E00 0006               1211              BGT     .NEXT
000017AE  4EB8 10AC               1212              JSR     AGLKILL
000017B2                          1213              
000017B2                          1214              ;COMPOBAR COLISIONES CON DISPARO (DESAPARECER)
000017B2                          1215              
000017B2                          1216              ;COMPROBAR COLISIÓN DISPARO X IZQUIERDA  
000017B2  3039 00001F58           1217  .NEXT       MOVE.W  (ALNPOSX),D0        ;D0 = ALNPOSX 
000017B8  343C 0004               1218              MOVE.W  #SHTWIDTH,D2
000017BC  E24A                    1219              LSR.W   #1,D2
000017BE  D450                    1220              ADD.W   (A0),D2             ;SHTPOSX + SHTWIDTH/2
000017C0  B440                    1221              CMP.W   D0,D2             
000017C2  6D00 00A8               1222              BLT     .DONE
000017C6                          1223              
000017C6                          1224              ;COMPROBAR COLISIÓN DISPARO X DERECHA
000017C6  343C 0004               1225              MOVE.W  #SHTWIDTH,D2
000017CA  E24A                    1226              LSR.W   #1,D2
000017CC  9450                    1227              SUB.W   (A0),D2            
000017CE  4442                    1228              NEG.W   D2                  ;SHTPOSX - SHTWIDTH/2
000017D0  3600                    1229              MOVE.W  D0,D3               ;COPIAR ALNPOSX
000017D2  0643 0190               1230              ADD.W   #ALNDIM*ALNMPCOL,D3 ;ALNPOSX + ALNDIM * ALNMPCOL
000017D6  B443                    1231              CMP.W   D3,D2
000017D8  6E00 0092               1232              BGT     .DONE
000017DC                          1233              
000017DC                          1234              ;COMPROBAR COLISIÓN DISPARO Y ARRIBA
000017DC  3239 00001F5A           1235              MOVE.W  (ALNPOSY),D1        ;D1 = ALNPOSY
000017E2  343C 0010               1236              MOVE.W  #SHTHEIGH,D2
000017E6  E24A                    1237              LSR.W   #1,D2
000017E8  D468 0002               1238              ADD.W   2(A0),D2            ;SHTPOSY + SHTHEIGH/2 
000017EC  B441                    1239              CMP.W   D1,D2              
000017EE  6D00 007C               1240              BLT     .DONE
000017F2                          1241              
000017F2                          1242              ;COMPROBAR COLISIÓN DISPARO Y ABAJO
000017F2  343C 0010               1243              MOVE.W  #SHTHEIGH,D2
000017F6  E24A                    1244              LSR.W   #1,D2
000017F8  9468 0002               1245              SUB.W   2(A0),D2         
000017FC  4442                    1246              NEG.W   D2                  ;SHTPOSY - SHTHEIGH/2
000017FE  3601                    1247              MOVE.W  D1,D3               ;COPIAR ALNPOSY
00001800  0643 0078               1248              ADD.W   #ALNDIM*ALNMPROW,D3 ;ALNPOSY + ALNDIM * ALNMPROW
00001804  B443                    1249              CMP.W   D3,D2
00001806  6C00 0064               1250              BGE     .DONE
0000180A                          1251              
0000180A                          1252              
0000180A                          1253              ;HAY COLISIÓN, COMPROBAMOS QUÉ ALIEN ES
0000180A                          1254              ;DETERMINAMOS LA COLUMNA
0000180A  303C 0004               1255              MOVE.W  #SHTWIDTH,D0
0000180E  E248                    1256              LSR.W   #1,D0
00001810  9050                    1257              SUB.W   (A0),D0 
00001812  4440                    1258              NEG.W   D0                  ;D0 = SHTPOSX-SHTWIDTH/2 (PARTE IZQUIERDA DISPARO)
00001814  3239 00001F58           1259              MOVE.W  (ALNPOSX),D1        ;D1 = ALNPOSX
0000181A  9041                    1260              SUB.W   D1,D0               ;D0 = (SHTPOSX-SHTWIDTH/2)-ALNPOSX
0000181C  80FC 0028               1261              DIVU.W  #ALNDIM,D0          ;COLUMNA DE LA MATRIZ
00001820  3800                    1262              MOVE.W  D0,D4
00001822  4280                    1263              CLR.L   D0                  ;EL RESTO DE DIVU NO NOS INTERESA
00001824  3004                    1264              MOVE.W  D4,D0
00001826                          1265                                      
00001826                          1266              ;DETERMINAMOS LA FILA
00001826  323C 0010               1267              MOVE.W  #SHTHEIGH,D1
0000182A  E249                    1268              LSR.W   #1,D1
0000182C  9268 0002               1269              SUB.W   2(A0),D1    
00001830  4441                    1270              NEG.W   D1                  ;D1 = SHTPOSY-SHTHEIGH/2 (PARTE ARRIBA DISPARO)
00001832  3639 00001F5A           1271              MOVE.W  (ALNPOSY),D3        ;D3 = ALNPOSY
00001838  9243                    1272              SUB.W   D3,D1               ;D1 = (SHTPOSY-SHTHEIGH/2)-ALNPOSY
0000183A  82FC 0028               1273              DIVU.W  #ALNDIM,D1          ;FILA DE LA MATRIZ
0000183E  3401                    1274              MOVE.W  D1,D2
00001840  4281                    1275              CLR.L   D1                  ;EL RESTO DE DIVU NO NOS INTERESA
00001842                          1276              
00001842                          1277              ;DETERMINAMOS LA POSICIÓN EN LA MATRIZ
00001842  C4FC 000A               1278              MULU.W  #10,D2              ;D2 = ÍNDICE FILA * 10
00001846  D042                    1279              ADD.W   D2,D0               ;D0 = D2 + ÍNDICE COLUMNA                
00001848                          1280              
00001848                          1281              ;MIRAMOS SI ESTÁ VIVO EL ALIEN
00001848  47F8 1698               1282              LEA     MAPDATA,A3
0000184C  0C33 0001 0000          1283              CMP.B   #1,(A3,D0.W)          
00001852  6600 0018               1284              BNE     .DONE
00001856                          1285              
00001856                          1286              ;ALIEN VIVO
00001856                          1287              ;AND.W  #$00FF,D0           ;LIMPIAR EL BYTE MAS SIGNIFICATIVO DE D0
00001856  0233 0000 0000          1288              AND.B   #0,(A3,D0.W)        ;DESAPARECE EL ALIEN
0000185C  5279 00001F66           1289              ADDQ.W  #1,(SCOPOINT)       ;INCREMENTAMOS LOS PUNTOS ACUMULADOS           
00001862  4EB8 10AC               1290              JSR     AGLKILL             ;ELIMINA DISPARO
00001866                          1291              ;REPRODUCIR SONIDO  DE COLISIÓN
00001866  1E3C 0000               1292              MOVE.B  #SNDSHT,D7
0000186A  4E42                    1293              TRAP    #SNDPLTN     
0000186C  4C9F 001C               1294  .DONE       MOVEM.W  (A7)+,D2-D4
00001870  4CDF 0003               1295              MOVEM.L  (A7)+,D0-D1
00001874  4E75                    1296              RTS
00001876                          1297  
00001876                          1298  ; ------------------------------------------------------------------------------
00001876                          1299  SHTPLOT
00001876                          1300  ; PLOT THE SHOOT.
00001876                          1301  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00001876                          1302  ; OUTPUT   : NONE
00001876                          1303  ; MODIFIES : NONE
00001876                          1304  ; ------------------------------------------------------------------------------
00001876                          1305      
00001876  48E7 F800               1306              MOVEM.L D0-D4,-(A7)
0000187A                          1307              
0000187A                          1308              ;ESTABLECER COLOR CONTORNO
0000187A                          1309m             SET_PEN_COLOR   #SHTPNCLR            
0000187A                          1310m ; SETS THE PEN COLOR FOR DRAWING
0000187A                          1311m ; INPUT    : #SHTPNCLR COLOR IN $00BBGGRR FORMAT 
0000187A                          1312m ; OUTPUT   : NONE
0000187A                          1313m ; MODIFIES : D0,D1
0000187A                          1314m ;------------------------------------------------------------------------------
0000188E                          1315              ;ESTABLECER COLOR RELLENO
0000188E                          1316m             SET_FILL_COLOR  #SHTFLCLR
0000188E                          1317m ; SETS THE FILL COLOR FOR DRAWING
0000188E                          1318m ; INPUT    : #SHTFLCLR COLOR IN $00BBGGRR FORMAT 
0000188E                          1319m ; OUTPUT   : NONE
0000188E                          1320m ; MODIFIES : D0,D1
0000188E                          1321m ;------------------------------------------------------------------------------
000018A2                          1322            
000018A2                          1323              ;DIBUJAR DISPARO (RECTANGULO)
000018A2  3210                    1324              MOVE.W  (A0),D1
000018A4  3428 0002               1325              MOVE.W  2(A0),D2
000018A8  5541                    1326              SUB.W   #SHTWIDTH/2,D1
000018AA  3601                    1327              MOVE.W  D1,D3
000018AC  5843                    1328              ADD.W   #SHTWIDTH,D3
000018AE  5042                    1329              ADD.W   #SHTHEIGH/2,D2   
000018B0  3802                    1330              MOVE.W  D2,D4
000018B2  0444 0010               1331              SUB.W   #SHTHEIGH,D4
000018B6  103C 0057               1332              MOVE.B  #87,D0
000018BA  4E4F                    1333              TRAP    #15
000018BC                          1334              
000018BC  4CDF 001F               1335              MOVEM.L (A7)+,D0-D4
000018C0  4E75                    1336              RTS        
000018C2                          1337  
000018C2                          1338  
000018C2                          1339  
000018C2                          1340  
000018C2                          1341  
000018C2                          1342  
000018C2                          1343  
000018C2                          1344  
000018C2                          1345  
000018C2                          1346  
000018C2                          1347  
000018C2                          1348  
000018C2                          1349  
000018C2                          1350  
000018C2                          1351  
000018C2                          1352  
000018C2                          1353  
000018C2                          1354  
000018C2                          1355  
000018C2                          1356  
000018C2                          1357  
000018C2                          1358  
000018C2                          1359  
000018C2                          1360  
000018C2                          1361  
000018C2                          1362  
000018C2                          1363  
000018C2                          1364  
000018C2                          1365  
000018C2                          1366  
000018C2                          1367  
000018C2                          1368  
000018C2                          1369  
000018C2                          1370  
000018C2                          1371  
000018C2                          1372  
000018C2                          1373  
000018C2                          1374  
000018C2                          1375  
000018C2                          1376  
000018C2                          1377  
000018C2                          1378  
000018C2                          1379  
000018C2                          1380  
000018C2                          1381  
000018C2                          1382  
000018C2                          1383  
000018C2                          1384  
000018C2                          1385  
000018C2                          1386  
000018C2                          1387  
000018C2                          1388  
000018C2                          1389  
000018C2                          1390  
000018C2                          1391  
000018C2                          1392  
000018C2                          1393  
000018C2                          1394  
000018C2                          1395  
000018C2                          1396  -------------------- end include --------------------
000018C2                          1397              INCLUDE "SCORE.X68"
000018C2                          1398  ; ------------------------------------------------------------------------------
000018C2                          1399  SCOINIT
000018C2                          1400  ; INITIALIZE THE SCORE
000018C2                          1401  ; INPUT    : NONE 
000018C2                          1402  ; OUTPUT   : NONE
000018C2                          1403  ; MODIFIES : NONE
000018C2                          1404  ; ------------------------------------------------------------------------------
000018C2                          1405      
000018C2  4279 00001F66           1406              CLR.W   (SCOPOINT)
000018C8  4279 00001F68           1407              CLR.W   (SCOSHOOT)
000018CE  4279 00001F6A           1408              CLR.W   (SCOLEVEL)
000018D4  4E75                    1409              RTS
000018D6                          1410   
000018D6                          1411  ; ------------------------------------------------------------------------------
000018D6                          1412  SCOPLOT
000018D6                          1413  ; PLOT THE SCORE.
000018D6                          1414  ; INPUT    : NONE 
000018D6                          1415  ; OUTPUT   : NONE
000018D6                          1416  ; MODIFIES : NONE
000018D6                          1417  ; ------------------------------------------------------------------------------
000018D6                          1418      
000018D6  48E7 C040               1419              MOVEM.L D0-D1/A1,-(A7)
000018DA                          1420              
000018DA                          1421              ;ESTABLECER COLOR RELLENO
000018DA                          1422m             SET_FILL_COLOR  #SCOFLCLR
000018DA                          1423m ; SETS THE FILL COLOR FOR DRAWING
000018DA                          1424m ; INPUT    : #SCOFLCLR COLOR IN $00BBGGRR FORMAT 
000018DA                          1425m ; OUTPUT   : NONE
000018DA                          1426m ; MODIFIES : D0,D1
000018DA                          1427m ;------------------------------------------------------------------------------
000018EA                          1428              
000018EA                          1429              ;ESTABLECER POSICIÓN 1 IZQUIERDA
000018EA  103C 000B               1430              MOVE.B  #11,D0
000018EE  323C 0101               1431              MOVE.W  #SCOLINE,D1
000018F2  4E4F                    1432              TRAP    #15
000018F4                          1433              
000018F4                          1434              ;MOSTRAR PUNTUACIÓN
000018F4  103C 0011               1435              MOVE.B  #17,D0
000018F8  43F9 0000196C           1436              LEA     .TXT,A1
000018FE  3239 00001F66           1437              MOVE.W  (SCOPOINT),D1
00001904  4E4F                    1438              TRAP    #15
00001906                          1439              
00001906                          1440              ;ESTABLECER POSICIÓN 1 DERECHA 
00001906  103C 000B               1441              MOVE.B  #11,D0
0000190A  323C 4101               1442              MOVE.W  #SCOLINE1,D1
0000190E  4E4F                    1443              TRAP    #15
00001910                          1444              
00001910                          1445              ;MOSTRAR NÚMERO DE DISPAROS
00001910                          1446m             SET_PEN_COLOR   #DISPCLR
00001910                          1447m ; SETS THE PEN COLOR FOR DRAWING
00001910                          1448m ; INPUT    : #DISPCLR COLOR IN $00BBGGRR FORMAT 
00001910                          1449m ; OUTPUT   : NONE
00001910                          1450m ; MODIFIES : D0,D1
00001910                          1451m ;------------------------------------------------------------------------------
00001924                          1452  
00001924  103C 0011               1453              MOVE.B  #17,D0
00001928  43F9 00001978           1454              LEA     .TXT1,A1
0000192E  3239 00001F68           1455              MOVE.W  (SCOSHOOT),D1
00001934  4E4F                    1456              TRAP    #15    
00001936                          1457              
00001936                          1458              ;ESTABLECER POSICIÓN 2 DERECHA 
00001936  103C 000B               1459              MOVE.B  #11,D0
0000193A  323C 4102               1460              MOVE.W  #SCOLINE2,D1
0000193E  4E4F                    1461              TRAP    #15
00001940                          1462              
00001940                          1463              ;MOSTRAR NIVEL DE DIFICULTAD
00001940                          1464              
00001940                          1465m             SET_PEN_COLOR   #NIVELCR
00001940                          1466m ; SETS THE PEN COLOR FOR DRAWING
00001940                          1467m ; INPUT    : #NIVELCR COLOR IN $00BBGGRR FORMAT 
00001940                          1468m ; OUTPUT   : NONE
00001940                          1469m ; MODIFIES : D0,D1
00001940                          1470m ;------------------------------------------------------------------------------
00001954                          1471              ;SET_FILL_COLOR #$00FFFFFF  
00001954  103C 0011               1472              MOVE.B  #17,D0
00001958  43F9 00001982           1473              LEA     .TXT2,A1
0000195E  3239 00001F6A           1474              MOVE.W  (SCOLEVEL),D1
00001964  4E4F                    1475              TRAP    #15  
00001966                          1476              
00001966  4CDF 0203               1477              MOVEM.L (A7)+,D0-D1/A1
0000196A  4E75                    1478              RTS
0000196C                          1479  
0000196C= 50 55 4E 54 55 41 ...   1480  .TXT        DC.B    'PUNTUACION:',0    
00001978= 44 49 53 50 41 52 ...   1481  .TXT1       DC.B    'DISPAROS:',0  
00001982= 4E 49 56 45 4C 3A 00    1482  .TXT2       DC.B    'NIVEL:',0   
0000198A                          1483              DS.W    0 
0000198A                          1484  
0000198A                          1485  
0000198A                          1486  
0000198A                          1487  
0000198A                          1488  
0000198A                          1489  
0000198A                          1490  
0000198A                          1491  
0000198A                          1492  -------------------- end include --------------------
0000198A                          1493              INCLUDE "FILE.X68"
0000198A                          1494  
0000198A                          1495  ; ------------------------------------------------------------------------------
0000198A                          1496  FILINIT
0000198A                          1497  ; INITIALIZE THE FILE. USING FOR DEMO.
0000198A                          1498  ; INPUT    : NONE 
0000198A                          1499  ; OUTPUT   : NONE
0000198A                          1500  ; MODIFIES : NONE
0000198A                          1501  ; ------------------------------------------------------------------------------
0000198A                          1502  
0000198A  48E7 8040               1503              MOVEM.L D0/A1,-(A7)
0000198E                          1504              
0000198E                          1505              ;ABRIR EL FICHERO
0000198E  103C 0033               1506              MOVE.B  #51,D0
00001992  43F9 000019A0           1507              LEA     .FILE,A1
00001998  4E4F                    1508              TRAP    #15  
0000199A                          1509              
0000199A  4CDF 0201               1510  .DONE       MOVEM.L (A7)+,D0/A1
0000199E  4E75                    1511              RTS
000019A0                          1512  
000019A0= 46 49 43 2F 66 69 ...   1513  .FILE       DC.B    'FIC/fichero.txt',0
000019B0                          1514              DS.W    0    
000019B0                          1515  
000019B0                          1516  ; ------------------------------------------------------------------------------
000019B0                          1517  FILUPD
000019B0                          1518  ; UPDATES THE FILE. USING FOR DEMO.
000019B0                          1519  ; INPUT    : NONE
000019B0                          1520  ; OUTPUT   : NONE
000019B0                          1521  ; MODIFIES : NONE
000019B0                          1522  ; ------------------------------------------------------------------------------
000019B0  48E7 F040               1523              MOVEM.L D0-D3/A1,-(A7)
000019B4                          1524              
000019B4                          1525              ;DATOS LECTURA FICHERO
000019B4  103C 0035               1526              MOVE.B  #53,D0
000019B8  7401                    1527              MOVE.L  #1,D2
000019BA  43F9 00001A10           1528              LEA     .BUFFER,A1
000019C0  4E4F                    1529              TRAP    #15
000019C2                          1530              
000019C2                          1531              ;LEER EL FICHERO
000019C2  0411 0030               1532              SUB.B   #$30,(A1)   ;CONVERTIR ASCII A REAL
000019C6  1611                    1533              MOVE.B  (A1),D3
000019C8  4A03                    1534              TST.B   D3          ;FICHERO ACABA EN 0
000019CA  6700 003E               1535              BEQ     .DONE
000019CE  5289                    1536              ADDQ.L  #1,A1
000019D0                          1537              
000019D0                          1538              ;ESPERAR 10 ms ENTRE UNA ACCIÓN Y LA SIGUIENTE
000019D0  103C 0017               1539              MOVE.B  #23,D0
000019D4  7201                    1540              MOVE.L  #1,D1
000019D6  4E4F                    1541              TRAP    #15
000019D8                          1542              
000019D8                          1543              ;MIRAR QUÉ BIT ES
000019D8  B63C 0001               1544              CMP.B   #1,D3
000019DC  6600 000C               1545              BNE     .NEXT1
000019E0  4EB9 00001A36           1546              JSR     TNKRIGHT    ;MOVER TANQUE DERECHA SI BIT = 1
000019E6  6000 0022               1547              BRA     .DONE
000019EA                          1548           
000019EA  B63C 0003               1549  .NEXT1      CMP.B   #3,D3
000019EE  6600 000C               1550              BNE     .NEXT2
000019F2  4EB9 00001A56           1551              JSR     TNKLEFT     ;MOVER TANQUE IZQUIERDA SI BIT = 3
000019F8  6000 0010               1552              BRA     .DONE
000019FC                          1553              
000019FC  B63C 0002               1554  .NEXT2      CMP.B   #2,D3
00001A00  6600 0008               1555              BNE     .DONE
00001A04  4EB9 00001A12           1556              JSR     SHTADD      ;AGREGAR DISPARO SI BIT = 2
00001A0A                          1557              
00001A0A  4CDF 020F               1558  .DONE       MOVEM.L (A7)+,D0-D3/A1
00001A0E  4E75                    1559              RTS  
00001A10                          1560  .BUFFER     DS.B    1       
00001A12                          1561              DS.W    0
00001A12                          1562  
00001A12                          1563  ; ------------------------------------------------------------------------------
00001A12                          1564  SHTADD
00001A12                          1565  ; ADD THE SHOOT. USING FOR DEMO.
00001A12                          1566  ; INPUT    : NONE
00001A12                          1567  ; OUTPUT   : NONE
00001A12                          1568  ; MODIFIES : NONE
00001A12                          1569  ; ------------------------------------------------------------------------------
00001A12                          1570  
00001A12  48E7 8070               1571              MOVEM.L D0/A1-A3,-(A7)
00001A16                          1572              
00001A16  43F8 1772               1573              LEA     SHTINIT,A1
00001A1A  45F8 178A               1574              LEA     SHTUPD,A2
00001A1E  47F8 1876               1575              LEA     SHTPLOT,A3
00001A22  303C 0001               1576              MOVE.W  #1,D0
00001A26  4EB8 127E               1577              JSR     AGLADD
00001A2A  5279 00001F68           1578              ADD.W   #1,(SCOSHOOT)
00001A30                          1579              
00001A30  4CDF 0E01               1580              MOVEM.L (A7)+,D0/A1-A3
00001A34  4E75                    1581              RTS
00001A36                          1582  
00001A36                          1583  ; ------------------------------------------------------------------------------
00001A36                          1584  TNKRIGHT
00001A36                          1585  ; UPDATES THE TANK TO THE RIGHT. USING FOR DEMO.
00001A36                          1586  ; INPUT    : NONE
00001A36                          1587  ; OUTPUT   : NONE
00001A36                          1588  ; MODIFIES : NONE
00001A36                          1589  ; ------------------------------------------------------------------------------
00001A36  3F00                    1590              MOVE.W  D0,-(A7)
00001A38                          1591              
00001A38                          1592              ;GUARDAR VARIABLE EN REGISTRO
00001A38  3039 00001F56           1593              MOVE.W  (TNKPOSX),D0        
00001A3E                          1594              
00001A3E                          1595              ;MOVER TANQUE A LA DERECHA
00001A3E  5040                    1596              ADD.W   #TNKSPEED,D0       
00001A40                          1597  
00001A40                          1598              ;COMPROBAR COLISIÓN DERECHA
00001A40  B07C 0238               1599              CMP.W   #SCRWIDTH-TNKWIDTH,D0     
00001A44  6F00 0006               1600              BLE     .DONE
00001A48  303C 0238               1601              MOVE.W  #SCRWIDTH-TNKWIDTH,D0     ;RESTA ANCHO DEL TANQUE     
00001A4C                          1602              
00001A4C                          1603              ;ACTUALIZAR VARIABLE
00001A4C  33C0 00001F56           1604  .DONE       MOVE.W  D0,(TNKPOSX)
00001A52                          1605              
00001A52  301F                    1606              MOVE.W (A7)+,D0
00001A54  4E75                    1607              RTS
00001A56                          1608              
00001A56                          1609  ; ------------------------------------------------------------------------------
00001A56                          1610  TNKLEFT
00001A56                          1611  ; UPDATES THE TANK TO THE LEFT. USING FOR DEMO.
00001A56                          1612  ; INPUT    : NONE
00001A56                          1613  ; OUTPUT   : NONE
00001A56                          1614  ; MODIFIES : NONE
00001A56                          1615  ; ------------------------------------------------------------------------------
00001A56                          1616  
00001A56  3F00                    1617              MOVE.W D0,-(A7)
00001A58                          1618              
00001A58                          1619              ;GUARDAR VARIABLE EN REGISTRO
00001A58  3039 00001F56           1620              MOVE.W  (TNKPOSX),D0        
00001A5E                          1621                       
00001A5E                          1622              ;MOVER TANQUE A LA IZQUIERDA 
00001A5E  5140                    1623              SUB.W   #TNKSPEED,D0
00001A60                          1624  
00001A60                          1625              ;COMPROBAR COLISIÓN IZQUIERDA
00001A60  B07C 0000               1626              CMP.W   #0,D0
00001A64  6C00 0004               1627              BGE     .DONE
00001A68  4240                    1628              CLR.W   D0       
00001A6A                          1629              
00001A6A                          1630              ;ACTUALIZAR VARIABLE
00001A6A  33C0 00001F56           1631  .DONE       MOVE.W  D0,(TNKPOSX)
00001A70                          1632  
00001A70  301F                    1633              MOVE.W (A7)+,D0
00001A72  4E75                    1634              RTS
00001A74                          1635  
00001A74                          1636  
00001A74                          1637  
00001A74                          1638  
00001A74                          1639  
00001A74                          1640  
00001A74                          1641  -------------------- end include --------------------
00001A74                          1642              INCLUDE "STATES.X68"
00001A74                          1643  ; =============================================================================
00001A74                          1644  ; GAME STATE MANAGEMENT
00001A74                          1645  ; =============================================================================
00001A74                          1646  
00001A74                          1647  ; -----------------------------------------------------------------------------
00001A74                          1648  STAINIT
00001A74                          1649  ; INITALIZES THE STATE MANAGER
00001A74                          1650  ; INPUT    - NONE
00001A74                          1651  ; OUTPUT   - NONE
00001A74                          1652  ; MODIFIES - NONE
00001A74                          1653  ; -----------------------------------------------------------------------------
00001A74  33FC FFFF 00001F6C      1654              MOVE.W  #STANONE,(STACUR)
00001A7C  4279 00001F6E           1655              CLR.W   (STANEXT)
00001A82  4E75                    1656              RTS
00001A84                          1657  
00001A84                          1658  ; -----------------------------------------------------------------------------
00001A84                          1659  STAUPD
00001A84                          1660  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00001A84                          1661  ; INPUT    - NONE
00001A84                          1662  ; OUTPUT   - NONE
00001A84                          1663  ; MODIFIES - NONE
00001A84                          1664  ; -----------------------------------------------------------------------------
00001A84  48E7 8080               1665              MOVEM.L D0/A0,-(A7)
00001A88  4280                    1666              CLR.L   D0
00001A8A  3039 00001F6E           1667              MOVE.W  (STANEXT),D0
00001A90  B079 00001F6C           1668              CMP.W   (STACUR),D0
00001A96  6700 0012               1669              BEQ     .DOUPD
00001A9A  33C0 00001F6C           1670              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00001AA0  E588                    1671              LSL.L   #2,D0
00001AA2  2040                    1672              MOVE.L  D0,A0
00001AA4  2068 1AC2               1673              MOVE.L  .INITBL(A0),A0
00001AA8  4E90                    1674              JSR     (A0)
00001AAA  4280                    1675  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00001AAC  3039 00001F6C           1676              MOVE.W  (STACUR),D0
00001AB2  E588                    1677              LSL.L   #2,D0
00001AB4  2040                    1678              MOVE.L  D0,A0
00001AB6  2068 1AD6               1679              MOVE.L  .UPDTBL(A0),A0
00001ABA  4E90                    1680              JSR     (A0)
00001ABC  4CDF 0101               1681              MOVEM.L (A7)+,D0/A0
00001AC0  4E75                    1682              RTS
00001AC2= 00001B1C 00001CE8 ...   1683  .INITBL     DC.L    INTINIT,DEMINIT,GAMINIT,WININIT,GOVINIT
00001AD6= 00001B1E 00001CFC ...   1684  .UPDTBL     DC.L    ISCUPD,DEMUPD,GAMUPD,WINUPD,GOVUPD
00001AEA                          1685  
00001AEA                          1686  ; -----------------------------------------------------------------------------
00001AEA                          1687  STAPLOT
00001AEA                          1688  ; PERFORMS STATE PLOT
00001AEA                          1689  ; INPUT    - NONE
00001AEA                          1690  ; OUTPUT   - NONE
00001AEA                          1691  ; MODIFIES - NONE
00001AEA                          1692  ; -----------------------------------------------------------------------------
00001AEA  48E7 8080               1693              MOVEM.L D0/A0,-(A7)
00001AEE  4280                    1694              CLR.L   D0
00001AF0  3039 00001F6C           1695              MOVE.W  (STACUR),D0
00001AF6  E588                    1696              LSL.L   #2,D0
00001AF8  2040                    1697              MOVE.L  D0,A0
00001AFA  2068 1B06               1698              MOVE.L  .PLTTBL(A0),A0
00001AFE  4E90                    1699              JSR     (A0)
00001B00  4CDF 0101               1700              MOVEM.L (A7)+,D0/A0
00001B04  4E75                    1701              RTS
00001B06= 00001B4C 00001D34 ...   1702  .PLTTBL     DC.L    ISCPLOT,DEMPLOT,GAMPLOT,WINPLOT,GOVPLOT
00001B1A                          1703  
00001B1A                          1704  ; -----------------------------------------------------------------------------
00001B1A                          1705  STAEMPTY
00001B1A                          1706  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00001B1A                          1707  ; INPUT    - NONE
00001B1A                          1708  ; OUTPUT   - NONE
00001B1A                          1709  ; MODIFIES - NONE
00001B1A                          1710  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00001B1A                          1711  ; -----------------------------------------------------------------------------
00001B1A  4E75                    1712              RTS
00001B1C                          1713  
00001B1C                          1714  
00001B1C                          1715  
00001B1C                          1716  
00001B1C                          1717  
00001B1C                          1718  
00001B1C                          1719  
00001B1C                          1720  
00001B1C                          1721  
00001B1C                          1722  
00001B1C                          1723  
00001B1C                          1724  
00001B1C                          1725  -------------------- end include --------------------
00001B1C                          1726              INCLUDE "INTRO.X68" 
00001B1C                          1727  ; ==============================================================================
00001B1C                          1728  ; INTRO SCREEN
00001B1C                          1729  ; ==============================================================================
00001B1C                          1730  INTINIT         
00001B1C  4E75                    1731              RTS
00001B1E                          1732  ; ------------------------------------------------------------------------------
00001B1E                          1733  ISCUPD
00001B1E                          1734  ; INTRO SCREEN UPDATE
00001B1E                          1735  ; INPUT    : NONE
00001B1E                          1736  ; OUTPUT   : NONE
00001B1E                          1737  ; MODIFIES : NONE
00001B1E                          1738  ; ------------------------------------------------------------------------------
00001B1E  0839 0000 00001F73      1739              BTST.B  #0,(KBDEDGE)
00001B26  6700 000E               1740              BEQ     .CONT
00001B2A  33FC 0002 00001F6E      1741              MOVE.W  #2,(STANEXT)
00001B32  6000 0016               1742              BRA     .DONE
00001B36  0839 0004 00001F73      1743  .CONT       BTST.B  #4,(KBDEDGE)
00001B3E  6700 000A               1744              BEQ     .DONE
00001B42  33FC 0001 00001F6E      1745              MOVE.W  #1,(STANEXT)
00001B4A  4E75                    1746  .DONE       RTS
00001B4C                          1747  
00001B4C                          1748  ; ------------------------------------------------------------------------------
00001B4C                          1749  ISCPLOT
00001B4C                          1750  ; INTRO SCREEN PLOT
00001B4C                          1751  ; INPUT    : NONE
00001B4C                          1752  ; OUTPUT   : NONE
00001B4C                          1753  ; MODIFIES : NONE
00001B4C                          1754  ; ------------------------------------------------------------------------------
00001B4C  48E7 C080               1755              MOVEM.L D0-D1/A0,-(A7)
00001B50                          1756  
00001B50                          1757m             SET_FILL_COLOR  #STAFLCLR
00001B50                          1758m ; SETS THE FILL COLOR FOR DRAWING
00001B50                          1759m ; INPUT    : #STAFLCLR COLOR IN $00BBGGRR FORMAT 
00001B50                          1760m ; OUTPUT   : NONE
00001B50                          1761m ; MODIFIES : D0,D1
00001B50                          1762m ;------------------------------------------------------------------------------
00001B60                          1763              
00001B60  41F9 00001BEA           1764              LEA     .TXT1,A0
00001B66  103C 0005               1765              MOVE.B  #5,D0
00001B6A  4EB8 12F8               1766              JSR     UTLPRINT
00001B6E                          1767              
00001B6E  41F9 00001BF9           1768              LEA     .TXT2,A0
00001B74  103C 000A               1769              MOVE.B  #10,D0
00001B78  4EB8 12F8               1770              JSR     UTLPRINT
00001B7C                          1771              
00001B7C  41F9 00001C07           1772              LEA     .TXT3,A0
00001B82  4EB8 12F8               1773              JSR     UTLPRINT
00001B86                          1774              
00001B86  41F9 00001C25           1775              LEA     .TXT4,A0
00001B8C  4EB8 12F8               1776              JSR     UTLPRINT
00001B90                          1777              
00001B90  41F9 00001C42           1778              LEA     .TXT5,A0
00001B96  4EB8 12F8               1779              JSR     UTLPRINT
00001B9A                          1780                       
00001B9A  41F9 00001C58           1781              LEA     .TXT6,A0
00001BA0  103C 0010               1782              MOVE.B  #16,D0
00001BA4  4EB8 12F8               1783              JSR     UTLPRINT
00001BA8                          1784              
00001BA8  41F9 00001C5E           1785              LEA     .TXT7,A0
00001BAE  4EB8 12F8               1786              JSR     UTLPRINT
00001BB2                          1787              
00001BB2  41F9 00001C8D           1788              LEA     .TXT8,A0
00001BB8  4EB8 12F8               1789              JSR     UTLPRINT     
00001BBC                          1790              
00001BBC  0839 0004 00001F75      1791              BTST.B  #4,(SCRCYCCT)
00001BC4  6700 001E               1792              BEQ     .DONE
00001BC8                          1793              
00001BC8  41F9 00001CAB           1794              LEA     .TXT9,A0
00001BCE  103C 0016               1795              MOVE.B  #22,D0
00001BD2  4EB8 12F8               1796              JSR     UTLPRINT
00001BD6                          1797              
00001BD6  41F9 00001CC7           1798              LEA     .TXT10,A0
00001BDC  103C 0019               1799              MOVE.B  #25,D0
00001BE0  4EB8 12F8               1800              JSR     UTLPRINT
00001BE4                          1801              
00001BE4  4CDF 0103               1802  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001BE8  4E75                    1803              RTS
00001BEA= 53 50 41 43 45 20 ...   1804  .TXT1       DC.B    'SPACE INVADERS',0
00001BF9= 49 4E 53 54 52 55 ...   1805  .TXT2       DC.B    'INSTRUCTIONS:',0
00001C07= 50 52 45 53 53 20 ...   1806  .TXT3       DC.B    'PRESS -> TO MOVE TO THE RIGHT',0
00001C25= 50 52 45 53 53 20 ...   1807  .TXT4       DC.B    'PRESS <- TO MOVE TO THE LEFT',0
00001C42= 50 52 45 53 53 20 ...   1808  .TXT5       DC.B    'PRESS KEY UP TO SHOOT',0
00001C58= 47 4F 41 4C 3A 00       1809  .TXT6       DC.B    'GOAL:',0
00001C5E= 4B 49 4C 4C 20 41 ...   1810  .TXT7       DC.B    'KILL ALL THE ALIENS BEFORE THEY REACH THE TANK',0
00001C8D= 57 49 54 48 20 41 ...   1811  .TXT8       DC.B    'WITH AS FEW SHOTS AS POSSIBLE',0 
00001CAB= 50 52 45 53 53 20 ...   1812  .TXT9       DC.B    'PRESS SPACE TO SEE THE DEMO',0
00001CC7= 50 52 45 53 53 20 ...   1813  .TXT10      DC.B    'PRESS KEY DOWN TO START THE GAME',0
00001CE8                          1814              DS.W    0
00001CE8                          1815  
00001CE8                          1816  
00001CE8                          1817  
00001CE8                          1818  
00001CE8                          1819  
00001CE8                          1820  
00001CE8                          1821  
00001CE8                          1822  
00001CE8                          1823  
00001CE8                          1824  
00001CE8                          1825  
00001CE8                          1826  
00001CE8                          1827  
00001CE8                          1828  
00001CE8                          1829  -------------------- end include --------------------
00001CE8                          1830              INCLUDE "DEMO.X68"  
00001CE8                          1831  ; ==============================================================================
00001CE8                          1832  ; INTRO SCREEN
00001CE8                          1833  ; ==============================================================================
00001CE8                          1834  
00001CE8                          1835  ; ------------------------------------------------------------------------------
00001CE8                          1836  DEMINIT
00001CE8                          1837  ; DEMO INIT
00001CE8                          1838  ; INPUT    : NONE
00001CE8                          1839  ; OUTPUT   : NONE
00001CE8                          1840  ; MODIFIES : NONE
00001CE8                          1841  ; ------------------------------------------------------------------------------
00001CE8  4EB8 1000               1842              JSR     DMMINIT
00001CEC  4EB8 198A               1843              JSR     FILINIT
00001CF0  4EB8 1448               1844              JSR     TNKINIT
00001CF4  4EB8 153E               1845              JSR     ALNINIT
00001CF8  6000 FBC8               1846              BRA     SCOINIT
00001CFC                          1847  
00001CFC                          1848  ; ------------------------------------------------------------------------------
00001CFC                          1849  DEMUPD
00001CFC                          1850  ; DEMO UPDATE
00001CFC                          1851  ; INPUT    : NONE
00001CFC                          1852  ; OUTPUT   : NONE
00001CFC                          1853  ; MODIFIES : NONE
00001CFC                          1854  ; ------------------------------------------------------------------------------
00001CFC  4EB8 19B0               1855              JSR     FILUPD
00001D00  4EB8 1298               1856              JSR     AGLUPD
00001D04  4EB8 156E               1857              JSR     ALNUPD
00001D08                          1858              
00001D08                          1859              ;EN CUALQUIER MOMENTO SE PUEDE PASAR AL SIGUIENTE ESTADO
00001D08  0839 0000 00001F73      1860              BTST.B  #0,(KBDEDGE)        ;SI PULSA KEY DOWN
00001D10  6700 000E               1861              BEQ     .CONT
00001D14  33FC 0002 00001F6E      1862              MOVE.W  #2,(STANEXT)        ;PASA AL JUEGO
00001D1C  6000 0014               1863              BRA     .DONE
00001D20  0839 0004 00001F73      1864  .CONT       BTST.B  #4,(KBDEDGE)        ;SI PULSA EL ESPACIO
00001D28  6700 0008               1865              BEQ     .DONE
00001D2C  4279 00001F6E           1866              CLR.W   (STANEXT)           ;PASA A LA INTRO
00001D32  4E75                    1867  .DONE       RTS
00001D34                          1868  
00001D34                          1869  ; ------------------------------------------------------------------------------
00001D34                          1870  DEMPLOT
00001D34                          1871  ; DEMO PLOT
00001D34                          1872  ; INPUT    : NONE
00001D34                          1873  ; OUTPUT   : NONE
00001D34                          1874  ; MODIFIES : NONE
00001D34                          1875  ; ------------------------------------------------------------------------------
00001D34  48E7 C080               1876              MOVEM.L D0-D1/A0,-(A7)
00001D38                          1877              
00001D38  4EB8 12BC               1878              JSR     AGLPLOT
00001D3C  4EB8 149A               1879              JSR     TNKPLOT
00001D40  4EB8 1620               1880              JSR     ALNPLOT
00001D44  4EB8 18D6               1881              JSR     SCOPLOT
00001D48                          1882  
00001D48                          1883              ;MOSTRAR LAS LÍNEAS PARA PASAR AL SIGUIENTE ESTADO
00001D48                          1884m             SET_FILL_COLOR  #STAFLCLR
00001D48                          1885m ; SETS THE FILL COLOR FOR DRAWING
00001D48                          1886m ; INPUT    : #STAFLCLR COLOR IN $00BBGGRR FORMAT 
00001D48                          1887m ; OUTPUT   : NONE
00001D48                          1888m ; MODIFIES : D0,D1
00001D48                          1889m ;------------------------------------------------------------------------------
00001D58                          1890              
00001D58  41F9 00001D76           1891              LEA     .TXT1,A0
00001D5E  103C 0001               1892              MOVE.B  #1,D0
00001D62  4EB8 12F8               1893              JSR     UTLPRINT
00001D66                          1894              
00001D66  41F9 00001D99           1895              LEA     .TXT2,A0
00001D6C  4EB8 12F8               1896              JSR     UTLPRINT           
00001D70                          1897              
00001D70  4CDF 0103               1898  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001D74  4E75                    1899              RTS
00001D76= 50 52 45 53 53 20 ...   1900  .TXT1       DC.B    'PRESS SPACE TO RETURN TO THE INTRO',0
00001D99= 50 52 45 53 53 20 ...   1901  .TXT2       DC.B    'PRESS KEY DOWN TO START THE GAME',0
00001DBA                          1902              DS.W    0
00001DBA                          1903  
00001DBA                          1904  
00001DBA                          1905  
00001DBA                          1906  
00001DBA                          1907  
00001DBA                          1908  
00001DBA                          1909  
00001DBA                          1910              
00001DBA                          1911  
00001DBA                          1912  
00001DBA                          1913              
00001DBA                          1914  
00001DBA                          1915  
00001DBA                          1916  
00001DBA                          1917  
00001DBA                          1918  
00001DBA                          1919  -------------------- end include --------------------
00001DBA                          1920              INCLUDE "GAME.X68"
00001DBA                          1921  ; ==============================================================================
00001DBA                          1922  ; GAME MANAGEMENT
00001DBA                          1923  ; ==============================================================================
00001DBA                          1924  
00001DBA                          1925  ; ------------------------------------------------------------------------------
00001DBA                          1926  GAMINIT
00001DBA                          1927  ; INITIALIZES GAME.
00001DBA                          1928  ; INPUT    : NONE
00001DBA                          1929  ; OUTPUT   : NONE
00001DBA                          1930  ; MODIFIES : NONE
00001DBA                          1931  ; ------------------------------------------------------------------------------
00001DBA                          1932  
00001DBA  4EB8 1000               1933              JSR     DMMINIT
00001DBE  4EB8 1448               1934              JSR     TNKINIT
00001DC2  4EB8 153E               1935              JSR     ALNINIT 
00001DC6  6000 FAFA               1936              BRA     SCOINIT
00001DCA                          1937  
00001DCA                          1938  ; ------------------------------------------------------------------------------
00001DCA                          1939  GAMUPD
00001DCA                          1940  ; UPDATES THE GAME
00001DCA                          1941  ; INPUT    : NONE
00001DCA                          1942  ; OUTPUT   : NONE
00001DCA                          1943  ; MODIFIES : NONE
00001DCA                          1944  ; ------------------------------------------------------------------------------
00001DCA  48E7 C070               1945              MOVEM.L D0-D1/A1-A3,-(A7)
00001DCE                          1946  
00001DCE                          1947              ;AÑADIR DISPARO SI TECLADO = "UP" 
00001DCE  0839 0002 00001F73      1948              BTST.B  #2,(KBDEDGE)
00001DD6  6700 001C               1949              BEQ     .GOUPD
00001DDA  43F8 1772               1950              LEA     SHTINIT,A1
00001DDE  45F8 178A               1951              LEA     SHTUPD,A2
00001DE2  47F8 1876               1952              LEA     SHTPLOT,A3
00001DE6  303C 0001               1953              MOVE.W  #1,D0
00001DEA  4EB8 127E               1954              JSR     AGLADD
00001DEE  5279 00001F68           1955              ADDQ.W  #1,(SCOSHOOT)
00001DF4                          1956  
00001DF4                          1957  .GOUPD      ;UPDATES
00001DF4  4EB8 1298               1958              JSR     AGLUPD 
00001DF8  4EB8 1452               1959              JSR     TNKUPD
00001DFC  4EB8 156E               1960              JSR     ALNUPD
00001E00                          1961              
00001E00                          1962              ;COMPROBAR SI HA GANADO
00001E00  0C79 001E 00001F66      1963              CMP.W   #SCOWIN,(SCOPOINT)
00001E08  6D00 000E               1964              BLT     .NEXT
00001E0C  33FC 0003 00001F6E      1965              MOVE.W  #3,(STANEXT)                ;PASAR A ESTADO VICTORIA
00001E14  6000 001C               1966              BRA     .DONE
00001E18                          1967              
00001E18                          1968              ;COMPROBAR SI HA PERDIDO
00001E18  3239 00001F5A           1969  .NEXT       MOVE.W  (ALNPOSY),D1
00001E1E  0641 0078               1970              ADD.W   #ALNDIM*ALNMPROW,D1         ;D1 = ALNPOSY+ALNDIM*ALNMPROW
00001E22  B27C 01A0               1971              CMP.W   #TNKPOSY,D1                 ;COMPARAR CON POS(Y) TANQUE
00001E26  6D00 000A               1972              BLT     .DONE
00001E2A  33FC 0004 00001F6E      1973              MOVE.W  #4,(STANEXT)                ;PASAR A ESTADO DERROTA
00001E32                          1974  
00001E32  4CDF 0E03               1975  .DONE       MOVEM.L (A7)+,D0-D1/A1-A3    
00001E36  4E75                    1976              RTS  
00001E38                          1977  
00001E38                          1978  ; ------------------------------------------------------------------------------
00001E38                          1979  GAMPLOT
00001E38                          1980  ; PLOTS THE GAME
00001E38                          1981  ; INPUT    : NONE
00001E38                          1982  ; OUTPUT   : NONE
00001E38                          1983  ; MODIFIES : NONE
00001E38                          1984  ; ------------------------------------------------------------------------------
00001E38                          1985  
00001E38  4EB8 12BC               1986              JSR     AGLPLOT
00001E3C  4EB8 149A               1987              JSR     TNKPLOT
00001E40  4EB8 1620               1988              JSR     ALNPLOT
00001E44  6000 FA90               1989              BRA     SCOPLOT
00001E48                          1990  
00001E48                          1991  
00001E48                          1992  
00001E48                          1993  
00001E48                          1994  
00001E48                          1995  
00001E48                          1996  
00001E48                          1997  
00001E48                          1998  
00001E48                          1999  
00001E48                          2000  -------------------- end include --------------------
00001E48                          2001              INCLUDE "WIN.X68"
00001E48                          2002  ; ==============================================================================
00001E48                          2003  ; VICTORY SCREEN
00001E48                          2004  ; ==============================================================================
00001E48                          2005            
00001E48                          2006  
00001E48                          2007  
00001E48                          2008  ; ------------------------------------------------------------------------------
00001E48                          2009  WININIT
00001E48                          2010  ; VICTORY SCREEN UPDATE
00001E48                          2011  ; INPUT    : NONE
00001E48                          2012  ; OUTPUT   : NONE
00001E48                          2013  ; MODIFIES : NONE
00001E48                          2014  ; ------------------------------------------------------------------------------
00001E48  1E3C 0003               2015              MOVE.B  #SNDWIN,D7
00001E4C  4E42                    2016              TRAP    #SNDPLTN
00001E4E  4E75                    2017              RTS
00001E50                          2018  ; ------------------------------------------------------------------------------
00001E50                          2019  WINUPD
00001E50                          2020  ; VICTORY SCREEN UPDATE
00001E50                          2021  ; INPUT    : NONE
00001E50                          2022  ; OUTPUT   : NONE
00001E50                          2023  ; MODIFIES : NONE
00001E50                          2024  ; ------------------------------------------------------------------------------
00001E50  0839 0000 00001F73      2025              BTST.B  #0,(KBDEDGE)
00001E58  6700 0008               2026              BEQ     .CONT
00001E5C  4279 00001F6E           2027              CLR.W   (STANEXT)
00001E62  4E75                    2028  .CONT       RTS
00001E64                          2029  
00001E64                          2030  ; ------------------------------------------------------------------------------
00001E64                          2031  WINPLOT
00001E64                          2032  ; VICTORY SCREEN PLOT
00001E64                          2033  ; INPUT    : NONE
00001E64                          2034  ; OUTPUT   : NONE
00001E64                          2035  ; MODIFIES : NONE
00001E64                          2036  ; ------------------------------------------------------------------------------
00001E64  48E7 C080               2037              MOVEM.L D0-D1/A0,-(A7)
00001E68                          2038              
00001E68  4281                    2039              CLR.L   D1
00001E6A  103C 0051               2040              MOVE.B  #81,D0
00001E6E  4E4F                    2041              TRAP    #15
00001E70                          2042              
00001E70  41F9 00001E92           2043              LEA     .TXT1,A0
00001E76  103C 000A               2044              MOVE.B  #10,D0
00001E7A  4EB8 12F8               2045              JSR     UTLPRINT
00001E7E                          2046              
00001E7E  41F9 00001E9B           2047              LEA     .TXT2,A0
00001E84  103C 0019               2048              MOVE.B  #25,D0
00001E88  4EB8 12F8               2049              JSR     UTLPRINT    
00001E8C                          2050              
00001E8C  4CDF 0103               2051  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001E90                          2052  
00001E90  4E75                    2053              RTS
00001E92= 59 4F 55 20 57 4F ...   2054  .TXT1       DC.B    'YOU WON!',0
00001E9B= 50 52 45 53 53 20 ...   2055  .TXT2       DC.B    'PRESS KEY DOWN TO CONTINUE',0
00001EB6                          2056              DS.W    0
00001EB6                          2057  
00001EB6                          2058  
00001EB6                          2059  
00001EB6                          2060  
00001EB6                          2061  
00001EB6                          2062  
00001EB6                          2063  
00001EB6                          2064  
00001EB6                          2065  
00001EB6                          2066  
00001EB6                          2067  
00001EB6                          2068  
00001EB6                          2069  -------------------- end include --------------------
00001EB6                          2070              INCLUDE "GOVER.X68"            
00001EB6                          2071  ; ==============================================================================
00001EB6                          2072  ; GAME OVER SCREEN
00001EB6                          2073  ; ==============================================================================
00001EB6                          2074     
00001EB6                          2075  
00001EB6                          2076  ; ------------------------------------------------------------------------------
00001EB6                          2077  GOVINIT
00001EB6                          2078  ; GAME OVER SCREEN UPDATE
00001EB6                          2079  ; INPUT    : NONE
00001EB6                          2080  ; OUTPUT   : NONE
00001EB6                          2081  ; MODIFIES : NONE
00001EB6                          2082  ; ------------------------------------------------------------------------------
00001EB6  1E3C 0004               2083              MOVE.B  #SNDGOV,D7
00001EBA  4E42                    2084              TRAP    #SNDPLTN
00001EBC  4E75                    2085              RTS
00001EBE                          2086  ; ------------------------------------------------------------------------------
00001EBE                          2087  GOVUPD
00001EBE                          2088  ; GAME OVER SCREEN UPDATE
00001EBE                          2089  ; INPUT    : NONE
00001EBE                          2090  ; OUTPUT   : NONE
00001EBE                          2091  ; MODIFIES : NONE
00001EBE                          2092  ; ------------------------------------------------------------------------------
00001EBE  0839 0000 00001F73      2093              BTST.B  #0,(KBDEDGE)
00001EC6  6700 0008               2094              BEQ     .CONT
00001ECA  4279 00001F6E           2095              CLR.W   (STANEXT)
00001ED0  4E75                    2096  .CONT       RTS
00001ED2                          2097  
00001ED2                          2098  ; ------------------------------------------------------------------------------
00001ED2                          2099  GOVPLOT
00001ED2                          2100  ; GAME OVER SCREEN PLOT
00001ED2                          2101  ; INPUT    : NONE
00001ED2                          2102  ; OUTPUT   : NONE
00001ED2                          2103  ; MODIFIES : NONE
00001ED2                          2104  ; ------------------------------------------------------------------------------
00001ED2  48E7 C080               2105              MOVEM.L D0-D1/A0,-(A7)
00001ED6                          2106              
00001ED6  4281                    2107              CLR.L   D1
00001ED8  103C 0051               2108              MOVE.B  #81,D0
00001EDC  4E4F                    2109              TRAP    #15
00001EDE                          2110              
00001EDE  41F9 00001F00           2111              LEA     .TXT1,A0
00001EE4  103C 000A               2112              MOVE.B  #10,D0
00001EE8  4EB8 12F8               2113              JSR     UTLPRINT   
00001EEC                          2114              
00001EEC  41F9 00001F0A           2115              LEA     .TXT2,A0
00001EF2  103C 0019               2116              MOVE.B  #25,D0
00001EF6  4EB8 12F8               2117              JSR     UTLPRINT
00001EFA                          2118                
00001EFA  4CDF 0103               2119  .DONE       MOVEM.L (A7)+,D0-D1/A0
00001EFE                          2120  
00001EFE  4E75                    2121              RTS
00001F00= 47 41 4D 45 20 4F ...   2122  .TXT1       DC.B    'GAME OVER',0
00001F0A= 50 52 45 53 53 20 ...   2123  .TXT2       DC.B    'PRESS KEY DOWN TO CONTINUE',0
00001F26                          2124              DS.W    0
00001F26                          2125  
00001F26                          2126  
00001F26                          2127  
00001F26                          2128  
00001F26                          2129  
00001F26                          2130  
00001F26                          2131  
00001F26                          2132  
00001F26                          2133  
00001F26                          2134  -------------------- end include --------------------
00001F26                          2135              
00001F26                          2136  START
00001F26  007C 0700               2137              ORI.W   #$0700,SR
00001F2A                          2138              
00001F2A                          2139              ;INITS
00001F2A  4EB8 10C2               2140              JSR     SYSINIT
00001F2E  4EB8 12E2               2141              JSR     UTLINIT
00001F32  4EB8 1A74               2142              JSR     STAINIT
00001F36                          2143                
00001F36                          2144  .LOOP
00001F36  4E41                    2145              TRAP    #1
00001F38                          2146              
00001F38                          2147              ;UPDATE CURRENT STATE         
00001F38  4EB8 1A84               2148              JSR     STAUPD
00001F3C                          2149              
00001F3C                          2150              ;SYNC
00001F3C  4A39 00001F74           2151  .WINT       TST.B   (SCRINTCT)
00001F42  67F8                    2152              BEQ     .WINT
00001F44  4239 00001F74           2153              CLR.B   (SCRINTCT)
00001F4A                          2154              
00001F4A                          2155              ;PLOT CURRENT STATE
00001F4A  4EB8 1AEA               2156              JSR     STAPLOT
00001F4E                          2157               
00001F4E                          2158              ;UPDATE DOUBLE BUFFER
00001F4E  4E40                    2159              TRAP    #0  
00001F50                          2160              
00001F50  60E4                    2161              BRA     .LOOP
00001F52                          2162  .DONE    
00001F52  FFFF FFFF               2163             SIMHALT
00001F56                          2164        
00001F56                          2165              INCLUDE "VARS.X68"
00001F56                          2166  
00001F56                          2167  ; --- TANK RELATED VARIABLES ---------------------------------------------------
00001F56                          2168  
00001F56                          2169  TNKPOSX     DS.W    1   ;POSICIÓN X TANQUE
00001F58                          2170  
00001F58                          2171  ; --- ALIEN RELATED VARIABLES --------------------------------------------------
00001F58                          2172  
00001F58                          2173  ALNPOSX     DS.W    1   ;POSICIÓN X ALIEN
00001F5A                          2174  ALNPOSY     DS.W    1   ;POSICIÓN Y ALIEN
00001F5C                          2175  ALNVELX     DS.W    1   ;VELOCIDAD ALIENS X (FUNCIONA PARA NIVEL 1 y 3)
00001F5E                          2176  ALNVELX2    DS.W    1   ;VELOCIDAD ALIENS X (FUNCIONA PARA NIVEL 2)
00001F60                          2177  ALNVELY     DS.W    1   ;VELOCIDAD ALIENS Y
00001F62                          2178  
00001F62                          2179  ; --- SHOT RELATED VARIABLES ---------------------------------------------------
00001F62                          2180  
00001F62                          2181  SHTPOSX     DS.W    1   ;POSICIÓN X DISPARO
00001F64                          2182  SHTPOSY     DS.W    1   ;POSICIÓN Y DISPARO
00001F66                          2183  
00001F66                          2184  ; --- SCOREBOARD RELATED VARIABLES ---------------------------------------------
00001F66                          2185  
00001F66                          2186  SCOPOINT    DS.W    1   ;PUNTUACIÓN JUGADOR
00001F68                          2187  SCOSHOOT    DS.W    1   ;NUMERO DE DISPAROS JUGADOR  
00001F6A                          2188  SCOLEVEL    DS.W    1   ;NIVEL DE DIFICULTAD
00001F6C                          2189  
00001F6C                          2190  ; --- STATE RELATED VARIABLES --------------------------------------------------
00001F6C                          2191  
00001F6C                          2192  STACUR      DS.W    1   ;CURRENT STATE
00001F6E                          2193  STANEXT     DS.W    1   ;NEXT STATE
00001F70                          2194  
00001F70                          2195  
00001F70                          2196  
00001F70                          2197  
00001F70                          2198  
00001F70                          2199  
00001F70                          2200  
00001F70                          2201  
00001F70                          2202  
00001F70                          2203  
00001F70                          2204  
00001F70                          2205  
00001F70                          2206  
00001F70                          2207  
00001F70                          2208  
00001F70                          2209  
00001F70                          2210  
00001F70                          2211  
00001F70                          2212  
00001F70                          2213  -------------------- end include --------------------
00001F70                          2214              INCLUDE "LIB/UTLVARS.X68"
00001F70                          2215  ; =============================================================================
00001F70                          2216  ; UTILITY VARIABLES
00001F70                          2217  ; =============================================================================
00001F70                          2218  
00001F70                          2219  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001F72                          2220              DS.W    0
00001F72                          2221  -------------------- end include --------------------
00001F72                          2222              INCLUDE "SYSVARS.X68"
00001F72                          2223      
00001F72                          2224      ; VARIABLES TECLADO    
00001F72                          2225  KBDVAL      DS.B    1
00001F73                          2226  KBDEDGE     DS.B    1
00001F74                          2227  
00001F74                          2228      ; VARIABLES CONTADORES
00001F74                          2229  SCRINTCT    DS.B    1   ; INTERRUPT COUNTER
00001F75                          2230  SCRCYCCT    DS.B    1   ; CYCLE COUNTER
00001F76                          2231              
00001F76                          2232           
00001F76                          2233  
00001F76                          2234  
00001F76                          2235  
00001F76                          2236  
00001F76                          2237  
00001F76                          2238  
00001F76                          2239  
00001F76                          2240  
00001F76                          2241  
00001F76                          2242  
00001F76                          2243  -------------------- end include --------------------
00001F76                          2244              INCLUDE "LIB/DMMVARS.X68"
00001F76                          2245  ; =============================================================================
00001F76                          2246  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
00001F76                          2247  ; =============================================================================
00001F76                          2248  
00001F80                          2249              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001F80                          2250  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002C00                          2251              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002C00                          2252  -------------------- end include --------------------
00002C00                          2253   
00002C00                          2254              END    START      

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              127E
AGLADD:END          1294
AGLKILL             10AC
AGLPLOT             12BC
AGLPLOT:END         12DC
AGLPLOT:LOOP        12C4
AGLUPD              1298
AGLUPD:END          12B6
AGLUPD:LOOP         12A0
ALNCOL              A
ALNDATA             16F6
ALNDIM              28
ALNFLCLR            FF00
ALNINIT             153E
ALNIPOSX            78
ALNIPOSY            50
ALNMPCOL            A
ALNMPROW            3
ALNPIXEL            C
ALNPLOT             1620
ALNPLOT1            16B6
ALNPLOT1:CLOOP1     16CE
ALNPLOT1:NEXT1      16E0
ALNPLOT1:RLOOP1     16D8
ALNPLOT:CLOOP       1662
ALNPLOT:NEXT        167E
ALNPLOT:RLOOP       1672
ALNPNCLR            AA00
ALNPOSX             1F58
ALNPOSY             1F5A
ALNROW              A
ALNSPD1             8
ALNSPD2             C
ALNUPD              156E
ALNUPD:CHKCOL       15CA
ALNUPD:COLLFT       15F8
ALNUPD:COLRGT       15DE
ALNUPD:DONE         160E
ALNUPD:LVL1         1592
ALNUPD:LVL2         15A4
ALNUPD:LVL3         15B6
ALNVELX             1F5C
ALNVELX2            1F5E
ALNVELY             1F60
DEMINIT             1CE8
DEMPLOT             1D34
DEMPLOT:DONE        1D70
DEMPLOT:TXT1        1D76
DEMPLOT:TXT2        1D99
DEMUPD              1CFC
DEMUPD:CONT         1D20
DEMUPD:DONE         1D32
DISPCLR             FF66
DMMALLOC            1092
DMMALLOC:END        10AA
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1F80
DMMFCOM             106C
DMMFFND             107A
DMMFIRST            1022
DMMFLOOP            1060
DMMFRCOM            1034
DMMFREE             10AC
DMMFRFND            1042
DMMFRLOP            1028
DMMFRSTO            105A
DMMINIT             1000
DMMINIT:LOOP        100E
DMMNEXT             1044
DMMNEXTO            107C
DMMSYSID            0
FILINIT             198A
FILINIT:DONE        199A
FILINIT:FILE        19A0
FILUPD              19B0
FILUPD:BUFFER       1A10
FILUPD:DONE         1A0A
FILUPD:NEXT1        19EA
FILUPD:NEXT2        19FC
GAMINIT             1DBA
GAMPLOT             1E38
GAMUPD              1DCA
GAMUPD:DONE         1E32
GAMUPD:GOUPD        1DF4
GAMUPD:NEXT         1E18
GOVINIT             1EB6
GOVPLOT             1ED2
GOVPLOT:DONE        1EFA
GOVPLOT:TXT1        1F00
GOVPLOT:TXT2        1F0A
GOVUPD              1EBE
GOVUPD:CONT         1ED0
INTINIT             1B1C
ISCPLOT             1B4C
ISCPLOT:DONE        1BE4
ISCPLOT:TXT1        1BEA
ISCPLOT:TXT10       1CC7
ISCPLOT:TXT2        1BF9
ISCPLOT:TXT3        1C07
ISCPLOT:TXT4        1C25
ISCPLOT:TXT5        1C42
ISCPLOT:TXT6        1C58
ISCPLOT:TXT7        1C5E
ISCPLOT:TXT8        1C8D
ISCPLOT:TXT9        1CAB
ISCUPD              1B1E
ISCUPD:CONT         1B36
ISCUPD:DONE         1B4A
KBDDOWN             28
KBDEDGE             1F73
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             121E
KBDLEFT             25
KBDPAUSE            50
KBDRIGHT            27
KBDUP               26
KBDUPD              122C
KBDUPD:LOOP         1270
KBDUPD:PACK         126C
KBDUPTN             1
KBDVAL              1F72
LIMIT               0
MAPDATA             1698
MAPPLOT             175A
NIVEL1              1
NIVEL2              2
NIVEL3              3
NIVELCR             FFA500
RESET_LOOP          1766
SCOFLCLR            0
SCOINIT             18C2
SCOLEVEL            1F6A
SCOLINE             101
SCOLINE1            4101
SCOLINE2            4102
SCOPLOT             18D6
SCOPLOT:TXT         196C
SCOPLOT:TXT1        1978
SCOPLOT:TXT2        1982
SCOPOINT            1F66
SCOSHOOT            1F68
SCOWIN              1E
SCRCYCCT            1F75
SCRFPS              32
SCRHEIGH            1E0
SCRINIT             11B2
SCRINTCT            1F74
SCRPLOT             11F6
SCRTIM              1210
SCRUPTN             0
SCRWIDTH            280
SET_FILL_COLOR      14E
SET_PEN_COLOR       0
SHTADD              1A12
SHTFLCLR            FF
SHTGAP              A
SHTHEIGH            10
SHTINIT             1772
SHTPLOT             1876
SHTPNCLR            AA
SHTPOSX             1F62
SHTPOSY             1F64
SHTSPEED            A
SHTUPD              178A
SHTUPD:DONE         186C
SHTUPD:NEXT         17B2
SHTWIDTH            4
SNDDEM              1
SNDGOV              4
SNDHIT              2
SNDINIT             10FC
SNDINIT:DONE        111A
SNDINIT:LOOP        1108
SNDINIT:SNDDEM      1131
SNDINIT:SNDGOV      116A
SNDINIT:SNDHIT      1141
SNDINIT:SNDLIST     117C
SNDINIT:SNDSHT      1120
SNDINIT:SNDWIN      1156
SNDPLAY             1194
SNDPLTN             2
SNDSHT              0
SNDWIN              3
STACUR              1F6C
STAEMPTY            1B1A
STAFLCLR            0
STAINIT             1A74
STANEXT             1F6E
STANONE             FFFFFFFF
STAPLOT             1AEA
STAPLOT:PLTTBL      1B06
START               1F26
START:DONE          1F52
START:LOOP          1F36
START:WINT          1F3C
STAUPD              1A84
STAUPD:DOUPD        1AAA
STAUPD:INITBL       1AC2
STAUPD:UPDTBL       1AD6
SYSINIT             10C2
SYSPLOT             127C
SYSUPD              127A
TNKCOL              9
TNKFLCLR            FF0000
TNKINIT             1448
TNKLEFT             1A56
TNKLEFT:DONE        1A6A
TNKMAP              1508
TNKPLOT             149A
TNKPLOT:CLOOP       14DC
TNKPLOT:NEXT        14F2
TNKPLOT:RLOOP       14EA
TNKPNCLR            AA0000
TNKPOSX             1F56
TNKPOSY             1A0
TNKRIGHT            1A36
TNKRIGHT:DONE       1A4C
TNKROW              6
TNKSPEED            8
TNKSQUWI            8
TNKUPD              1452
TNKUPD:CHKLEFT      1476
TNKUPD:CHKRIGHT     1484
TNKUPD:DONE         1490
TNKUPD:LEFT         1468
TNKWIDHA            24
TNKWIDTH            48
UTLCHRWD            8
UTLINIT             12E2
UTLPRINT            12F8
UTLPRINT:ENDLOOP    130A
UTLPRINT:LOOP       1300
UTLRAND             132A
UTLRAND:RANDVEC     1348
UTLRNDIX            1F70
WININIT             1E48
WINPLOT             1E64
WINPLOT:DONE        1E8C
WINPLOT:TXT1        1E92
WINPLOT:TXT2        1E9B
WINUPD              1E50
WINUPD:CONT         1E62
