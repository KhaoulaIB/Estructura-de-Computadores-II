000017E4 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 14/12/2023 14:06:34

00000000                             1  *-----------------------------------------------------------
00000000                             2  * Title      : PRÁCTICA 1
00000000                             3  * Written by :
00000000                             4  * Date       :
00000000                             5  * Description:
00000000                             6  *-----------------------------------------------------------
00000000                             7     
00001000                             8              ORG     $1000
00001000                             9          
00001000                            10              INCLUDE "SYSCONST.X68"
00001000                            11      ;RESOLUCIÓN PANTALLA
00001000  =000001E0                 12  SCRHEIGH    EQU     480
00001000  =00000280                 13  SCRWIDTH    EQU     640
00001000                            14  
00001000                            15      ;PANTALLA FOTOGRAMAS/S 
00001000  =00000032                 16  SCRFPS      EQU     50                      ; SCREEN FRAMES PER SECOND
00001000                            17  
00001000                            18      ;SONIDO
00001000                            19  
00001000                            20      ;CONSTANTES TECLADO
00001000  =00000025                 21  KBDLEFT     EQU     $25
00001000  =00000026                 22  KBDUP       EQU     $26
00001000  =00000027                 23  KBDRIGHT    EQU     $27
00001000  =00000028                 24  KBDDOWN     EQU     $28
00001000                            25  
00001000                            26    
00001000                            27  
00001000                            28  
00001000                            29  
00001000                            30  
00001000                            31  
00001000                            32  
00001000                            33  
00001000                            34  -------------------- end include --------------------
00001000                            35              INCLUDE "CONST.X68"
00001000  =0000FF00                 36  ALNFLCLR    EQU     $0000FF00   ;COLOR RELLENO ALIEN
00001000  =0000AA00                 37  ALNPNCLR    EQU     $0000AA00   ;COLOR CONTORNO ALIEN
00001000  =00000028                 38  ALNDIM      EQU     40          ;DIMENSIÓN CUADRADO MAPA ALIEN
00001000  =0000000A                 39  ALNROW      EQU     10          ;FILAS DIBUJO ALIEN
00001000  =0000000A                 40  ALNCOL      EQU     10          ;COLUMNAS DIBUJO ALIEN
00001000  =00000003                 41  ALNMPROW    EQU     3           ;FILAS MAPA ALIEN   
00001000  =0000000A                 42  ALNMPCOL    EQU     10          ;COLUMNAS MAPA ALIEN
00001000  =00000078                 43  ALNIPOSX    EQU     120         ;INICIO POS X ALIENS
00001000  =00000050                 44  ALNIPOSY    EQU     80          ;INICIO POS Y ALIENS
00001000  =00000004                 45  ALNSPEED    EQU     4           ;VELOCIDAD ALIENS
00001000                            46  
00001000                            47  
00001000  =00FF0000                 48  TNKFLCLR    EQU     $00FF0000   ;COLOR RELLENO TANQUE
00001000  =00AA0000                 49  TNKPNCLR    EQU     $00AA0000   ;COLOR CONTORNO TANQUE
00001000  =00000048                 50  TNKWIDTH    EQU     72          ;ANCHO TANQUE (DIMENSIÓN * COLUMNAS)
00001000  =00000024                 51  TNKWIDHA    EQU     36          ;MITAD ANCHO TANQUE (DIMENSIÓN * COLUMNAS)/2
00001000  =00000008                 52  TNKSQUWI    EQU     8           ;DIMENSIÓN CUADRADO TANQUE 
00001000  =000001A0                 53  TNKPOSY     EQU     416         ;POSICIÓN Y TANQUE (480-64)
00001000  =00000006                 54  TNKROW      EQU     6           ;FILAS MAPA TANQUE
00001000  =00000009                 55  TNKCOL      EQU     9           ;COLUMNAS MAPA TANQUE
00001000  =00000008                 56  TNKSPEED    EQU     8           ;VELOCIDAD TANQUE
00001000                            57  
00001000                            58  
00001000  =000000FF                 59  SHTFLCLR    EQU     $000000FF   ;COLOR RELLENO DISPARO
00001000  =000000AA                 60  SHTPNCLR    EQU     $000000AA   ;COLOR CONTORNO DISPARO
00001000  =00000004                 61  SHTWIDTH    EQU     4           ;ANCHO DISPARO
00001000  =00000010                 62  SHTHEIGH    EQU     16          ;ALTURA DISPARO
00001000  =0000000A                 63  SHTGAP      EQU     10          ;ESPACIO TANQUE Y DISPARO
00001000  =0000000A                 64  SHTSPEED    EQU     10           ;VELOCIDAD DISPARO
00001000                            65  
00001000                            66  
00001000  =00000000                 67  SCOFLCLR    EQU     $00000000   ;COLOR RELLENO MARCADOR
00001000  =00000101                 68  SCOLINE     EQU     $0101       ;COORDENADAS LINEA MARCADOR
00001000                            69  
00001000  =00000000                 70  FPSFLCLR     EQU    $00000000   ;COLOR RELLENO FPS
00001000  =00003101                 71  FPSLINE1     EQU    $3101       ;COORDENADAS LINEA 1 FPS
00001000  =00003901                 72  FPSLINE2     EQU    $3901       ;COORDENADAS LINEA 2 FPS
00001000  =00004901                 73  FPSLINE3     EQU    $4901       ;COORDENADAS LINEA 3 FPS
00001000                            74  
00001000                            75  
00001000                            76  
00001000                            77  
00001000                            78  
00001000                            79  
00001000                            80  
00001000                            81  
00001000                            82  
00001000                            83  
00001000                            84  
00001000                            85  
00001000                            86  
00001000                            87  
00001000                            88  
00001000                            89  
00001000                            90  
00001000                            91  
00001000                            92  
00001000                            93  
00001000                            94  
00001000                            95  
00001000                            96  
00001000                            97  
00001000                            98  
00001000                            99  
00001000                           100  
00001000                           101  
00001000                           102  
00001000                           103  
00001000                           104  
00001000                           105  
00001000                           106  
00001000                           107  
00001000                           108  
00001000                           109  
00001000                           110  
00001000                           111  
00001000                           112  
00001000                           113  
00001000                           114  -------------------- end include --------------------
00001000                           115              INCLUDE "LIB/DMMCONST.X68"
00001000                           116  ; =============================================================================
00001000                           117  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001000                           118  ; =============================================================================
00001000                           119  
00001000  =00000040                120  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                121  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                122  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000  =00000000                123  -------------------- end include --------------------
00001000                           124              INCLUDE "LIB/DMMCODE.X68"
00001000                           125  ; =============================================================================
00001000                           126  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001000                           127  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001000                           128  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001000                           129  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001000                           130  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001000                           131  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001000                           132  ; =============================================================================
00001000                           133  
00001000                           134  ; -----------------------------------------------------------------------------
00001000                           135  DMMINIT
00001000                           136  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001000                           137  ; INPUT    - NONE
00001000                           138  ; OUTPUT   - NONE
00001000                           139  ; MODIFIES - NONE
00001000                           140  ; -----------------------------------------------------------------------------
00001000  48E7 8080                141              MOVEM.L D0/A0,-(A7)
00001004  41F9 00001880            142              LEA     DMMDATA,A0
0000100A  303C 0031                143              MOVE.W  #DMMBNUM-1,D0
0000100E  30BC 0000                144  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001012  D1FC 00000040            145              ADD.L   #DMMBSIZE,A0
00001018  51C8 FFF4                146              DBRA.W  D0,.LOOP
0000101C  4CDF 0101                147              MOVEM.L (A7)+,D0/A0
00001020  4E75                     148              RTS
00001022                           149  
00001022                           150  ; -----------------------------------------------------------------------------
00001022                           151  DMMFIRST
00001022                           152  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001022                           153  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001022                           154  ; INPUT    - NONE
00001022                           155  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001022                           156  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001022                           157  ; -----------------------------------------------------------------------------
00001022  41F9 00001880            158              LEA     DMMDATA,A0
00001028  4A58                     159  DMMFRLOP    TST.W   (A0)+
0000102A  6600 0016                160              BNE     DMMFRFND
0000102E  D1FC 0000003E            161              ADD.L   #DMMBSIZE-2,A0
00001034  B1FC 000024FF            162  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
0000103A  6DEC                     163              BLT     DMMFRLOP
0000103C  207C 00000000            164              MOVE.L  #0,A0
00001042  4E75                     165  DMMFRFND    RTS
00001044                           166  
00001044                           167  ; -----------------------------------------------------------------------------
00001044                           168  DMMNEXT
00001044                           169  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001044                           170  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001044                           171  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001044                           172  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001044                           173  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001044                           174  ; -----------------------------------------------------------------------------
00001044  2F00                     175              MOVE.L  D0,-(A7)
00001046  2008                     176              MOVE.L  A0,D0
00001048  C0BC FFFFFFC0            177              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000104E  0680 00000040            178              ADD.L   #DMMBSIZE,D0
00001054  2040                     179              MOVE.L  D0,A0
00001056  201F                     180              MOVE.L  (A7)+,D0
00001058  60DA                     181              BRA     DMMFRCOM
0000105A                           182  
0000105A                           183  ; -----------------------------------------------------------------------------
0000105A                           184  DMMFRSTO
0000105A                           185  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000105A                           186  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000105A                           187  ; INPUT    - D0.W : ID TO SEARCH
0000105A                           188  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000105A                           189  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000105A                           190  ; -----------------------------------------------------------------------------
0000105A  41F9 00001880            191              LEA     DMMDATA,A0
00001060  B058                     192  DMMFLOOP    CMP.W   (A0)+,D0
00001062  6700 0016                193              BEQ     DMMFFND
00001066  D1FC 0000003E            194              ADD.L   #DMMBSIZE-2,A0
0000106C  B1FC 000024FF            195  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001072  6DEC                     196              BLT     DMMFLOOP
00001074  207C 00000000            197              MOVE.L  #0,A0
0000107A  4E75                     198  DMMFFND     RTS
0000107C                           199  
0000107C                           200  ; -----------------------------------------------------------------------------
0000107C                           201  DMMNEXTO
0000107C                           202  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000107C                           203  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000107C                           204  ; INPUT    - D0.W : ID TO SEARCH
0000107C                           205  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000107C                           206  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000107C                           207  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000107C                           208  ; -----------------------------------------------------------------------------
0000107C  2F00                     209              MOVE.L  D0,-(A7)
0000107E  2008                     210              MOVE.L  A0,D0
00001080  C0BC FFFFFFC0            211              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001086  0680 00000040            212              ADD.L   #DMMBSIZE,D0
0000108C  2040                     213              MOVE.L  D0,A0
0000108E  201F                     214              MOVE.L  (A7)+,D0
00001090  60DA                     215              BRA     DMMFCOM
00001092                           216  
00001092                           217  ; -----------------------------------------------------------------------------
00001092                           218  DMMALLOC
00001092                           219  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001092                           220  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001092                           221  ; INPUT    - D0.W : ID TO ASSIGN
00001092                           222  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001092                           223  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001092                           224  ; -----------------------------------------------------------------------------
00001092  3F00                     225              MOVE.W  D0,-(A7)
00001094  4240                     226              CLR.W   D0
00001096  4EB8 105A                227              JSR     DMMFRSTO
0000109A  301F                     228              MOVE.W  (A7)+,D0
0000109C  B1FC 00000000            229              CMP.L   #0,A0
000010A2  6700 0006                230              BEQ     .END
000010A6  3140 FFFE                231              MOVE.W  D0,-2(A0)
000010AA  4E75                     232  .END        RTS
000010AC                           233  
000010AC                           234  ; -----------------------------------------------------------------------------
000010AC                           235  DMMFREE
000010AC                           236  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010AC                           237  ; SYSTEM (0)
000010AC                           238  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010AC                           239  ; OUTPUT   - NONE
000010AC                           240  ; MODIFIES - NONE
000010AC                           241  ; -----------------------------------------------------------------------------
000010AC  48E7 8080                242              MOVEM.L D0/A0,-(A7)
000010B0  2008                     243              MOVE.L  A0,D0
000010B2  C0BC FFFFFFC0            244              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010B8  2040                     245              MOVE.L  D0,A0
000010BA  4250                     246              CLR.W   (A0)
000010BC  4CDF 0101                247              MOVEM.L (A7)+,D0/A0
000010C0  4E75                     248              RTS
000010C0  4E75                     249  -------------------- end include --------------------
000010C2                           250              INCLUDE "SYSTEM.X68"
000010C2                           251  ; ------------------------------------------------------------------------------
000010C2                           252  SYSINIT
000010C2                           253  ; INIT SYSTEM: SET SCREEN RESOLUTION AND WINDOWED MODE.
000010C2                           254  ; INPUT    : NONE
000010C2                           255  ; OUTPUT   : NONE
000010C2                           256  ; MODIFIES : NONE
000010C2                           257  ; ------------------------------------------------------------------------------
000010C2                           258  
000010C2  4EB9 000010EE            259              JSR SCRINIT
000010C8  4EB9 00001154            260              JSR KBDINIT
000010CE                           261  
000010CE                           262              ;INSTALAR TRAPS I INTERRUPCIONS
000010CE  21FC 00001132 0080       263              MOVE.L  #SCRPLOT,($80)
000010D6  21FC 00001162 0084       264              MOVE.L  #KBDUPD,($84)
000010DE  21FC 0000114C 0064       265              MOVE.L  #SCRTIM,($64)
000010E6                           266              
000010E6  40E7                     267              MOVE.W  SR,-(A7)
000010E8  0257 D8FF                268              ANDI.W  #$D8FF,(A7)
000010EC                           269              
000010EC  4E73                     270              RTE
000010EE                           271              
000010EE                           272  ; ------------------------------------------------------------------------------
000010EE                           273  SCRINIT
000010EE                           274  ; INIT SYSTEM: SET SCREEN RESOLUTION AND WINDOWED MODE.
000010EE                           275  ; INPUT    : NONE
000010EE                           276  ; OUTPUT   : NONE
000010EE                           277  ; MODIFIES : NONE
000010EE                           278  ; ------------------------------------------------------------------------------
000010EE                           279  
000010EE  48E7 C000                280              MOVEM.L D0-D1,-(A7)
000010F2                           281  
000010F2                           282              ;SET SCREEN RESOLUTION
000010F2  103C 0021                283              MOVE.B  #33,D0
000010F6  223C 028001E0            284              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000010FC  4E4F                     285              TRAP    #15
000010FE                           286  
000010FE                           287              ;SET WINDOWED MODE
000010FE  7201                     288              MOVE.L  #1,D1
00001100  4E4F                     289              TRAP    #15
00001102                           290              
00001102                           291              ;CLEAR SCREEN
00001102  103C 000B                292              MOVE.B  #11,D0
00001106  323C FF00                293              MOVE.W  #$FF00,D1
0000110A  4E4F                     294              TRAP    #15
0000110C                           295              
0000110C                           296              ;ENABLE DOUBLE BUFFER
0000110C  103C 005C                297              MOVE.B  #92,D0
00001110  123C 0011                298              MOVE.B  #17,D1
00001114  4E4F                     299              TRAP    #15
00001116                           300              
00001116                           301              ; ENABLE TIMED INTERRUPT
00001116  103C 0020                302              MOVE.B  #32,D0
0000111A  123C 0006                303              MOVE.B  #6,D1
0000111E  143C 0081                304              MOVE.B  #$81,D2
00001122  7614                     305              MOVE.L  #1000/SCRFPS,D3
00001124  4E4F                     306              TRAP    #15
00001126                           307              
00001126                           308              ; CLEAR INTERRUPT COUNTER
00001126  4239 00001872            309              CLR.B   (SCRINTCT)
0000112C                           310              
0000112C  4CDF 0003                311              MOVEM.L (A7)+,D0-D1
00001130  4E75                     312              RTS
00001132                           313  
00001132                           314  ; ------------------------------------------------------------------------------
00001132                           315  SCRPLOT
00001132                           316  ; UPDATES DOUBLE BUFFER
00001132                           317  ; INPUT    : NONE
00001132                           318  ; OUTPUT   : NONE
00001132                           319  ; MODIFIES : NONE
00001132                           320  ; ------------------------------------------------------------------------------
00001132                           321              
00001132  48A7 C000                322              MOVEM.W D0-D1,-(A7)
00001136                           323              
00001136                           324              ; SWITCH BUFFERS
00001136  103C 005E                325              MOVE.B  #94,D0
0000113A  4E4F                     326              TRAP    #15
0000113C                           327  
0000113C                           328              ; CLEAR HIDDEN BUFFER
0000113C  103C 000B                329              MOVE.B  #11,D0
00001140  323C FF00                330              MOVE.W  #$FF00,D1
00001144  4E4F                     331              TRAP    #15
00001146                           332              
00001146  4C9F 0003                333              MOVEM.W (A7)+,D0-D1
0000114A  4E73                     334              RTE
0000114C                           335              
0000114C                           336  ; ------------------------------------------------------------------------------
0000114C                           337  SCRTIM
0000114C                           338  ; TIMED INTERRUPT SERVICE ROUTINE
0000114C                           339  ; INPUT    : NONE
0000114C                           340  ; OUTPUT   : NONE
0000114C                           341  ; MODIFIES : NONE
0000114C                           342  ; ------------------------------------------------------------------------------
0000114C  5239 00001872            343              ADDQ.B  #1,(SCRINTCT)
00001152  4E73                     344              RTE
00001154                           345  
00001154                           346   
00001154                           347   ; ------------------------------------------------------------------------------
00001154                           348  KBDINIT
00001154                           349  ; INIT THE KEYBOARD 
00001154                           350  ; INPUT    : NONE
00001154                           351  ; OUTPUT   : NONE
00001154                           352  ; MODIFIES : NONE
00001154                           353  ; ------------------------------------------------------------------------------
00001154                           354              
00001154  4239 0000186E            355              CLR.B (KBDVAL)
0000115A  4239 0000186F            356              CLR.B (KBDEDGE)
00001160                           357              
00001160  4E75                     358              RTS
00001162                           359  
00001162                           360   ; ------------------------------------------------------------------------------
00001162                           361  KBDUPD
00001162                           362  ; UPDATE THE KEYBOARD IN THIS ORDER:
00001162                           363  ;KBDLEFT   : BIT 3   
00001162                           364  ;KBDUP     : BIT 2   
00001162                           365  ;KBDRIGHT  : BIT 1
00001162                           366  ;KBDDOWN   : BIT 0
00001162                           367  ; INPUT    : NONE
00001162                           368  ; OUTPUT   : NONE
00001162                           369  ; MODIFIES : NONE
00001162                           370  ; ------------------------------------------------------------------------------
00001162                           371              
00001162  48E7 F000                372              MOVEM.L D0-D3,-(A7)
00001166                           373              
00001166  103C 0013                374              MOVE.B  #19,D0
0000116A  223C 25262728            375              MOVE.L  #KBDLEFT<<24|KBDUP<<16|KBDRIGHT<<8|KBDDOWN,D1
00001170  4E4F                     376              TRAP    #15
00001172                           377              
00001172  363C 0003                378              MOVE.W  #4-1,D3
00001176  E189                     379  .LOOP       LSL.L   #8,D1
00001178  E312                     380              ROXL.B  #1,D2
0000117A  51CB FFFA                381              DBRA.W   D3,.LOOP
0000117E                           382              
0000117E                           383              ;COMPUTE KBDEDGE
0000117E  1039 0000186E            384              MOVE.B  (KBDVAL),D0
00001184  4600                     385              NOT.B   D0
00001186  C002                     386              AND.B   D2,D0
00001188  13C0 0000186F            387              MOVE.B  D0,(KBDEDGE)
0000118E                           388              
0000118E  13C2 0000186E            389              MOVE.B  D2,(KBDVAL)
00001194                           390              
00001194  4CDF 000F                391              MOVEM.L (A7)+,D0-D3
00001198  4E73                     392              RTE
0000119A                           393  
0000119A                           394  ; ------------------------------------------------------------------------------
0000119A                           395  SYSUPD
0000119A                           396  ; UPDATES THE SYSTEM 
0000119A                           397  ; INPUT    : NONE
0000119A                           398  ; OUTPUT   : NONE
0000119A                           399  ; MODIFIES : NONE
0000119A                           400  ; ------------------------------------------------------------------------------
0000119A                           401  
0000119A  4E75                     402              RTS
0000119C                           403  
0000119C                           404  ; ------------------------------------------------------------------------------
0000119C                           405  SYSPLOT
0000119C                           406  ; PLOT THE SYSTEM.
0000119C                           407  ; INPUT    : NONE
0000119C                           408  ; OUTPUT   : NONE
0000119C                           409  ; MODIFIES : NONE
0000119C                           410  ; ------------------------------------------------------------------------------
0000119C                           411      
0000119C  4E75                     412              RTS
0000119E                           413  
0000119E                           414  
0000119E                           415  
0000119E                           416  
0000119E                           417  
0000119E                           418  
0000119E                           419  
0000119E                           420  -------------------- end include --------------------
0000119E                           421              INCLUDE "MACROS.X68"        ;EL ORDEN IMPORTA
0000119E                           422  
0000119E                           423  
0000119E                           424      
0000119E                           425  ;..............................................................................
0000119E                           426  SET_PEN_COLOR   MACRO
0000119E                           427  ; SETS THE PEN COLOR FOR DRAWING
0000119E                           428  ; INPUT    : \1 COLOR IN $00BBGGRR FORMAT 
0000119E                           429  ; OUTPUT   : NONE
0000119E                           430  ; MODIFIES : D0,D1
0000119E                           431  ;..............................................................................
0000119E                           432      MOVEM.L D0-D1,-(A7)
0000119E                           433      
0000119E                           434      MOVE.B  #80,D0
0000119E                           435      MOVE.L  \1,D1
0000119E                           436      TRAP    #15
0000119E                           437              
0000119E                           438      MOVEM.L (A7)+,D0-D1
0000119E                           439      ENDM
0000119E                           440  
0000119E                           441  ;..............................................................................
0000119E                           442  SET_FILL_COLOR  MACRO
0000119E                           443  ; SETS THE FILL COLOR FOR DRAWING
0000119E                           444  ; INPUT    : \1 COLOR IN $00BBGGRR FORMAT 
0000119E                           445  ; OUTPUT   : NONE
0000119E                           446  ; MODIFIES : D0,D1
0000119E                           447  ;..............................................................................
0000119E                           448      MOVEM.L D0-D1,-(A7)
0000119E                           449      
0000119E                           450      MOVE.B  #81,D0
0000119E                           451      MOVE.L  \1,D1
0000119E                           452      TRAP    #15
0000119E                           453              
0000119E                           454      MOVEM.L (A7)+,D0-D1
0000119E                           455      ENDM
0000119E                           456  
0000119E                           457  -------------------- end include --------------------
0000119E                           458              INCLUDE "LIB/AGLCODE.X68"
0000119E                           459  ; =============================================================================
0000119E                           460  ; AGENT MANAGEMENT
0000119E                           461  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
0000119E                           462  ; +0 - LONG : UPDATE SUBROUTINE POINTER
0000119E                           463  ; +4 - LONG : PLOT SUBROUTINE POINTER
0000119E                           464  ; +8:END    : DATA (AGENT SPECIFIC)
0000119E                           465  ; =============================================================================
0000119E                           466  
0000119E                           467  ; -----------------------------------------------------------------------------
0000119E                           468  AGLADD
0000119E                           469  ; CREATES A NEW AGENT
0000119E                           470  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
0000119E                           471  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
0000119E                           472  ;            A3 - POINTER TO AGENT PLOT FUNCTION
0000119E                           473  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
0000119E                           474  ;            D1 - AGENT INITIALIZATION PARAMETER 1
0000119E                           475  ;            D2 - AGENT INITIALIZATION PARAMETER 2
0000119E                           476  ;            D3 - AGENT INITIALIZATION PARAMETER 3
0000119E                           477  ; OUTPUT   - NONE
0000119E                           478  ; MODIFIES - NONE
0000119E                           479  ; -----------------------------------------------------------------------------
0000119E  2F08                     480              MOVE.L  A0,-(A7)
000011A0  4EB8 1092                481              JSR     DMMALLOC
000011A4  B1FC 00000000            482              CMP.L   #0,A0
000011AA  6700 0008                483              BEQ     .END
000011AE  20CA                     484              MOVE.L  A2,(A0)+
000011B0  20CB                     485              MOVE.L  A3,(A0)+
000011B2  4E91                     486              JSR     (A1)
000011B4  205F                     487  .END        MOVE.L  (A7)+,A0
000011B6  4E75                     488              RTS
000011B8                           489  
000011B8                           490  ; -----------------------------------------------------------------------------
000011B8                           491  AGLUPD
000011B8                           492  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000011B8                           493  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000011B8                           494  ; INPUT    - NONE
000011B8                           495  ; OUTPUT   - NONE
000011B8                           496  ; MODIFIES - NONE
000011B8                           497  ; -----------------------------------------------------------------------------
000011B8  48E7 00C0                498              MOVEM.L A0-A1,-(A7)
000011BC  4EB8 1022                499              JSR     DMMFIRST
000011C0  B1FC 00000000            500  .LOOP       CMP.L   #0,A0
000011C6  6700 000E                501              BEQ     .END
000011CA  2250                     502              MOVE.L  (A0),A1
000011CC  5088                     503              ADD.L   #8,A0
000011CE  4E91                     504              JSR     (A1)
000011D0  4EB8 1044                505              JSR     DMMNEXT
000011D4  60EA                     506              BRA     .LOOP
000011D6  4CDF 0300                507  .END        MOVEM.L (A7)+,A0-A1
000011DA  4E75                     508              RTS
000011DC                           509  
000011DC                           510  ; -----------------------------------------------------------------------------
000011DC                           511  AGLPLOT
000011DC                           512  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000011DC                           513  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000011DC                           514  ; INPUT    - NONE
000011DC                           515  ; OUTPUT   - NONE
000011DC                           516  ; MODIFIES - NONE
000011DC                           517  ; -----------------------------------------------------------------------------
000011DC  48E7 00C0                518              MOVEM.L A0-A1,-(A7)
000011E0  4EB8 1022                519              JSR     DMMFIRST
000011E4  B1FC 00000000            520  .LOOP       CMP.L   #0,A0
000011EA  6700 0010                521              BEQ     .END
000011EE  2268 0004                522              MOVE.L  4(A0),A1
000011F2  5088                     523              ADD.L   #8,A0
000011F4  4E91                     524              JSR     (A1)
000011F6  4EB8 1044                525              JSR     DMMNEXT
000011FA  60E8                     526              BRA     .LOOP
000011FC  4CDF 0300                527  .END        MOVEM.L (A7)+,A0-A1
00001200  4E75                     528              RTS
00001202                           529  
00001202                           530  ; -----------------------------------------------------------------------------
00001202  =000010AC                531  AGLKILL     EQU     DMMFREE
00001202                           532  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001202                           533  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001202                           534  ; OUTPUT   - NONE
00001202                           535  ; MODIFIES - NONE
00001202                           536  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001202                           537  ; -----------------------------------------------------------------------------
00001202                           538  -------------------- end include --------------------
00001202                           539              INCLUDE "LIB/UTLCODE.X68"
00001202                           540  ; =============================================================================
00001202                           541  ; UTILITY CODE
00001202                           542  ; =============================================================================
00001202                           543  
00001202                           544  ; -----------------------------------------------------------------------------
00001202                           545  UTLINIT
00001202                           546  ; INITIALIZES UTILITY CODE
00001202                           547  ; INPUT    - NONE
00001202                           548  ; OUTPUT   - NONE
00001202                           549  ; MODIFIES - NONE
00001202                           550  ; -----------------------------------------------------------------------------
00001202  48E7 C000                551              MOVEM.L D0-D1,-(A7)
00001206  103C 0008                552              MOVE.B  #8,D0
0000120A  4E4F                     553              TRAP    #15
0000120C  13C1 0000186C            554              MOVE.B  D1,(UTLRNDIX)
00001212  4CDF 0003                555              MOVEM.L (A7)+,D0-D1
00001216  4E75                     556              RTS
00001218                           557  
00001218                           558  ; -----------------------------------------------------------------------------
00001218                           559  UTLRAND
00001218                           560  ; PROVIDES A PSEUDO-RANDOM BYTE
00001218                           561  ; INPUT    - NONE
00001218                           562  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001218                           563  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001218                           564  ; -----------------------------------------------------------------------------
00001218  2F08                     565              MOVE.L  A0,-(A7)
0000121A  41F9 00001236            566              LEA     .RANDVEC,A0
00001220  4280                     567              CLR.L   D0
00001222  1039 0000186C            568              MOVE.B  (UTLRNDIX),D0
00001228  1030 0800                569              MOVE.B  (A0,D0.L),D0
0000122C  5239 0000186C            570              ADDQ.B  #1,(UTLRNDIX)
00001232  205F                     571              MOVE.L  (A7)+,A0
00001234  4E75                     572              RTS
00001236                           573  
00001236                           574  
00001236= A2 EE 9A 0C F5 24 ...    575  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
0000123E= 2A A3 51 26 E0 AC ...    576              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001246= 75 51 CA FD 33 EB ...    577              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
0000124E= 60 CC E7 B8 9A EB ...    578              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001256= 1D 76 B5 95 B0 89 ...    579              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
0000125E= 39 15 48 C9 6E CA ...    580              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001266= 43 E7 E2 7C 37 25 ...    581              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
0000126E= E9 94 CE E9 E4 52 ...    582              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001276= 37 6D 9A 84 A2 28 ...    583              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
0000127E= 19 E2 C6 77 80 D4 ...    584              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001286= 0A 5A 32 67 33 C2 ...    585              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
0000128E= 59 80 DC 0E 57 FC ...    586              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001296= 8A AB BC F7 07 4D ...    587              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
0000129E= EF D5 77 6E 1E BB ...    588              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000012A6= D6 E0 2A 8F BD 28 ...    589              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000012AE= 13 4F 66 EC 0A 64 ...    590              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000012B6= 56 52 9A 16 9B 90 ...    591              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
000012BE= 06 8A A4 F7 01 DA ...    592              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
000012C6= F2 E7 77 28 B1 76 ...    593              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
000012CE= A4 42 E3 81 B1 67 ...    594              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
000012D6= BF CE FA 16 BF 38 ...    595              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
000012DE= D1 8B 50 0C 5F 49 ...    596              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
000012E6= DE 4C 14 A2 40 DC ...    597              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
000012EE= B6 9B 0A 38 5D AB ...    598              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
000012F6= E2 1B DD 75 15 82 ...    599              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000012FE= 8A 26 51 30 9F 47 ...    600              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001306= 1E 8A BB 71 C6 6E ...    601              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
0000130E= 9F 47 E5 34 94 27 ...    602              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001316= 7D 06 D6 BA 30 0F ...    603              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
0000131E= EC 7F 7E 03 CF 2D ...    604              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001326= 94 5B 23 F2 8B CD ...    605              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
0000132E= 74 33 EC B9 0F D5 ...    606              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
0000132E= 74 33 EC B9 0F D5 ...    607  -------------------- end include --------------------
00001336                           608              INCLUDE "TANK.X68"
00001336                           609    
00001336                           610  ; ------------------------------------------------------------------------------
00001336                           611  TNKINIT
00001336                           612  ; INITIALIZE TANK
00001336                           613  ; INPUT    :  
00001336                           614  ; OUTPUT   : NONE
00001336                           615  ; MODIFIES : NONE
00001336                           616  ; ------------------------------------------------------------------------------
00001336                           617  
00001336  33FC 011C 0000185C       618              MOVE.W  #SCRWIDTH/2-TNKWIDHA,(TNKPOSX)  ;MITAD PANTALLA - MITAD ANCHO DEL TANQUE
0000133E                           619  
0000133E  4E75                     620              RTS
00001340                           621              
00001340                           622  ; ------------------------------------------------------------------------------
00001340                           623  TNKUPD
00001340                           624  ; UPDATES THE TANK
00001340                           625  ; INPUT    : 
00001340                           626  ; OUTPUT   : NONE
00001340                           627  ; MODIFIES : NONE
00001340                           628  ; ------------------------------------------------------------------------------
00001340                           629  
00001340  3F00                     630              MOVE.W D0,-(A7)
00001342                           631              
00001342                           632              ;GUARDAR VARIABLE EN REGISTRO
00001342  3039 0000185C            633              MOVE.W  (TNKPOSX),D0        
00001348                           634              
00001348                           635              ;MOVER DERECHA SI TECLA: ->
00001348  0839 0001 0000186E       636              BTST.B  #1,(KBDVAL)
00001350  6700 0004                637              BEQ     .LEFT
00001354  5040                     638              ADD.W   #TNKSPEED,D0
00001356                           639             
00001356                           640              ;MOVER IZQUIERDA SI TECLA: <-
00001356  0839 0003 0000186E       641  .LEFT       BTST.B  #3,(KBDVAL)
0000135E  6700 0004                642              BEQ     .CHKLEFT
00001362  5140                     643              SUB.W   #TNKSPEED,D0
00001364                           644                
00001364                           645              ;COMPOBAR COLISIONES PANTALLA
00001364                           646              ;COMPROBAR COLISIÓN IZQUIERDA
00001364  B07C 0000                647  .CHKLEFT    CMP.W   #0,D0
00001368  6C00 0008                648              BGE     .CHKRIGHT
0000136C  4240                     649              CLR.W   D0
0000136E  6000 000E                650              BRA     .DONE
00001372                           651  
00001372                           652              ;COMPROBAR COLISIÓN DERECHA
00001372  B07C 0238                653  .CHKRIGHT   CMP.W   #SCRWIDTH-TNKWIDTH,D0     ;RESTA ANCHO DEL TANQUE
00001376  6F00 0006                654              BLE     .DONE
0000137A  303C 0238                655              MOVE.W  #SCRWIDTH-TNKWIDTH,D0          
0000137E                           656              
0000137E                           657              ;ACTUALIZAR VARIABLE
0000137E  33C0 0000185C            658  .DONE       MOVE.W  D0,(TNKPOSX)
00001384                           659  
00001384  301F                     660              MOVE.W (A7)+,D0
00001386  4E75                     661              RTS
00001388                           662  
00001388                           663  ; ------------------------------------------------------------------------------
00001388                           664  TNKPLOT
00001388                           665  ; PLOT THE TANK.
00001388                           666  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
00001388                           667  ; OUTPUT   : NONE
00001388                           668  ; MODIFIES : NONE
00001388                           669  ; ------------------------------------------------------------------------------
00001388                           670      
00001388  48E7 FE80                671              MOVEM.L D0-D6/A0,-(A7)
0000138C                           672              
0000138C                           673              ;ESTABLECER COLOR CONTORNO
0000138C                           674m             SET_PEN_COLOR #TNKPNCLR
0000138C                           675m ; SETS THE PEN COLOR FOR DRAWING
0000138C                           676m ; INPUT    : #TNKPNCLR COLOR IN $00BBGGRR FORMAT 
0000138C                           677m ; OUTPUT   : NONE
0000138C                           678m ; MODIFIES : D0,D1
0000138C                           679m ;..............................................................................
000013A0                           680  
000013A0                           681              ;ESTABLECER COLOR RELLENO
000013A0                           682m             SET_FILL_COLOR  #TNKFLCLR
000013A0                           683m ; SETS THE FILL COLOR FOR DRAWING
000013A0                           684m ; INPUT    : #TNKFLCLR COLOR IN $00BBGGRR FORMAT 
000013A0                           685m ; OUTPUT   : NONE
000013A0                           686m ; MODIFIES : D0,D1
000013A0                           687m ;..............................................................................
000013B4                           688              ;DIBUJAR TANQUE
000013B4  43F9 000013F6            689              LEA     TNKMAP,A1
000013BA  103C 0057                690              MOVE.B  #87,D0
000013BE  343C 01A0                691              MOVE.W  #TNKPOSY,D2
000013C2  383C 01A8                692              MOVE.W  #TNKPOSY+TNKSQUWI,D4                ;DEFINIR POSICIÓN Y
000013C6  3C3C 0005                693              MOVE.W  #TNKROW-1,D6                        ;FILAS
000013CA                           694  
000013CA  3239 0000185C            695  .CLOOP      MOVE.W  (TNKPOSX),D1
000013D0  3601                     696              MOVE.W  D1,D3
000013D2  5043                     697              ADD.W   #TNKSQUWI,D3                        ;DEFINIR POSICIÓN X
000013D4  3A3C 0008                698              MOVE.W  #TNKCOL-1,D5                        ;COLUMNAS
000013D8  4A19                     699  .RLOOP      TST.B   (A1)+
000013DA  6700 0004                700              BEQ     .NEXT
000013DE  4E4F                     701              TRAP    #15
000013E0  3203                     702  .NEXT       MOVE.W  D3,D1
000013E2  5043                     703              ADD.W   #TNKSQUWI,D3
000013E4  51CD FFF2                704              DBRA.W  D5,.RLOOP
000013E8  3404                     705              MOVE.W  D4,D2
000013EA  5044                     706              ADD.W   #TNKSQUWI,D4
000013EC  51CE FFDC                707              DBRA.W  D6,.CLOOP
000013F0                           708  
000013F0  4CDF 027F                709              MOVEM.L (A7)+,D0-D6/A1
000013F4                           710  
000013F4  4E75                     711              RTS
000013F6                           712              
000013F6= 00 00 00 00 01 00 ...    713  TNKMAP      DC.B    0,0,0,0,1,0,0,0,0    
000013FF= 00 00 00 01 01 01 ...    714              DC.B    0,0,0,1,1,1,0,0,0
00001408= 00 00 00 01 01 01 ...    715              DC.B    0,0,0,1,1,1,0,0,0
00001411= 01 01 01 01 01 01 ...    716              DC.B    1,1,1,1,1,1,1,1,1
0000141A= 01 01 01 01 01 01 ...    717              DC.B    1,1,1,1,1,1,1,1,1
00001423= 01 01 01 01 01 01 ...    718              DC.B    1,1,1,1,1,1,1,1,1
0000142C                           719              DS.W    0
0000142C                           720  
0000142C                           721  
0000142C                           722  
0000142C                           723  
0000142C                           724  
0000142C                           725  
0000142C                           726  
0000142C                           727  
0000142C                           728  
0000142C                           729  
0000142C                           730  
0000142C                           731  
0000142C                           732  
0000142C                           733  
0000142C                           734  
0000142C                           735  
0000142C                           736  
0000142C                           737  
0000142C                           738  
0000142C                           739  -------------------- end include --------------------
0000142C                           740              INCLUDE "ALIEN.X68"
0000142C                           741  ; ------------------------------------------------------------------------------
0000142C                           742  ALNINIT
0000142C                           743  ; INITIALIZE ALIEN
0000142C                           744  ; INPUT    : NONE 
0000142C                           745  ; OUTPUT   : NONE
0000142C                           746  ; MODIFIES : NONE
0000142C                           747  ; ------------------------------------------------------------------------------
0000142C  33FC 0078 0000185E       748              MOVE.W  #ALNIPOSX,(ALNPOSX)
00001434  33FC 0050 00001860       749              MOVE.W  #ALNIPOSY,(ALNPOSY) 
0000143C  33FC 0004 00001862       750              MOVE.W  #ALNSPEED,(ALNVELX)
00001444  33FC 0004 00001864       751              MOVE.W  #ALNSPEED,(ALNVELY) 
0000144C                           752                      
0000144C  4E75                     753              RTS
0000144E                           754  
0000144E                           755  ; ------------------------------------------------------------------------------
0000144E                           756  ALNUPD
0000144E                           757  ; UPDATES THE ALIEN
0000144E                           758  ; INPUT    : NONE
0000144E                           759  ; OUTPUT   : NONE
0000144E                           760  ; MODIFIES : NONE
0000144E                           761  ; ------------------------------------------------------------------------------
0000144E                           762              ;MOVIMIENTO ALIENS
0000144E  48E7 FF10                763              MOVEM.L D0-D7/A3,-(A7)
00001452                           764              
00001452                           765              ; UPDATE BALL COORDINATES
00001452  3039 0000185E            766              MOVE.W  (ALNPOSX),D0
00001458  3239 00001860            767              MOVE.W  (ALNPOSY),D1
0000145E  9079 00001862            768              SUB.W   (ALNVELX),D0
00001464                           769              
00001464                           770              ; CHECK HORIZONTAL COLLISIONS
00001464  B07C 00C8                771              CMP.W   #SCRWIDTH-440,D0
00001468  6E00 000E                772              BGT     .COLRGT
0000146C  B07C 0028                773              CMP.W   #40,D0
00001470  6D00 001A                774              BLT     .COLLFT
00001474  6000 0026                775              BRA     .DONE
00001478                           776              
00001478                           777              ; RIGHT SIDE COLLISION
00001478  D279 00001864            778  .COLRGT     ADD.W   (ALNVELY),D1
0000147E  4479 00001862            779              NEG.W   (ALNVELX)
00001484  303C 00C8                780              MOVE.W  #SCRWIDTH-440,D0
00001488  6000 0012                781              BRA     .DONE
0000148C                           782              
0000148C                           783              ; LEFT SIDE COLLISION
0000148C  D279 00001864            784  .COLLFT     ADD.W   (ALNVELY),D1
00001492  4479 00001862            785              NEG.W   (ALNVELX)
00001498  303C 0028                786              MOVE.W  #40,D0
0000149C                           787              
0000149C                           788              
0000149C                           789              ; STORE POSITION
0000149C  33C0 0000185E            790  .DONE       MOVE.W  D0,(ALNPOSX)
000014A2  33C1 00001860            791              MOVE.W  D1,(ALNPOSY)
000014A8                           792  
000014A8  4CDF 08FF                793              MOVEM.L (A7)+,D0-D7/A3
000014AC  4E75                     794              RTS
000014AE                           795  
000014AE                           796  
000014AE                           797  ;-----------------------DIBUJO ALIENS--------------------------------------------
000014AE                           798  
000014AE                           799  ALNPLOT
000014AE                           800  ;--------------------------------------------------------------------------------
000014AE                           801  ;DIBUJA UNA CUADRICULA 3*10 PARA QUE HAYA UN ALIEN EN CADA UNA DE ELLAS.
000014AE                           802  ; INPUT    : NONE
000014AE                           803  ; OUTPUT   : NONE
000014AE                           804  ; MODIFIES : NONE
000014AE                           805  ;--------------------------------------------------------------------------------
000014AE                           806      
000014AE  48E7 FE20                807              MOVEM.L D0-D6/A2,-(A7)
000014B2                           808              
000014B2                           809              ;DEFINE COLORES
000014B2                           810m             SET_PEN_COLOR   #ALNPNCLR
000014B2                           811m ; SETS THE PEN COLOR FOR DRAWING
000014B2                           812m ; INPUT    : #ALNPNCLR COLOR IN $00BBGGRR FORMAT 
000014B2                           813m ; OUTPUT   : NONE
000014B2                           814m ; MODIFIES : D0,D1
000014B2                           815m ;..............................................................................
000014C6                           816m             SET_FILL_COLOR  #ALNFLCLR
000014C6                           817m ; SETS THE FILL COLOR FOR DRAWING
000014C6                           818m ; INPUT    : #ALNFLCLR COLOR IN $00BBGGRR FORMAT 
000014C6                           819m ; OUTPUT   : NONE
000014C6                           820m ; MODIFIES : D0,D1
000014C6                           821m ;..............................................................................
000014DA                           822              
000014DA  45F9 00001526            823              LEA     MAPDATA,A2      
000014E0                           824              
000014E0                           825              ;CALCULAR COORDENADAS
000014E0  3439 00001860            826              MOVE.W  (ALNPOSY),D2
000014E6  3802                     827              MOVE.W  D2,D4
000014E8  0644 0028                828              ADD.W   #ALNDIM,D4          ;POSICIÓN Y
000014EC  3C3C 0002                829              MOVE.W  #ALNMPROW-1,D6      ;FILAS MAPA
000014F0                           830  
000014F0  3239 0000185E            831  .CLOOP      MOVE.W  (ALNPOSX),D1
000014F6  3601                     832              MOVE.W  D1,D3
000014F8  0643 0028                833              ADD.W   #ALNDIM,D3          ;POSICIÓN X
000014FC  3A3C 0009                834              MOVE.W  #ALNMPCOL-1,D5      ;COLUMNAS MAPA
00001500  4A1A                     835  .RLOOP      TST.B   (A2)+
00001502  6700 0008                836              BEQ     .NEXT
00001506  4EB9 00001544            837              JSR     ALNPLOT1            ;DIBUJA ALIEN
0000150C  3203                     838  .NEXT       MOVE.W  D3,D1
0000150E  0643 0028                839              ADD.W   #ALNDIM,D3
00001512  51CD FFEC                840              DBRA.W  D5,.RLOOP
00001516  3404                     841              MOVE.W  D4,D2
00001518  0644 0028                842              ADD.W   #ALNDIM,D4
0000151C  51CE FFD2                843              DBRA.W  D6,.CLOOP
00001520                           844  
00001520  4CDF 047F                845              MOVEM.L (A7)+,D0-D6/A2
00001524  4E75                     846              RTS   
00001526                           847   
00001526= 01 01 01 01 01 01 ...    848  MAPDATA     DC.B    1,1,1,1,1,1,1,1,1,1
00001530= 01 01 01 01 01 01 ...    849              DC.B    1,1,1,1,1,1,1,1,1,1
0000153A= 01 01 01 01 01 01 ...    850              DC.B    1,1,1,1,1,1,1,1,1,1
00001544                           851              DS.W    0
00001544                           852  
00001544                           853  ; ------------------------------------------------------------------------------
00001544                           854  ALNPLOT1
00001544                           855  ; DIBUJA EL ALIEN 
00001544                           856  ; INPUT    : NONE
00001544                           857  ; OUTPUT   : NONE
00001544                           858  ; MODIFIES : NONE
00001544                           859  ; ------------------------------------------------------------------------------
00001544                           860  
00001544  48E7 FF40                861              MOVEM.L D0-D7/A1,-(A7)
00001548                           862              
00001548  3E01                     863              MOVE.W  D1,D7           ;GUARDA REGISTRO                       
0000154A                           864              
0000154A  43F9 00001584            865              LEA     ALNDATA,A1
00001550  103C 0057                866              MOVE.B  #87,D0
00001554                           867               
00001554  3802                     868              MOVE.W  D2,D4
00001556  5844                     869              ADD.W   #4,D4           ;POSICIÓN Y
00001558  3C3C 0009                870              MOVE.W  #ALNROW-1,D6    ;FILAS ALIEN             
0000155C                           871  
0000155C  3207                     872  .CLOOP1     MOVE.W  D7,D1           ;RESTAURA REGISTRO
0000155E  3601                     873              MOVE.W  D1,D3
00001560  5843                     874              ADD.W   #4,D3           ;POSICIÓN X    
00001562  3A3C 0009                875              MOVE.W  #ALNCOL-1,D5    ;COLUMNAS ALIEN                   
00001566  4A19                     876  .RLOOP1     TST.B   (A1)+
00001568  6700 0004                877              BEQ     .NEXT1
0000156C  4E4F                     878              TRAP    #15
0000156E  3203                     879  .NEXT1      MOVE.W  D3,D1
00001570  5843                     880              ADD.W   #4,D3
00001572  51CD FFF2                881              DBRA.W  D5,.RLOOP1
00001576  3404                     882              MOVE.W  D4,D2
00001578  5844                     883              ADD.W   #4,D4
0000157A  51CE FFE0                884              DBRA.W  D6,.CLOOP1
0000157E                           885  
0000157E  4CDF 02FF                886              MOVEM.L (A7)+,D0-D7/A1
00001582  4E75                     887              RTS
00001584                           888  
00001584= 00 00 00 00 00 00 ...    889  ALNDATA     DC.B    0,0,0,0,0,0,0,0,0,0
0000158E= 00 00 00 00 00 00 ...    890              DC.B    0,0,0,0,0,0,0,0,0,0
00001598= 00 00 00 01 01 01 ...    891              DC.B    0,0,0,1,1,1,1,0,0,0
000015A2= 00 00 01 01 01 01 ...    892              DC.B    0,0,1,1,1,1,1,1,0,0
000015AC= 00 00 01 00 01 01 ...    893              DC.B    0,0,1,0,1,1,0,1,0,0
000015B6= 00 00 01 01 00 00 ...    894              DC.B    0,0,1,1,0,0,1,1,0,0
000015C0= 00 00 00 01 01 01 ...    895              DC.B    0,0,0,1,1,1,1,0,0,0
000015CA= 00 00 01 00 00 00 ...    896              DC.B    0,0,1,0,0,0,0,1,0,0
000015D4= 00 00 00 00 00 00 ...    897              DC.B    0,0,0,0,0,0,0,0,0,0
000015DE= 00 00 00 00 00 00 ...    898              DC.B    0,0,0,0,0,0,0,0,0,0
000015E8                           899              DS.W    0
000015E8                           900  
000015E8                           901  
000015E8                           902  
000015E8                           903  
000015E8                           904  
000015E8                           905  
000015E8                           906  
000015E8                           907  
000015E8                           908  
000015E8                           909  
000015E8                           910  
000015E8                           911       
000015E8                           912  
000015E8                           913  
000015E8                           914  
000015E8                           915  
000015E8                           916  
000015E8                           917  
000015E8                           918  
000015E8                           919  
000015E8                           920  
000015E8                           921  
000015E8                           922  
000015E8                           923  
000015E8                           924  
000015E8                           925  
000015E8                           926  
000015E8                           927  
000015E8                           928  
000015E8                           929  
000015E8                           930  
000015E8                           931  
000015E8                           932  
000015E8                           933  
000015E8                           934  
000015E8                           935  
000015E8                           936  
000015E8                           937  
000015E8                           938  
000015E8                           939  
000015E8                           940  
000015E8                           941  
000015E8                           942  
000015E8                           943  
000015E8                           944  
000015E8                           945  
000015E8                           946  
000015E8                           947  
000015E8                           948  
000015E8                           949  
000015E8                           950  
000015E8                           951  -------------------- end include --------------------
000015E8                           952              INCLUDE "SHOT.X68"
000015E8                           953  ; ------------------------------------------------------------------------------
000015E8                           954  SHTINIT
000015E8                           955  ; INITIALIZE THE SHOOT 
000015E8                           956  ; INPUT    :  A0 POINTER TO THE INSTANCE VARIABLES
000015E8                           957  ; OUTPUT   : NONE
000015E8                           958  ; MODIFIES : NONE
000015E8                           959  ; ------------------------------------------------------------------------------
000015E8                           960      
000015E8                           961              ;POSICIONAR DISPARO
000015E8                           962              ;POSICIONAR X
000015E8  30B9 0000185C            963              MOVE.W  (TNKPOSX),(A0)
000015EE  0650 0024                964              ADD.W   #TNKWIDHA,(A0)
000015F2                           965              
000015F2                           966              ;POSICIONAR Y
000015F2  317C 01A0 0002           967              MOVE.W  #TNKPOSY,2(A0)
000015F8  0468 0012 0002           968              SUB.W   #SHTGAP+SHTHEIGH/2,2(A0)
000015FE                           969  
000015FE  4E75                     970              RTS
00001600                           971   
00001600                           972  ; ------------------------------------------------------------------------------
00001600                           973  SHTUPD
00001600                           974  ; UPDATES THE SHOOT
00001600                           975  ; INPUT    : 
00001600                           976  ; OUTPUT   : NONE
00001600                           977  ; MODIFIES : NONE
00001600                           978  ; ------------------------------------------------------------------------------
00001600                           979              
00001600  48A7 F000                980              MOVEM.W  D0-D3,-(A7)
00001604                           981                  
00001604                           982              ;ACTUALIZAR MOVIMIENTO DISPARO
00001604  3028 0002                983              MOVE.W  2(A0),D0
00001608  0440 000A                984              SUB.W   #SHTSPEED,D0
0000160C  3140 0002                985              MOVE.W  D0,2(A0)
00001610                           986              
00001610                           987              ;ELIMINAR DISPARO SI TOCA TECHO
00001610  0641 0010                988              ADD.W   #SHTHEIGH,D1
00001614  E249                     989              LSR.W   #1,D1
00001616  D041                     990              ADD.W   D1,D0
00001618  B07C 0000                991              CMP.W   #0,D0
0000161C  6E00 0006                992              BGT     .NEXT
00001620  4EB8 10AC                993              JSR     AGLKILL
00001624                           994              
00001624                           995              ;COMPOBAR COLISIONES CON DISPARO (DESAPARECER)
00001624                           996              
00001624                           997              
00001624                           998              
00001624                           999              ; 
00001624                          1000              ;COMPROBAR COLISIÓN DISPARO X IZQUIERDA  
00001624  3039 0000185E           1001  .NEXT       MOVE.W  (ALNPOSX),D0        ;D0 = ALNPOSX 
0000162A  343C 0004               1002  .CONT       MOVE.W  #SHTWIDTH,D2
0000162E  E24A                    1003              LSR.W   #1,D2
00001630  D450                    1004              ADD.W   (A0),D2             ;SHTPOSX + SHTWIDTH/2
00001632  B440                    1005              CMP.W   D0,D2             
00001634  6D00 008C               1006              BLT     .DONE
00001638                          1007              
00001638                          1008              ;COMPROBAR COLISIÓN DISPARO X DERECHA
00001638  343C 0004               1009              MOVE.W  #SHTWIDTH,D2
0000163C  E24A                    1010              LSR.W   #1,D2
0000163E  9450                    1011              SUB.W   (A0),D2            
00001640  4442                    1012              NEG.W   D2                  ;SHTPOSX - SHTWIDTH/2
00001642  3600                    1013              MOVE.W  D0,D3               ;COPIAR ALNPOSX
00001644  0643 0190               1014              ADD.W   #ALNDIM*ALNMPCOL,D3 ;ALNPOSX + ALNDIM * ALNMPCOL
00001648  B443                    1015              CMP.W   D3,D2
0000164A  6E00 0076               1016              BGT     .DONE
0000164E                          1017              
0000164E                          1018              ;COMPROBAR COLISIÓN DISPARO Y ARRIBA
0000164E  3239 00001860           1019              MOVE.W  (ALNPOSY),D1        ;D1 = ALNPOSY
00001654  343C 0010               1020              MOVE.W  #SHTHEIGH,D2
00001658  E24A                    1021              LSR.W   #1,D2
0000165A  D468 0002               1022              ADD.W   2(A0),D2            ;SHTPOSY + SHTHEIGH/2 
0000165E  B441                    1023              CMP.W   D1,D2              
00001660  6D00 0060               1024              BLT     .DONE
00001664                          1025              
00001664                          1026              ;COMPROBAR COLISIÓN DISPARO Y ABAJO
00001664  343C 0010               1027              MOVE.W  #SHTHEIGH,D2
00001668  E24A                    1028              LSR.W   #1,D2
0000166A  9468 0002               1029              SUB.W   2(A0),D2         
0000166E  4442                    1030              NEG.W   D2                  ;SHTPOSY - SHTHEIGH/2
00001670  3601                    1031              MOVE.W  D1,D3               ;COPIAR ALNPOSY
00001672  0643 0078               1032              ADD.W   #ALNDIM*ALNMPROW,D3 ;ALNPOSY + ALNDIM * ALNMPROW
00001676  B443                    1033              CMP.W   D3,D2
00001678  6E00 0048               1034              BGT     .DONE
0000167C                          1035               
0000167C                          1036              
0000167C                          1037              
0000167C  3010                    1038              MOVE.W  (A0),D0 ; DO = SHTPOSX
0000167E  5540                    1039              SUB.W   #SHTWIDTH/2,D0  ; D0 = SHTPOSX- SHTWIDTH/2  ; (PARTE ARRIBA IZQUIERDA)
00001680  3239 0000185E           1040              MOVE.W  (ALNPOSX),D1    ;D1 = ALNPOSX
00001686  9041                    1041              SUB.W   D1,D0   ;D0 =   SHTPOSX- SHTWIDTH/2-ALNPOSX
00001688                          1042  
00001688                          1043              ;MOVE.W #60,D0
00001688  80FC 0028               1044              DIVU.W  #ALNDIM,D0  ; COLUMNA DE LA MATRIZ
0000168C                          1045                                      
0000168C                          1046              
0000168C  3428 0002               1047              MOVE.W  2(A0),D2    ; DO = SHTPOSY
00001690  5142                    1048              SUB.W   #SHTHEIGH/2,D2  ; D0 = SHTPOSY- SHTHEIGH/2  ; (PARTE ARRIBA IZQUIERDA)
00001692  3639 00001860           1049              MOVE.W  (ALNPOSY),D3    ;D1 = ALNPOSY
00001698  9443                    1050              SUB.W   D3,D2   ;D0 =   SHTPOSY- SHTHEIGH/2-ALNPOSY
0000169A                          1051              ;MOVE.W #60,D2
0000169A  84FC 0028               1052              DIVU.W  #ALNDIM,D2  ; FILA DE LA MATRIZ
0000169E                          1053              
0000169E  C4FC 000A               1054              MULU.W  #10,D2
000016A2  D042                    1055              ADD.W D2,D0
000016A4  5240                    1056              ADDQ.W #1,D0
000016A6                          1057              ;MOVE.W #12,D1
000016A6  47F8 1526               1058              LEA MAPDATA, A3
000016AA  2A13                    1059              MOVE.L  (A3),D5
000016AC  0033 0001 0000          1060              OR.B    #1, (A3,D0.W)   ;
000016B2  6700 000E               1061              BEQ .DONE
000016B6  0233 0000 0000          1062              AND.B #0, (A3,D0.W)
000016BC  5279 0000186A           1063              ADDQ.W  #1,(SCOPOINT)       ;INCREMENTAMOS LOS PUNTOS ACUMULADOS
000016C2                          1064  
000016C2                          1065              
000016C2                          1066              
000016C2                          1067  
000016C2                          1068  
000016C2                          1069  
000016C2                          1070              ;ELIMINAR DISPARO SI TOCA ALIEN
000016C2                          1071                   
000016C2  4C9F 000F               1072  .DONE       MOVEM.W  (A7)+,D0-D3
000016C6  4E75                    1073              RTS
000016C8                          1074  
000016C8                          1075  ; ------------------------------------------------------------------------------
000016C8                          1076  SHTPLOT
000016C8                          1077  ; PLOT THE SHOOT.
000016C8                          1078  ; INPUT    : A0 POINTER TO THE INSTANCE VARIABLES 
000016C8                          1079  ; OUTPUT   : NONE
000016C8                          1080  ; MODIFIES : NONE
000016C8                          1081  ; ------------------------------------------------------------------------------
000016C8                          1082      
000016C8  48E7 F800               1083              MOVEM.L D0-D4,-(A7)
000016CC                          1084              ;ESTABLECER COLOR CONTORNO
000016CC                          1085m             SET_PEN_COLOR   #SHTPNCLR            
000016CC                          1086m ; SETS THE PEN COLOR FOR DRAWING
000016CC                          1087m ; INPUT    : #SHTPNCLR COLOR IN $00BBGGRR FORMAT 
000016CC                          1088m ; OUTPUT   : NONE
000016CC                          1089m ; MODIFIES : D0,D1
000016CC                          1090m ;..............................................................................
000016E0                          1091              ;ESTABLECER COLOR RELLENO
000016E0                          1092m             SET_FILL_COLOR  #SHTFLCLR
000016E0                          1093m ; SETS THE FILL COLOR FOR DRAWING
000016E0                          1094m ; INPUT    : #SHTFLCLR COLOR IN $00BBGGRR FORMAT 
000016E0                          1095m ; OUTPUT   : NONE
000016E0                          1096m ; MODIFIES : D0,D1
000016E0                          1097m ;..............................................................................
000016F4                          1098            
000016F4                          1099            ;DIBUJAR DISPARO (RECTANGULO)
000016F4  3210                    1100              MOVE.W  (A0),D1
000016F6  3428 0002               1101              MOVE.W  2(A0),D2
000016FA  5541                    1102              SUB.W   #SHTWIDTH/2,D1
000016FC  3601                    1103              MOVE.W  D1,D3
000016FE  5843                    1104              ADD.W   #SHTWIDTH,D3
00001700  5042                    1105              ADD.W   #SHTHEIGH/2,D2   
00001702  3802                    1106              MOVE.W  D2,D4
00001704  0444 0010               1107              SUB.W   #SHTHEIGH,D4
00001708  103C 0057               1108              MOVE.B  #87,D0
0000170C  4E4F                    1109              TRAP    #15
0000170E                          1110              
0000170E  4CDF 001F               1111              MOVEM.L (A7)+,D0-D4
00001712  4E75                    1112              RTS        
00001714                          1113  
00001714                          1114  
00001714                          1115  
00001714                          1116  
00001714                          1117  
00001714                          1118  
00001714                          1119  
00001714                          1120  
00001714                          1121  
00001714                          1122  
00001714                          1123  
00001714                          1124  
00001714                          1125  
00001714                          1126  
00001714                          1127  
00001714                          1128  
00001714                          1129  
00001714                          1130  
00001714                          1131  
00001714                          1132  
00001714                          1133  
00001714                          1134  
00001714                          1135  
00001714                          1136  
00001714                          1137  
00001714                          1138  
00001714                          1139  
00001714                          1140  
00001714                          1141  
00001714                          1142  
00001714                          1143  
00001714                          1144  
00001714                          1145  
00001714                          1146  
00001714                          1147  
00001714                          1148  
00001714                          1149  
00001714                          1150  
00001714                          1151  
00001714                          1152  
00001714                          1153  
00001714                          1154  
00001714                          1155  
00001714                          1156  -------------------- end include --------------------
00001714                          1157              INCLUDE "SCORE.X68"
00001714                          1158  ; ------------------------------------------------------------------------------
00001714                          1159  SCOINIT
00001714                          1160  ; INITIALIZE THE SCORE
00001714                          1161  ; INPUT    : NONE 
00001714                          1162  ; OUTPUT   : NONE
00001714                          1163  ; MODIFIES : NONE
00001714                          1164  ; ------------------------------------------------------------------------------
00001714                          1165      
00001714  4279 0000186A           1166              CLR.W   (SCOPOINT)
0000171A                          1167          
0000171A  4E75                    1168              RTS
0000171C                          1169   
0000171C                          1170  ; ------------------------------------------------------------------------------
0000171C                          1171  SCOPLOT
0000171C                          1172  ; PLOT THE SCORE.
0000171C                          1173  ; INPUT    : NONE 
0000171C                          1174  ; OUTPUT   : NONE
0000171C                          1175  ; MODIFIES : NONE
0000171C                          1176  ; ------------------------------------------------------------------------------
0000171C                          1177      
0000171C  48E7 C040               1178              MOVEM.L D0-D1/A1,-(A7)
00001720                          1179              
00001720                          1180              ;ESTABLECER COLOR RELLENO
00001720                          1181m             SET_FILL_COLOR  #SCOFLCLR
00001720                          1182m ; SETS THE FILL COLOR FOR DRAWING
00001720                          1183m ; INPUT    : #SCOFLCLR COLOR IN $00BBGGRR FORMAT 
00001720                          1184m ; OUTPUT   : NONE
00001720                          1185m ; MODIFIES : D0,D1
00001720                          1186m ;..............................................................................
00001730                          1187              
00001730                          1188              ;ESTABLECER POSICIÓN
00001730  103C 000B               1189              MOVE.B  #11,D0
00001734  323C 0101               1190              MOVE.W  #SCOLINE,D1
00001738  4E4F                    1191              TRAP    #15
0000173A                          1192              
0000173A                          1193              ;MOSTRAR SCORE
0000173A  103C 0011               1194              MOVE.B  #17,D0
0000173E  43F9 00001752           1195              LEA     .TXT,A1
00001744  3239 0000186A           1196              MOVE.W  (SCOPOINT),D1
0000174A  4E4F                    1197              TRAP    #15
0000174C                          1198              
0000174C  4CDF 0203               1199              MOVEM.L (A7)+,D0-D1/A1
00001750  4E75                    1200              RTS
00001752                          1201  
00001752= 50 55 4E 54 55 41 ...   1202  .TXT        DC.B    'PUNTUACION:',0        
0000175E                          1203  
0000175E                          1204  
0000175E                          1205  
0000175E                          1206  
0000175E                          1207  
0000175E                          1208  -------------------- end include --------------------
0000175E                          1209              INCLUDE "FPS.X68"
0000175E                          1210  ; ------------------------------------------------------------------------------
0000175E                          1211  FPSINIT
0000175E                          1212  ; INITIALIZE THE FPS.
0000175E                          1213  ; INPUT    : NONE 
0000175E                          1214  ; OUTPUT   : NONE
0000175E                          1215  ; MODIFIES : NONE
0000175E                          1216  ; ------------------------------------------------------------------------------
0000175E                          1217      
0000175E  4279 00001870           1218              CLR.W   (REALFPS)
00001764                          1219          
00001764  4E75                    1220              RTS
00001766                          1221   
00001766                          1222  ; ------------------------------------------------------------------------------
00001766                          1223  FPSPLOT
00001766                          1224  ; PLOT THE FPS SCOREBOARD.
00001766                          1225  ; INPUT    : NONE 
00001766                          1226  ; OUTPUT   : NONE
00001766                          1227  ; MODIFIES : NONE
00001766                          1228  ; ------------------------------------------------------------------------------
00001766                          1229      
00001766  48E7 C040               1230              MOVEM.L D0-D1/A1,-(A7)
0000176A                          1231              
0000176A                          1232              ;ESTABLECER COLOR RELLENO
0000176A                          1233m             SET_FILL_COLOR  #FPSFLCLR
0000176A                          1234m ; SETS THE FILL COLOR FOR DRAWING
0000176A                          1235m ; INPUT    : #FPSFLCLR COLOR IN $00BBGGRR FORMAT 
0000176A                          1236m ; OUTPUT   : NONE
0000176A                          1237m ; MODIFIES : D0,D1
0000176A                          1238m ;..............................................................................
0000177A                          1239              
0000177A                          1240              ;ESTABLECER POSICIÓN 1
0000177A  103C 000B               1241              MOVE.B  #11,D0
0000177E  323C 3101               1242              MOVE.W  #FPSLINE1,D1
00001782  4E4F                    1243              TRAP    #15
00001784                          1244              
00001784                          1245              ;MOSTRAR SCORE 1
00001784  103C 0011               1246              MOVE.B  #17,D0
00001788  43F9 000017CC           1247              LEA     .TXT1,A1
0000178E  323C 0032               1248              MOVE.W  #SCRFPS,D1
00001792  4E4F                    1249              TRAP    #15
00001794                          1250              
00001794                          1251              ;ESTABLECER POSICIÓN 2 
00001794  103C 000B               1252              MOVE.B  #11,D0
00001798  323C 3901               1253              MOVE.W  #FPSLINE2,D1
0000179C  4E4F                    1254              TRAP    #15
0000179E                          1255              
0000179E                          1256              ;MOSTRAR SCORE 2
0000179E  103C 0011               1257              MOVE.B  #17,D0
000017A2  43F9 000017D2           1258              LEA     .TXT2,A1
000017A8  3239 00001870           1259              MOVE.W  (REALFPS),D1
000017AE  4E4F                    1260              TRAP    #15
000017B0                          1261              
000017B0                          1262              ;ESTABLECER POSICIÓN 3 
000017B0  103C 000B               1263              MOVE.B  #11,D0
000017B4  323C 4901               1264              MOVE.W  #FPSLINE3,D1
000017B8  4E4F                    1265              TRAP    #15
000017BA                          1266              
000017BA                          1267              ;MOSTRAR SCORE 3
000017BA  103C 000E               1268              MOVE.B  #14,D0
000017BE  43F9 000017E0           1269              LEA     .TXT3,A1
000017C4  4E4F                    1270              TRAP    #15
000017C6                          1271              
000017C6  4CDF 0203               1272              MOVEM.L (A7)+,D0-D1/A1
000017CA  4E75                    1273              RTS
000017CC                          1274  
000017CC= 47 4F 41 4C 3A 00       1275  .TXT1       DC.B    'GOAL:',0
000017D2= 46 50 53 20 2D 20 ...   1276  .TXT2       DC.B    'FPS - ACTUAL:',0
000017E0= 46 50 53 00             1277  .TXT3       DC.B    'FPS',0
000017E4                          1278  
000017E4                          1279  
000017E4                          1280  
000017E4                          1281  -------------------- end include --------------------
000017E4                          1282             
000017E4                          1283              
000017E4                          1284  START
000017E4                          1285  
000017E4                          1286  
000017E4                          1287  
000017E4                          1288  
000017E4                          1289  
000017E4                          1290  
000017E4  007C 0700               1291               ORI.W   #$0700,SR
000017E8                          1292              
000017E8                          1293              ;INITS
000017E8  4EB8 10C2               1294              JSR     SYSINIT
000017EC  4EB8 1202               1295              JSR     UTLINIT
000017F0  4EB8 1336               1296              JSR     TNKINIT
000017F4  4EB8 142C               1297              JSR     ALNINIT
000017F8  4EB8 1000               1298              JSR     DMMINIT 
000017FC  4EB8 1714               1299              JSR     SCOINIT
00001800  4EB8 175E               1300              JSR     FPSINIT
00001804                          1301                
00001804                          1302  .LOOP
00001804  4E41                    1303              TRAP    #1
00001806                          1304              
00001806                          1305              
00001806                          1306              ;AÑADIR DISPARO SI TECLADO = "UP" 
00001806  0839 0002 0000186F      1307              BTST.B  #2,(KBDEDGE)
0000180E  6700 0016               1308              BEQ     .GOUPD
00001812  43F8 15E8               1309              LEA     SHTINIT,A1
00001816  45F8 1600               1310              LEA     SHTUPD,A2
0000181A  47F8 16C8               1311              LEA     SHTPLOT,A3
0000181E  303C 0001               1312              MOVE.W  #1,D0
00001822  4EB8 119E               1313              JSR     AGLADD
00001826                          1314  
00001826                          1315  .GOUPD      ;UPDATES
00001826  4EB8 11B8               1316              JSR     AGLUPD
0000182A  4EB8 1340               1317              JSR     TNKUPD
0000182E  4EB8 144E               1318              JSR     ALNUPD
00001832                          1319              
00001832                          1320              ;SYNC
00001832  4A39 00001872           1321  .WINT       TST.B   (SCRINTCT)
00001838  67F8                    1322              BEQ     .WINT
0000183A  4239 00001872           1323              CLR.B   (SCRINTCT)
00001840                          1324              
00001840                          1325              ;PLOTS
00001840  4EB8 11DC               1326              JSR     AGLPLOT
00001844  4EB8 1388               1327              JSR     TNKPLOT
00001848  4EB8 14AE               1328              JSR     ALNPLOT
0000184C  4EB8 171C               1329              JSR     SCOPLOT
00001850  4EB8 1766               1330              JSR     FPSPLOT
00001854                          1331               
00001854                          1332              ;UPDATE DOUBLE BUFFER
00001854  4E40                    1333              TRAP    #0  
00001856                          1334              
00001856  60AC                    1335              BRA     .LOOP
00001858                          1336  .DONE    
00001858  FFFF FFFF               1337             SIMHALT
0000185C                          1338        
0000185C                          1339              INCLUDE "VARS.X68"
0000185C                          1340  
0000185C                          1341  TNKPOSX     DS.W    1   ;POSICIÓN X TANQUE
0000185E                          1342  
0000185E                          1343  ALNPOSX     DS.W    1   ;POSICIÓN X ALIEN
00001860                          1344  ALNPOSY     DS.W    1   ;POSICIÓN Y ALIEN
00001862                          1345  
00001862                          1346  ALNVELX     DS.W    1   ;VELOCIDAD ALIENS X
00001864                          1347  ALNVELY     DS.W    1   ;VELOCIDAD ALIENS Y
00001866                          1348  
00001866                          1349  SHTPOSX     DS.W    1   ;POSICIÓN X DISPARO
00001868                          1350  SHTPOSY     DS.W    1   ;POSICIÓN Y DISPARO
0000186A                          1351  
0000186A                          1352  SCOPOINT    DS.W    1   ;PUNTOS DEL MARCADOR   
0000186C                          1353  
0000186C                          1354  
0000186C                          1355  
0000186C                          1356  
0000186C                          1357  
0000186C                          1358  
0000186C                          1359  
0000186C                          1360  
0000186C                          1361  
0000186C                          1362  
0000186C                          1363  
0000186C                          1364  
0000186C                          1365  
0000186C                          1366  -------------------- end include --------------------
0000186C                          1367              INCLUDE "LIB/UTLVARS.X68"
0000186C                          1368  ; =============================================================================
0000186C                          1369  ; UTILITY VARIABLES
0000186C                          1370  ; =============================================================================
0000186C                          1371  
0000186C                          1372  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
0000186E                          1373              DS.W    0
0000186E                          1374  -------------------- end include --------------------
0000186E                          1375              INCLUDE "SYSVARS.X68"
0000186E                          1376      ; VARIABLES TECLADO    
0000186E                          1377  KBDVAL      DS.B    1
0000186F                          1378  KBDEDGE     DS.B    1
00001870                          1379  
00001870                          1380      ; VARIABLES PANTALLA
00001870                          1381  REALFPS     DS.W    1   ; FPS REALES
00001872                          1382           
00001872                          1383      ; VARIABLES INTERRUPCIÓN TEMPORIZADA
00001872                          1384  SCRINTCT    DS.B    1   ; INTERRUPT COUNTER
00001874                          1385              DS.W    0
00001874                          1386  
00001874                          1387  
00001874                          1388  
00001874                          1389  -------------------- end include --------------------
00001874                          1390              INCLUDE "LIB/DMMVARS.X68"
00001874                          1391  ; =============================================================================
00001874                          1392  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
00001874                          1393  ; =============================================================================
00001874                          1394  
00001880                          1395              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001880                          1396  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002500                          1397              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002500                          1398  -------------------- end include --------------------
00002500                          1399  
00002500                          1400   
00002500                          1401              END    START      

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              119E
AGLADD:END          11B4
AGLKILL             10AC
AGLPLOT             11DC
AGLPLOT:END         11FC
AGLPLOT:LOOP        11E4
AGLUPD              11B8
AGLUPD:END          11D6
AGLUPD:LOOP         11C0
ALNCOL              A
ALNDATA             1584
ALNDIM              28
ALNFLCLR            FF00
ALNINIT             142C
ALNIPOSX            78
ALNIPOSY            50
ALNMPCOL            A
ALNMPROW            3
ALNPLOT             14AE
ALNPLOT1            1544
ALNPLOT1:CLOOP1     155C
ALNPLOT1:NEXT1      156E
ALNPLOT1:RLOOP1     1566
ALNPLOT:CLOOP       14F0
ALNPLOT:NEXT        150C
ALNPLOT:RLOOP       1500
ALNPNCLR            AA00
ALNPOSX             185E
ALNPOSY             1860
ALNROW              A
ALNSPEED            4
ALNUPD              144E
ALNUPD:COLLFT       148C
ALNUPD:COLRGT       1478
ALNUPD:DONE         149C
ALNVELX             1862
ALNVELY             1864
DMMALLOC            1092
DMMALLOC:END        10AA
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1880
DMMFCOM             106C
DMMFFND             107A
DMMFIRST            1022
DMMFLOOP            1060
DMMFRCOM            1034
DMMFREE             10AC
DMMFRFND            1042
DMMFRLOP            1028
DMMFRSTO            105A
DMMINIT             1000
DMMINIT:LOOP        100E
DMMNEXT             1044
DMMNEXTO            107C
DMMSYSID            0
FPSFLCLR            0
FPSINIT             175E
FPSLINE1            3101
FPSLINE2            3901
FPSLINE3            4901
FPSPLOT             1766
FPSPLOT:TXT1        17CC
FPSPLOT:TXT2        17D2
FPSPLOT:TXT3        17E0
KBDDOWN             28
KBDEDGE             186F
KBDINIT             1154
KBDLEFT             25
KBDRIGHT            27
KBDUP               26
KBDUPD              1162
KBDUPD:LOOP         1176
KBDVAL              186E
MAPDATA             1526
REALFPS             1870
SCOFLCLR            0
SCOINIT             1714
SCOLINE             101
SCOPLOT             171C
SCOPLOT:TXT         1752
SCOPOINT            186A
SCRFPS              32
SCRHEIGH            1E0
SCRINIT             10EE
SCRINTCT            1872
SCRPLOT             1132
SCRTIM              114C
SCRWIDTH            280
SET_FILL_COLOR      14E
SET_PEN_COLOR       0
SHTFLCLR            FF
SHTGAP              A
SHTHEIGH            10
SHTINIT             15E8
SHTPLOT             16C8
SHTPNCLR            AA
SHTPOSX             1866
SHTPOSY             1868
SHTSPEED            A
SHTUPD              1600
SHTUPD:CONT         162A
SHTUPD:DONE         16C2
SHTUPD:NEXT         1624
SHTWIDTH            4
START               17E4
START:DONE          1858
START:GOUPD         1826
START:LOOP          1804
START:WINT          1832
SYSINIT             10C2
SYSPLOT             119C
SYSUPD              119A
TNKCOL              9
TNKFLCLR            FF0000
TNKINIT             1336
TNKMAP              13F6
TNKPLOT             1388
TNKPLOT:CLOOP       13CA
TNKPLOT:NEXT        13E0
TNKPLOT:RLOOP       13D8
TNKPNCLR            AA0000
TNKPOSX             185C
TNKPOSY             1A0
TNKROW              6
TNKSPEED            8
TNKSQUWI            8
TNKUPD              1340
TNKUPD:CHKLEFT      1364
TNKUPD:CHKRIGHT     1372
TNKUPD:DONE         137E
TNKUPD:LEFT         1356
TNKWIDHA            24
TNKWIDTH            48
UTLINIT             1202
UTLRAND             1218
UTLRAND:RANDVEC     1236
UTLRNDIX            186C
